<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_422) on Fri Sep 06 09:04:04 MSK 2024 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Accumulator (org.openidentityplatform.commons.parent 2.1.7-SNAPSHOT Documentation)</title>
<meta name="date" content="2024-09-06">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Accumulator (org.openidentityplatform.commons.parent 2.1.7-SNAPSHOT Documentation)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Accumulator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>org.openidentityplatform.commons.parent 2.1.7-SNAPSHOT Documentation</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../com/persistit/Accumulator.MaxAccumulator.html" title="class in com.persistit"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?com/persistit/Accumulator.html" target="_top">Frames</a></li>
<li><a href="Accumulator.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.persistit</div>
<h2 title="Class Accumulator" class="title">Class Accumulator</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.persistit.Accumulator</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../com/persistit/Accumulator.MaxAccumulator.html" title="class in com.persistit">Accumulator.MaxAccumulator</a>, <a href="../../com/persistit/Accumulator.MinAccumulator.html" title="class in com.persistit">Accumulator.MinAccumulator</a>, <a href="../../com/persistit/Accumulator.SeqAccumulator.html" title="class in com.persistit">Accumulator.SeqAccumulator</a>, <a href="../../com/persistit/Accumulator.SumAccumulator.html" title="class in com.persistit">Accumulator.SumAccumulator</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">Accumulator</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block"><p>
 An Accumulator accumulates statistical information in the MVCC Transaction
 environment without creating write-write dependency conflicts. Subclasses
 include <code>SumAccumulator</code>, <code>MinAccumulator</code>,
 <code>MaxAccumulator</code> and <code>SeqAccumulator</code> which compute the
 sum, minimum and maximum values of contributions by individual transactions.
 (See <a href="#_SeqAccumulator">below</a> for semantics of the
 <code>SeqAccummulator</code>.) Each contribution is accounted for separately
 as a <code>Delta</code> instance until the transaction is either committed or
 aborted and there are no other concurrently executing transactions that
 started before the commit timestamp. This mechanism is designed to provide a
 "snapshot" view of the Accumulator that is consistent with the snapshot view
 of the database.
 </p>
 <p>
 In more detail: each type of Accumulator has an update method that may only
 be invoked within the scope of a transaction T. That update is not visible to
 any other transaction until T commits. Moreover, any other concurrently
 executing transaction having a start timestamp less than T's commit timestamp
 does not see the results of the update. To accomplish this, the state of the
 Accumulator visible within a transaction is computed by determining which
 updates are visible and aggregating them on demand.
 </p>
 <p>
 The updates invoked on committed Transactions are recorded in the Journal and
 reapplied during recovery to reproduce an accurate version of the Accumulator
 state when Persistit starts up. There can be at most 64 Accumulators per
 Tree. A snapshot value of each Accumulator is stored once per checkpoint.
 Checkpoint snapshot values are held in the directory tree of the volume
 containing the Tree.
 </p>
 <p>
 <h3>Types of Accumulators</h3>
 The following defines intended use cases for the various types of
 accumulators:
 <dl>
 <dt><a href="../../com/persistit/Accumulator.Type.html#SUM"><code>Accumulator.Type.SUM</code></a></dt>
 <dd>Row count, total size, sums of various other characteristics</dd>
 <dt><a href="../../com/persistit/Accumulator.Type.html#MAX"><code>Accumulator.Type.MAX</code></a></dt>
 <dd>Maximum value</dd>
 <dt><a href="../../com/persistit/Accumulator.Type.html#MIN"><code>Accumulator.Type.MIN</code></a></dt>
 <dd>Minimum value</dd>
 <dt><a href="../../com/persistit/Accumulator.Type.html#SEQ"><code>Accumulator.Type.SEQ</code></a></dt>
 <dd>Sequence number generation, e.g., auto-increment or internal primary key
 assignment</dd>
 </dl>
 </p>
 <p>
 <a name="_SnapshotValue" />
 <h3>Snapshot and Live Values</h3>
 Each Accumulator type supplies both a "snapshot" value and a "live" value.
 The snapshot value is computed as described above by selectively applying
 only those updates visible to the transaction. The live value, however, is
 simply the result of applying each update operation atomically to a long
 value maintained by the Accumulator. For example, if ten transactions
 increment a SUM accumulator by one, and then five commit of them and five and
 roll back, the live value is nonetheless increased by ten. Thus the live
 value is only an estimate. Its value is cheap to acquire but not
 transactionally accurate.
 </p>
 <p>
 <a name="_SeqAccumulator" />
 <h3>SeqAccumulator</h3>
 The <code>SeqAccumulator</code> is a combination of
 <code>SumAccumulator</code> and <code>MaxAccumulator</code>. When the
 <a href="../../com/persistit/Accumulator.SeqAccumulator.html#allocate--"><code>Accumulator.SeqAccumulator.allocate()</code></a> method is called,
 the Accumulator's <code>live</code> value is atomically incremented and the
 resulting value is returned. In addition, a <code>Delta</code> holding the
 resulting sum as a proposed minimum value is added to the transaction. These
 semantics guarantee that every value returned by a SeqAccumulator (within a
 transaction that actually commits) is unique, and that upon recovery after a
 normal shutdown or crash, the first value returned will be larger than the
 maximum value assigned by any transaction that committed successfully before
 the shutdown. Note that a transaction that allocates a value and then aborts
 leaves a gap in the numerical sequence.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.MaxAccumulator.html" title="class in com.persistit">Accumulator.MaxAccumulator</a></span></code>
<div class="block">An Accumulator that computes a maximum value</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.MinAccumulator.html" title="class in com.persistit">Accumulator.MinAccumulator</a></span></code>
<div class="block">An Accumulator that computes a minimum value</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.SeqAccumulator.html" title="class in com.persistit">Accumulator.SeqAccumulator</a></span></code>
<div class="block">An Accumulator used to generate unique ID values.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.SumAccumulator.html" title="class in com.persistit">Accumulator.SumAccumulator</a></span></code>
<div class="block">An Accumulator that computes a sum</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.Type.html" title="enum in com.persistit">Accumulator.Type</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../com/persistit/Tree.html" title="class in com.persistit">Tree</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.html#Z:Z_tree">_tree</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.html#getLiveValue--">getLiveValue</a></span>()</code>
<div class="block">Non-transactional view aggregating all updates applied to this
 Accumulator, whether committed or not.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.html#getSnapshotValue--">getSnapshotValue</a></span>()</code>
<div class="block">Compute the value computed by accumulating values contributed by (a) all
 transactions having commit timestamps less than or equal to the specified
 <code>transaction</code>'s start timestamp, and (b) all operations
 performed by the specified transaction having step numbers equal to or
 less than the <code>transaction</code>'s current step.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Accumulator.html#toString--">toString</a></span>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="Z:Z_tree">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>_tree</h4>
<pre>protected final&nbsp;<a href="../../com/persistit/Tree.html" title="class in com.persistit">Tree</a> _tree</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getLiveValue--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLiveValue</h4>
<pre>public&nbsp;long&nbsp;getLiveValue()</pre>
<div class="block">Non-transactional view aggregating all updates applied to this
 Accumulator, whether committed or not. See <a
 href="#_SnapshotValue">Snapshot and Live Values</a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the live value</dd>
</dl>
</li>
</ul>
<a name="getSnapshotValue--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSnapshotValue</h4>
<pre>public&nbsp;long&nbsp;getSnapshotValue()
                      throws <a href="../../com/persistit/exception/PersistitInterruptedException.html" title="class in com.persistit.exception">PersistitInterruptedException</a></pre>
<div class="block">Compute the value computed by accumulating values contributed by (a) all
 transactions having commit timestamps less than or equal to the specified
 <code>transaction</code>'s start timestamp, and (b) all operations
 performed by the specified transaction having step numbers equal to or
 less than the <code>transaction</code>'s current step. See <a
 href="#_SnapshotValue">Snapshot and Live Values</a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the computed snapshot value</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd>
<dd><code><a href="../../com/persistit/exception/PersistitInterruptedException.html" title="class in com.persistit.exception">PersistitInterruptedException</a></code></dd>
</dl>
</li>
</ul>
<a name="toString--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;toString()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Accumulator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>org.openidentityplatform.commons.parent 2.1.7-SNAPSHOT Documentation</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../com/persistit/Accumulator.MaxAccumulator.html" title="class in com.persistit"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?com/persistit/Accumulator.html" target="_top">Frames</a></li>
<li><a href="Accumulator.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2024 <a href="https://github.com/OpenIdentityPlatform">Open Identity Platform Community</a>. All rights reserved.</small></p>
</body>
</html>
