<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang>
<head>
<!-- Generated by javadoc (1.8.0_362) on Wed Jan 29 15:29:35 MSK 2025 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Transaction (org.openidentityplatform.commons.parent 2.2.3 Documentation)</title>
<meta name="date" content="2025-01-29">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Transaction (org.openidentityplatform.commons.parent 2.2.3 Documentation)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":42,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Transaction.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>org.openidentityplatform.commons.parent 2.2.3 Documentation</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../com/persistit/TimelyResource.html" title="class in com.persistit"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?com/persistit/Transaction.html" target="_top">Frames</a></li>
<li><a href="Transaction.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.persistit</div>
<h2 title="Class Transaction" class="title">Class Transaction</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.persistit.Transaction</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">Transaction</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block"><p>
 Transaction context for atomic units of work performed by Persistit. Each
 Persistit thread typically uses one <code>Transaction</code> object for its
 lifetime. Within that context it may execute and commit many transactions.
 </p>
 <p>
 The application determines when to <a href="../../com/persistit/Transaction.html#begin--"><code>begin()</code></a>, <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a>,
 <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a> and <a href="../../com/persistit/Transaction.html#end--"><code>end()</code></a> transactions. Once a transaction has
 started, no update operation performed within its context will be visible to
 other threads until <code>commit</code> is performed. At that point, all the
 updates become visible and durable.
 </p>
 <p>
 Persistit implements Multi-Version Concurrency Control (MVCC) with <a
 href="http://wikipedia.org/wiki/Snapshot_isolation">Snapshot Isolation</a>
 for high concurrency and throughput. This protocol is <i>optimistic</i> in
 that competing concurrent transactions run at full speed without locking, but
 can arrive in a state where not all transactions can be allowed to commit
 while preserving correct semantics. In such cases one or more of the
 transactions must roll back (abort) and retry. These topics are covered in
 greater detail below.
 </p>
 <p>
 The <code>Transaction</code> object itself is not thread-safe and may be
 accessed and used by only one thread at a time. However, the database
 operations being executed within the scope defined by <code>begin</code> and
 <code>end</code> are capable of highly concurrent execution.
 </p>
 <h2>Lexical Scoping</h2>
 <p>
 Applications must manage the scope of any transaction by ensuring that
 whenever the <code>begin</code> method is called, there is a concluding
 invocation of the <code>end</code> method. The <code>commit</code> and
 <code>rollback</code> methods do not end the scope of a transaction; they
 merely signify the transaction's intended outcome when <code>end</code> is
 invoked. Applications should follow either the <a href="#_pattern1">
 <code>try/finally</code></a> or the <a href="#_pattern2">
 <code>TransactionRunnable</code></a> pattern to ensure correctness.
 </p>
 <p>
 <a name="commitPolicy"/>
 <h2>Commit Policy</h2>
 Persistit provides three policies that determine the durability of a
 transaction after it has executed the <code>commit</code> method. These are:
 <dl>
 <dt><a href="../../com/persistit/Transaction.CommitPolicy.html#HARD"><code>Transaction.CommitPolicy.HARD</code></a></dt>
 <dd>The <code>commit</code> method does not return until all updates created
 by the transaction have been written to non-volatile storage (e.g., disk
 storage).</dd>
 <dt><a href="../../com/persistit/Transaction.CommitPolicy.html#GROUP"><code>Transaction.CommitPolicy.GROUP</code></a></dt>
 <dd>The <code>commit</code> method does not return until all updates created
 by the transaction have been written to non-volatile storage. In addition,
 the committing transaction waits briefly in an attempt to recruit other
 concurrently running transactions to write their updates with the same
 physical I/O operation.</dd>
 <dt><a href="../../com/persistit/Transaction.CommitPolicy.html#SOFT"><code>Transaction.CommitPolicy.SOFT</code></a></dt>
 <dd>The <code>commit</code> method returns <i>before</i> the updates have
 been recorded on non-volatile storage. Persistit attempts to write them
 within 100 milliseconds, but this interval is not guaranteed.</dd>
 </dl>
 <p>
 You can specify a default policy in the Persistit initialization properties
 using the <a href="../../com/persistit/Configuration.html#COMMIT_POLICY_PROPERTY_NAME">"txnpolicy"</a>
 property or under program control using
 <a href="../../com/persistit/Persistit.html#setDefaultTransactionCommitPolicy-com.persistit.Transaction.CommitPolicy-"><code>Persistit.setDefaultTransactionCommitPolicy(com.persistit.Transaction.CommitPolicy)</code></a> . The default policy
 applies to the <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a> method. You can override the default policy
 using <a href="../../com/persistit/Transaction.html#commit-com.persistit.Transaction.CommitPolicy-"><code>commit(CommitPolicy)</code></a>.
 </p>
 <p>
 HARD and GROUP ensure each transaction is written durably to non-volatile
 storage before the <code>commit</code> method returns. The difference is that
 GROUP can improve throughput somewhat when many transactions are running
 concurrently because the average number of I/O operations needed to commit N
 transactions can be smaller than N. However, for one or a small number of
 concurrent threads, GROUP reduces throughput because it works by introducing
 a delay to allow other concurrent transactions to commit within a single I/O
 operation.
 </p>
 <p>
 SOFT commits are generally much faster than HARD or GROUP commits, especially
 for single-threaded applications, because the results of numerous update
 operations can be aggregated and written to disk in a much smaller number of
 I/O operations. However, transactions written with the SOFT commit policy are
 not immediately durable and it is possible that the recovered state of a
 database will be missing transactions that were committed shortly before a
 crash.
 </p>
 <p>
 For SOFT commits, the state of the database after restart is such that for
 any committed transaction T, either all or none of its modifications will be
 present in the recovered database. Further, if a transaction T2 reads or
 updates data that was written by any other transaction T1, and if T2 is
 present in the recovered database, then so is T1. Any transaction that was in
 progress, but had not been committed at the time of the failure, is
 guaranteed not to be present in the recovered database. SOFT commits are
 designed to be durable within 100 milliseconds after the commit returns.
 However, this interval is determined by computing the average duration of
 recent I/O operations to predict the completion time of the I/O that will
 write the transaction to disk, and therefore the interval cannot be
 guaranteed.
 </p>
 <h2>Optimistic Concurrent Scheduling - MVCC</h2>
 <p>
 Persistit schedules concurrently executing transactions optimistically,
 without locking any database records. Instead, Persistit uses a well-known
 protocol called Snapshot Isolation to achieve atomicity and isolation. While
 transactions are modifying data, Persistit maintains multiple versions of
 values being modified. Each version is labeled with the commit timestamp of
 the transaction that modified it. Whenever a transaction reads a value that
 has been modified by other transactions, it reads the latest version that was
 committed before its own start timestamp. In other words, all read operations
 are performed as if from a "snapshot" of the state of the database made at
 the transaction's start timestamp - hence the name "Snapshot Isolation."
 </p>
 <h3>Pruning</h3>
 <p>
 Given that all updates written through transactions are created as versions
 within the MVCC scheme, a large number of versions can accumulate over time.
 Persistit reduces this number through an activity called "version pruning."
 Pruning resolves the final state of each version by removing any versions
 created by aborted transactions and removing obsolete versions no longer
 needed by currently executing transactions. If a value contains only one
 version and the commit timestamp of the transaction that created it is before
 the start of any currently running transaction, that value is called
 <i>primordial</i>. The goal of pruning is to reduce almost all values in a
 Persistit Tree to their primordial states because updating and reading
 primordial values is more efficient than the handling required for multiple
 version values. Pruning happens automatically and is generally not visible to
 the application.
 </p>
 <h3>Rollbacks</h3>
 <p>
 Usually Snapshot Isolation allows concurrent transactions to commit without
 interference but this is not always the case. Two concurrent transactions
 that attempt to modify the same Persistit key-value pair before committing
 are said to have a "write-write dependency". To avoid anomalous results one
 of them must abort, rolling back any other updates it may have created, and
 retry. Persistit implements a "first updater wins" policy in which if two
 transactions attempt to update the same record, the first transaction "wins"
 by being allowed to continue, while the second transaction "loses" and is
 required to abort.
 </p>
 <p>
 Once a transaction has aborted, any subsequent database operation it attempts
 throws a <a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception"><code>RollbackException</code></a>. Application code should generally catch
 and handle the <code>RollbackException</code>. Usually the correct and
 desired behavior is simply to retry the transaction. See <a
 href="#_pattern1"><code>try/finally</code></a> for a code pattern that
 accomplishes this.
 </p>
 <p>
 A transaction can also voluntarily roll back. For example, transaction logic
 could detect an error condition that it chooses to handle by throwing an
 exception back to the application. In this case the transaction should invoke
 the <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a> method to explicit declare its intent to abort the
 transaction.
 </p>
 <h3>Read-Only Transactions</h3>
 <p>
 Under Snapshot Isolation, transactions that read but do not modify data
 cannot generate any write-write dependencies and are therefore not subject to
 being rolled back because of the actions of other transactions. However, note
 that even if it modifies no data, a long-running transaction can force
 Persistit to retain old value versions for its duration in order to provide a
 snapshot view. This behavior can cause congestion and performance degradation
 by preventing very old values from being pruned. The degree to which this is
 a problem depends on the volume of update transactions being processed and
 the duration of long-running transactions.
 </p>
 
 <a name="_pattern1"/> <h2>The try/finally/retry Code Pattern</h2>
 <p>
 The following code fragment illustrates a transaction executed with up to to
 RETRY_COUNT retries. If the <code>commit</code> method succeeds, the whole
 transaction is completed and the retry loop terminates. If after RETRY_COUNT
 retries <code>commit</code> has not been successfully completed, the
 application throws a <code>TransactionFailedException</code>.
 </p>
 
 <blockquote><code><pre>
     Transaction txn = Persistit.getTransaction();
     int remainingAttempts = RETRY_COUNT;
     for (;;) {
         txn.begin();         // Begin transaction scope
         try {
             //
             // ...perform Persistit fetch, remove and store operations...
             //
             txn.commit();     // attempt to commit the updates
             break;            // Exit retry loop
         }
         catch (RollbackException re) {
             if (--remainingAttempts &lt; 0) {
                 throw new TransactionFailedException(); 
             {
         }
         finally {
             txn.end();       // End transaction scope. Implicitly 
                              // roll back all updates unless
                              // commit completed successfully.
         }
     }
 </pre></code></blockquote>
 
 <a name="_pattern2" /> <h2>The TransactionRunnable Pattern</h2>
 <p>
 As an alternative, the application can embed the actual database operations
 within a <a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit"><code>TransactionRunnable</code></a> and invoke the <a href="../../com/persistit/Transaction.html#run-com.persistit.TransactionRunnable-"><code>run(com.persistit.TransactionRunnable)</code></a> method to
 execute it. The retry logic detailed in the fragment shown above is handled
 automatically by <code>run</code>; it could be rewritten as follows:
 
 <blockquote><code><pre>
     Transaction txn = Persistit.getTransaction();
     txn.run(new TransactionRunnable() {
         public void runTransaction()
         throws PersistitException, RollbackException {
             //
             //...perform Persistit fetch, remove and store operations...
             //
         }
     }, RETRY_COUNT, 0);
 </pre></code></blockquote>
 
 </p>
 <a name="_scopedCodePattern"/> <h2>Nested Transaction Scope</h2>
 <p>
 Persistit supports nested transactions by counting the number of nested
 <a href="../../com/persistit/Transaction.html#begin--"><code>begin()</code></a> and <a href="../../com/persistit/Transaction.html#end--"><code>end()</code></a> operations. Each invocation of
 <code>begin</code> increments this count and each invocation of
 <code>end</code> decrements the count. These methods are intended to be used
 in a standard essential pattern, shown here, to ensure that the scope of of
 the transaction is reliably determined by the lexical the structure of the
 code rather than conditional logic: <blockquote><code><pre>
     <b>txn.begin();</b>
     try {
         //
         // Application transaction logic here, possibly including 
         // invocation of methods that also call txn.begin() and
         // txn.end().
         //
         <b>txn.commit();</b>
     } finally {
         <b>txn.end();</b>
     }
 </pre></code></blockquote>
 </p>
 <p>
 This pattern ensures that the transaction scope is ended properly regardless
 of whether the application code throws an exception or completes and commits
 normally.
 </p>
 <p>
 The <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a> method performs the actual commit operation only when the
 current nested level count (see <a href="../../com/persistit/Transaction.html#getNestedTransactionDepth--"><code>getNestedTransactionDepth()</code></a>) is 1.
 That is, if <code>begin</code> has been invoked N times, then
 <code>commit</code> will actually commit the data only when <code>end</code>
 is invoked the Nth time. Data updated by an inner (nested) transaction is
 never actually committed until the outermost <code>commit</code> is called.
 This permits transactional code to invoke other code (possibly an opaque
 library supplied by a third party) that may itself <code>begin</code> and
 <code>commit</code> transactions.
 </p>
 <p>
 Invoking <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a> removes all pending but uncommitted updates and
 marks the current transaction scope as <i>rollback pending</i>. Any
 subsequent attempt to perform any Persistit operation, including
 <code>commit</code> in the current transaction scope, will fail with a
 <code>RollbackException</code>.
 </p>
 <p>
 Application developers should beware that the <a href="../../com/persistit/Transaction.html#end--"><code>end()</code></a> method performs an
 implicit rollback if <code>commit</code> has not completed. Therefore, if an
 application fails to call <code>commit</code>, the transaction will silently
 fail. The <code>end</code> method sends a warning message to the log
 subsystem when this happens, but does not throw an exception. The
 <code>end</code> method is designed this way to allow an exception thrown
 within the application code to be caught and handled without being obscured
 by a RollbackException thrown by <code>end</code>. But as a consequence,
 developers must carefully verify that the <code>end</code> method is always
 invoked whether or not the transaction completes normally.
 </p>
 <h2>Step Index: Controlling Visibility of Uncommitted Updates</h2>
 <p>
 By default, application logic within the scope of a transaction can read two
 kinds of values: those that were committed by other transactions prior to the
 start of the current transaction (from the "snapshot") and those that were
 modified by the transaction itself. However, in some applications it is
 useful to control the visibility of modifications made by the current
 transaction. For example, update queries that select records to update and
 then change the very values used as selection criteria can produce anomalous
 results. See <a
 href="http://en.wikipedia.org/wiki/Halloween_Problem">Halloween Problem</a>
 for a succinct description of this issue. Persistit provides a mechanism to
 control visibility of a transaction's own modifications to avoid this
 problem.
 </p>
 <p>
 While a transaction is executing, every updated value it generates is stored
 within a multi-version value and labeled with the transaction ID of the
 transaction that produced it <u>and</u> a small integer index (0-99) called
 the <i>step</i>.
 </p>
 <p>
 The current step index is an attribute of the <code>Transaction</code> object
 available from <a href="../../com/persistit/Transaction.html#getStep--"><code>getStep()</code></a>. The <code>begin</code> method resets its
 value to zero. An application can invoke <a href="../../com/persistit/Transaction.html#incrementStep--"><code>incrementStep()</code></a> to increment
 it, or <a href="../../com/persistit/Transaction.html#setStep-int-"><code>setStep(int)</code></a> to control its current value. Modifications created
 by the transaction are labeled with the current step value.
 </p>
 <p>
 When reading data, modifications created by the current transaction are
 visible to Persistit if and only if the step number they were assigned is
 less or equal to the <code>Transaction</code>'s current step number. An
 application can take advantage of this by controlling the current step index,
 for example, by reading data using step 0 while posting updates with a step
 value of 1.
 </p>
 <a name="_threadManagement" /> <h2>Thread Management</h2>
 <p>
 As noted above, a <code>Transaction</code> typically belongs to one thread
 for its entire lifetime and is <i>not</i> threadsafe. However, to support
 server applications which may manage a large number of sessions among a
 smaller number of threads, Persisit allows an application to manage sessions
 explicitly. See <a href="../../com/persistit/Persistit.html#getSessionId--"><code>Persistit.getSessionId()</code></a> and
 <a href="../../com/persistit/Persistit.html#setSessionId-com.persistit.SessionId-"><code>Persistit.setSessionId(SessionId)</code></a>. The method
 <a href="../../com/persistit/Persistit.html#getTransaction--"><code>Persistit.getTransaction()</code></a> is sensitive to the thread's current
 <code>SessionId</code>, and therefore the following style of interaction is
 possible:
 <ul>
 <li>Thread T1 is assigned work for session S.</li>
 <li>Thread T1 invokes <code>begin</code>, does some work and then returns
 control to a client.</li>
 <li>Thread T2 receives additional work to perform on behalf of session S.</li>
 <li>Thread T2 sets its current SessionId to session S</li>
 <li>Thread T2 then uses <a href="../../com/persistit/Persistit.html#getTransaction--"><code>Persistit.getTransaction()</code></a> to acquire the
 same transaction context previously started by T1.</li>
 <li>Thread T2 does additional work and then calls <code>commit</code> and
 <code>end</code> to complete the transaction.</li>
 </ul>
 Applications that use this technique must be written carefully to ensure that
 multiple threads never execute with the same SessionId. Concurrent access to
 a <code>Transaction</code> or <code>Exchange</code> can cause serious errors,
 including database corruption.
 </p>
 <h2>Additional Notes</h2>
 <p>
 Optimistic concurrency control works well when the likelihood of conflicting
 transactions - that is, concurrent execution of two or more transactions that
 modify the same database records - is low. For most applications this
 assumption is valid.
 </p>
 <p>
 For best performance, applications in which multiple threads frequently
 operate on overlapping data such that roll-backs are likely, the application
 should implement its own locks to prevent or reduce the likelihood of
 collisions.
 </p>
 <p>
 An application can examine counts of commits, rollbacks and rollbacks since
 the last successful commit using <a href="../../com/persistit/Transaction.html#getCommittedTransactionCount--"><code>getCommittedTransactionCount()</code></a>,
 <a href="../../com/persistit/Transaction.html#getRolledBackTransactionCount--"><code>getRolledBackTransactionCount()</code></a> and
 <a href="../../com/persistit/Transaction.html#getRolledBackSinceLastCommitCount--"><code>getRolledBackSinceLastCommitCount()</code></a>, respectively.
 </p></div>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>1.1</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">Deprecated Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#begin--">begin</a></span>()</code>
<div class="block">Start a transaction.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#checkPendingRollback--">checkPendingRollback</a></span>()</code>
<div class="block">Throws a <a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception"><code>RollbackException</code></a> if this transaction context has a
 roll-back transition pending.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#commit--">commit</a></span>()</code>
<div class="block">
 Commit this transaction.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#commit-boolean-">commit</a></span>(boolean&nbsp;toDisk)</code>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#commit-com.persistit.Transaction.CommitPolicy-">commit</a></span>(<a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;policy)</code>
<div class="block">
 Commit this transaction.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#end--">end</a></span>()</code>
<div class="block">
 End the current transaction scope.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getCommittedTransactionCount--">getCommittedTransactionCount</a></span>()</code>
<div class="block">Return the number of transactions committed by this transaction context.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getCommitTimestamp--">getCommitTimestamp</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getDefaultCommitPolicy--">getDefaultCommitPolicy</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getId--">getId</a></span>()</code>
<div class="block">Returns the internal transaction identifier.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getNestedTransactionDepth--">getNestedTransactionDepth</a></span>()</code>
<div class="block">Returns the nested level count.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getRolledBackSinceLastCommitCount--">getRolledBackSinceLastCommitCount</a></span>()</code>
<div class="block">Return the number of times a transaction in this <code>Transaction</code>
 context has rolled back since the last successful <code>commit</code>
 operations.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getRolledBackTransactionCount--">getRolledBackTransactionCount</a></span>()</code>
<div class="block">Return the number of transactions rolled back by this transaction
 context.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="../../com/persistit/SessionId.html" title="class in com.persistit">SessionId</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getSessionId--">getSessionId</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getStartTimestamp--">getStartTimestamp</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#getStep--">getStep</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#incrementStep--">incrementStep</a></span>()</code>
<div class="block">Increment this transaction's current step index.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#isActive--">isActive</a></span>()</code>
<div class="block">Indicates whether the application has invoked <a href="../../com/persistit/Transaction.html#begin--"><code>begin()</code></a> but has not
 yet invoked a matching <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a> or <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a>.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#isCommitted--">isCommitted</a></span>()</code>
<div class="block">Indicates whether the <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a> method has run to successful
 completion at the current nested level.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#isRollbackPending--">isRollbackPending</a></span>()</code>
<div class="block">Indicates whether the current transaction scope has been marked for
 rollback.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#rollback--">rollback</a></span>()</code>
<div class="block">
 Explicitly rolls back all work done within the scope of this transaction.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#run-com.persistit.TransactionRunnable-">run</a></span>(<a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit">TransactionRunnable</a>&nbsp;runnable)</code>
<div class="block">
 Invokes the <a href="../../com/persistit/TransactionRunnable.html#runTransaction--"><code>TransactionRunnable.runTransaction()</code></a> method of an
 object that implements <a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit"><code>TransactionRunnable</code></a> within the scope of a
 transaction.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#run-com.persistit.TransactionRunnable-int-long-boolean-">run</a></span>(<a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit">TransactionRunnable</a>&nbsp;runnable,
   int&nbsp;retryCount,
   long&nbsp;retryDelay,
   boolean&nbsp;toDisk)</code>
<div class="block">
 Invokes the <a href="../../com/persistit/TransactionRunnable.html#runTransaction--"><code>TransactionRunnable.runTransaction()</code></a> method of an
 object that implements <a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit"><code>TransactionRunnable</code></a> within the scope of a
 transaction.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#run-com.persistit.TransactionRunnable-int-long-com.persistit.Transaction.CommitPolicy-">run</a></span>(<a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit">TransactionRunnable</a>&nbsp;runnable,
   int&nbsp;retryCount,
   long&nbsp;retryDelay,
   <a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;toDisk)</code>&nbsp;</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#setDefaultCommitPolicy-com.persistit.Transaction.CommitPolicy-">setDefaultCommitPolicy</a></span>(<a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;policy)</code>
<div class="block">Set the current default policy</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#setStep-int-">setStep</a></span>(int&nbsp;step)</code>
<div class="block">Set the current step index.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../com/persistit/Transaction.html#toString--">toString</a></span>()</code>
<div class="block">Returns displayable information about this transaction.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="checkPendingRollback--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkPendingRollback</h4>
<pre>public&nbsp;void&nbsp;checkPendingRollback()
                          throws <a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception">RollbackException</a></pre>
<div class="block">Throws a <a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception"><code>RollbackException</code></a> if this transaction context has a
 roll-back transition pending.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception">RollbackException</a></code></dd>
</dl>
</li>
</ul>
<a name="isActive--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isActive</h4>
<pre>public&nbsp;boolean&nbsp;isActive()</pre>
<div class="block">Indicates whether the application has invoked <a href="../../com/persistit/Transaction.html#begin--"><code>begin()</code></a> but has not
 yet invoked a matching <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a> or <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if a transaction has begun, but is not yet
         either committed or rolled back</dd>
</dl>
</li>
</ul>
<a name="isCommitted--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isCommitted</h4>
<pre>public&nbsp;boolean&nbsp;isCommitted()</pre>
<div class="block">Indicates whether the <a href="../../com/persistit/Transaction.html#commit--"><code>commit()</code></a> method has run to successful
 completion at the current nested level. If that level is 1, then
 successful completion of <code>commit</code> means that the transaction
 has actually been committed to the database. Within the scope of inner
 (nested) transactions, data is not actually committed until the outermost
 transaction scope commits.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the current transaction scope has completed
         its <code>commit</code> operation; otherwise <code>false</code>.</dd>
</dl>
</li>
</ul>
<a name="isRollbackPending--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isRollbackPending</h4>
<pre>public&nbsp;boolean&nbsp;isRollbackPending()</pre>
<div class="block">Indicates whether the current transaction scope has been marked for
 rollback. If so, and if this is an inner (nested) transaction scope, all
 updates performed by the containing scope will also be rolled back.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the current transaction is marked for
         rollback; otherwise <code>false</code>.</dd>
</dl>
</li>
</ul>
<a name="begin--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>begin</h4>
<pre>public&nbsp;void&nbsp;begin()
           throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<div class="block">Start a transaction. If there already is an active transaction then this
 method merely increments a counter that indicates how many times
 <code>begin</code> has been called. Application code should ensure that
 every method that calls <code>begin</code> also invokes <code>end</code>
 using a <code>try/finally</code> pattern described <a
 href="#_scopedCodePattern">above</a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if the current transaction scope has already been committed.</dd>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code></dd>
</dl>
</li>
</ul>
<a name="end--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>end</h4>
<pre>public&nbsp;void&nbsp;end()</pre>
<div class="block"><p>
 End the current transaction scope. Application code should ensure that
 every method that calls <code>begin</code> also invokes <code>end</code>
 using a <code>try/finally</code> pattern described in <a
 href="#_scopedCodePattern">above</a>.
 </p>
 <p>
 This method implicitly rolls back any pending, uncommitted updates.
 Updates are committed only if the <code>commit</code> method completes
 successfully.
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitIOException.html" title="class in com.persistit.exception">PersistitIOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if there is no current transaction scope.</dd>
</dl>
</li>
</ul>
<a name="rollback--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rollback</h4>
<pre>public&nbsp;void&nbsp;rollback()</pre>
<div class="block"><p>
 Explicitly rolls back all work done within the scope of this transaction.
 If this transaction is not active, then this method throws an Exception.
 No further updates can be applied within the scope of this transaction.
 </p>
 <p>
 If called within the scope of a nested transaction, this method causes
 all enclosing transactions to roll back. This ensures that the outermost
 transaction will not commit if any inner transaction has rolled back.
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitIOException.html" title="class in com.persistit.exception">PersistitIOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if there is no transaction scope or the current scope has
             already been committed.</dd>
</dl>
</li>
</ul>
<a name="commit--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public&nbsp;void&nbsp;commit()
            throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<div class="block"><p>
 Commit this transaction. This method flushes the journal entries created
 by the transaction to the journal buffer, optionally waits for those
 changes to be written durably to disk according to the default configured
 <a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit"><code>Transaction.CommitPolicy</code></a>, and marks the transaction as completed so that its
 effects are visible to other transactions.
 </p>
 <p>
 If executed within the scope of an outer transaction, this method simply
 sets a flag indicating that the current transaction level has committed
 without modifying any data. The commit for the outermost transaction
 scope is responsible for actually committing the changes.
 </p>
 <p>
 Once an application thread has called <code>commit</code>, no subsequent
 Persistit database operations are permitted until the <code>end</code>
 method has been called. An attempt to store, fetch or remove data after
 <code>commit</code> has been called throws an
 <code>IllegalStateException</code>.
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitIOException.html" title="class in com.persistit.exception">PersistitIOException</a></code> - if the transaction could not be written to the journal due to
             an IOException. This exception also causes the transaction to
             be rolled back.</dd>
<dd><code><a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception">RollbackException</a></code> - if the <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a> was previously called</dd>
<dd><code><a href="../../com/persistit/exception/PersistitInterruptedException.html" title="class in com.persistit.exception">PersistitInterruptedException</a></code> - if the thread was interrupted while waiting for I/O
             completion</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if no transaction scope is active or this transaction scope
             has already called <code>commit</code></dd>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code> - if a PersistitException was caught by the JOURNAL_FLUSHER
             thread after this transaction began waiting for durability</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../com/persistit/Persistit.html#getDefaultTransactionCommitPolicy--"><code>Persistit.getDefaultTransactionCommitPolicy()</code></a></dd>
</dl>
</li>
</ul>
<a name="commit-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html?is-external=true" title="class or interface in java.lang">@Deprecated</a>
public&nbsp;void&nbsp;commit(boolean&nbsp;toDisk)
                        throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;</div>
<div class="block">Commit to disk with <a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit"><code>Transaction.CommitPolicy</code></a> determined by the supplied
 boolean value. This method is obsolete and will be removed shortly.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code></dd>
</dl>
</li>
</ul>
<a name="commit-com.persistit.Transaction.CommitPolicy-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public&nbsp;void&nbsp;commit(<a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;policy)
            throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<div class="block"><p>
 Commit this transaction. This method flushes the journal entries created
 by the transaction to the journal buffer, optionally waits for those
 changes to be written durably to disk according to the supplied
 <a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit"><code>Transaction.CommitPolicy</code></a>, and marks the transaction as completed so that its
 effects are visible to other transactions.
 </p>
 <p>
 If executed within the scope of an outer transaction, this method simply
 sets a flag indicating that the current transaction level has committed
 without modifying any data. The commit for the outermost transaction
 scope is responsible for actually committing the changes.
 </p>
 <p>
 Once an application thread has called <code>commit</code>, no subsequent
 Persistit database operations are permitted until the <code>end</code>
 method has been called. An attempt to store, fetch or remove data after
 <code>commit</code> has been called throws an
 <code>IllegalStateException</code>.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>policy</code> - Determines whether the commit method waits until the
            transaction has been written to durable storage before
            returning to the caller.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitIOException.html" title="class in com.persistit.exception">PersistitIOException</a></code> - if the transaction could not be written to the journal due to
             an IOException. This exception also causes the transaction to
             be rolled back.</dd>
<dd><code><a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception">RollbackException</a></code> - if the <a href="../../com/persistit/Transaction.html#rollback--"><code>rollback()</code></a> was previously called</dd>
<dd><code><a href="../../com/persistit/exception/PersistitInterruptedException.html" title="class in com.persistit.exception">PersistitInterruptedException</a></code> - if the thread was interrupted while waiting for I/O
             completion</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if no transaction scope is active or this transaction scope
             has already called <code>commit</code></dd>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code> - if a PersistitException was caught by the JOURNAL_FLUSHER
             thread after this transaction began waiting for durability</dd>
</dl>
</li>
</ul>
<a name="getNestedTransactionDepth--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNestedTransactionDepth</h4>
<pre>public&nbsp;int&nbsp;getNestedTransactionDepth()</pre>
<div class="block">Returns the nested level count. When no transaction scope is active this
 method returns 0. Within the outermost transaction scope this method
 returns 1. For nested transactions this method returns a value of 2 or
 higher.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The nested transaction depth</dd>
</dl>
</li>
</ul>
<a name="run-com.persistit.TransactionRunnable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;int&nbsp;run(<a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit">TransactionRunnable</a>&nbsp;runnable)
        throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<div class="block"><p>
 Invokes the <a href="../../com/persistit/TransactionRunnable.html#runTransaction--"><code>TransactionRunnable.runTransaction()</code></a> method of an
 object that implements <a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit"><code>TransactionRunnable</code></a> within the scope of a
 transaction. The <code>TransactionRunnable</code> should neither
 <code>begin</code> nor <code>commit</code> the transaction; these
 operations are performed by this method. The
 <code>TransactionRunnable</code> <i>may</i> explicitly throw a
 <code>RollbackException</code> in which case the current transaction will
 be rolled back.
 </p>
 <p>
 This method does not perform retries, so upon the first failed attempt to
 commit the transaction this method will throw a
 <code>RollbackException</code>. See
 <a href="../../com/persistit/Transaction.html#run-com.persistit.TransactionRunnable-int-long-boolean-"><code>run(TransactionRunnable, int, long, boolean)</code></a> for retry handling.
 This method commits the transaction to <a
 href="#commitPolicy">memory</a>, which means that the update is not
 guaranteed to be durable.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>runnable</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Count of passes needed to complete the transaction. Always 1 on
         successful completion.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code></dd>
</dl>
</li>
</ul>
<a name="run-com.persistit.TransactionRunnable-int-long-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;int&nbsp;run(<a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit">TransactionRunnable</a>&nbsp;runnable,
               int&nbsp;retryCount,
               long&nbsp;retryDelay,
               boolean&nbsp;toDisk)
        throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<div class="block"><p>
 Invokes the <a href="../../com/persistit/TransactionRunnable.html#runTransaction--"><code>TransactionRunnable.runTransaction()</code></a> method of an
 object that implements <a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit"><code>TransactionRunnable</code></a> within the scope of a
 transaction. The <code>TransactionRunnable</code> should neither
 <code>begin</code> nor <code>commit</code> the transaction; these
 operations are performed by this method. The
 <code>TransactionRunnable</code> <i>may</i> explicitly or implicitly
 throw a <code>RollbackException</code> in which case the current
 transaction will be rolled back.
 </p>
 <p>
 If <code>retryCount</code> is greater than zero, this method will make up
 to <code>retryCount</code> additional of attempts to complete and commit
 the transaction. Once the retry count is exhausted, this method throws a
 <code>RollbackException</code>.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>runnable</code> - An application specific implementation of
            <code>TransactionRunnable</code> containing logic to access
            and update Persistit data.</dd>
<dd><code>retryCount</code> - Number of attempts (not including the first attempt) to make
            before throwing a <code>RollbackException</code></dd>
<dd><code>retryDelay</code> - Time, in milliseconds, to wait before the next retry attempt.</dd>
<dd><code>toDisk</code> - <code>SOFT</code>, <code>HARD</code> or <code>GROUP</code> to
            commit achieve durability or throughput, as required by the
            application.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Count of attempts needed to complete the transaction</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code></dd>
<dd><code><a href="../../com/persistit/exception/RollbackException.html" title="class in com.persistit.exception">RollbackException</a></code> - If after <code>retryCount+1</code> attempts the transaction
             cannot be completed or committed due to concurrent updated
             performed by other threads.</dd>
</dl>
</li>
</ul>
<a name="run-com.persistit.TransactionRunnable-int-long-com.persistit.Transaction.CommitPolicy-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;int&nbsp;run(<a href="../../com/persistit/TransactionRunnable.html" title="interface in com.persistit">TransactionRunnable</a>&nbsp;runnable,
               int&nbsp;retryCount,
               long&nbsp;retryDelay,
               <a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;toDisk)
        throws <a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../com/persistit/exception/PersistitException.html" title="class in com.persistit.exception">PersistitException</a></code></dd>
</dl>
</li>
</ul>
<a name="toString--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;toString()</pre>
<div class="block">Returns displayable information about this transaction.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Information about this Transaction</dd>
</dl>
</li>
</ul>
<a name="getDefaultCommitPolicy--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefaultCommitPolicy</h4>
<pre>public&nbsp;<a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;getDefaultCommitPolicy()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the current default policy</dd>
</dl>
</li>
</ul>
<a name="setDefaultCommitPolicy-com.persistit.Transaction.CommitPolicy-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setDefaultCommitPolicy</h4>
<pre>public&nbsp;void&nbsp;setDefaultCommitPolicy(<a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit">Transaction.CommitPolicy</a>&nbsp;policy)</pre>
<div class="block">Set the current default policy</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>policy</code> - </dd>
</dl>
</li>
</ul>
<a name="getId--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getId</h4>
<pre>public&nbsp;long&nbsp;getId()</pre>
<div class="block">Returns the internal transaction identifier.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The transaction identifier</dd>
</dl>
</li>
</ul>
<a name="getStartTimestamp--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStartTimestamp</h4>
<pre>public&nbsp;long&nbsp;getStartTimestamp()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the internal start timestamp of this transaction.</dd>
</dl>
</li>
</ul>
<a name="getCommitTimestamp--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCommitTimestamp</h4>
<pre>public&nbsp;long&nbsp;getCommitTimestamp()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the internal timestamp at which transaction committed.</dd>
</dl>
</li>
</ul>
<a name="getSessionId--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSessionId</h4>
<pre>public&nbsp;<a href="../../com/persistit/SessionId.html" title="class in com.persistit">SessionId</a>&nbsp;getSessionId()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the SessionId this Transaction context belongs too.</dd>
</dl>
</li>
</ul>
<a name="getCommittedTransactionCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCommittedTransactionCount</h4>
<pre>public&nbsp;long&nbsp;getCommittedTransactionCount()</pre>
<div class="block">Return the number of transactions committed by this transaction context.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The count</dd>
</dl>
</li>
</ul>
<a name="getRolledBackTransactionCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRolledBackTransactionCount</h4>
<pre>public&nbsp;long&nbsp;getRolledBackTransactionCount()</pre>
<div class="block">Return the number of transactions rolled back by this transaction
 context.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The count</dd>
</dl>
</li>
</ul>
<a name="getRolledBackSinceLastCommitCount--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRolledBackSinceLastCommitCount</h4>
<pre>public&nbsp;int&nbsp;getRolledBackSinceLastCommitCount()</pre>
<div class="block">Return the number of times a transaction in this <code>Transaction</code>
 context has rolled back since the last successful <code>commit</code>
 operations.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The count</dd>
</dl>
</li>
</ul>
<a name="getStep--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStep</h4>
<pre>public&nbsp;int&nbsp;getStep()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the current step index.</dd>
</dl>
</li>
</ul>
<a name="setStep-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setStep</h4>
<pre>public&nbsp;int&nbsp;setStep(int&nbsp;step)</pre>
<div class="block">Set the current step index. Must be in the range [0, 99].
 <p>
 Also see <a href="../../com/persistit/Transaction.html#incrementStep--"><code>incrementStep()</code></a> for step semantics.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>step</code> - New step index value.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Previous step value.</dd>
</dl>
</li>
</ul>
<a name="incrementStep--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>incrementStep</h4>
<pre>public&nbsp;int&nbsp;incrementStep()</pre>
<div class="block">Increment this transaction's current step index. For any given step,
 values written by updates within this transaction are visible (within
 this transaction) only if they were written with earlier or equal step
 indexes. In other words, a transaction that writes an update at step N
 can see the result of that update when reading the database and any step
 &lt;= N. This mechanism helps solve the "Halloween" problem in which a
 SELECT query producing values to UPDATE should not be able to read back
 those update values.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The previous value of the step.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this method is called more than 99 times within the scope
             of one transaction.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Transaction.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>org.openidentityplatform.commons.parent 2.2.3 Documentation</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../com/persistit/TimelyResource.html" title="class in com.persistit"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../com/persistit/Transaction.CommitPolicy.html" title="enum in com.persistit"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?com/persistit/Transaction.html" target="_top">Frames</a></li>
<li><a href="Transaction.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2025 <a href="https://github.com/OpenIdentityPlatform">Open Identity Platform Community</a>. All rights reserved.</small></p>
</body>
</html>
