<!DOCTYPE HTML>
<!-- NewPage -->
<html lang>
<head>
<!-- Generated by javadoc -->
<title>PolicyEnforcementFilter (OpenIG Project 6.0.3-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PolicyEnforcementFilter (OpenIG Project 6.0.3-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PolicyEnforcementFilter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.forgerock.openig.openam</a></div>
<h2 title="Class PolicyEnforcementFilter" class="title">Class PolicyEnforcementFilter</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.forgerock.openig.openam.PolicyEnforcementFilter</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code>org.forgerock.http.Filter</code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">PolicyEnforcementFilter</span>
extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>
implements org.forgerock.http.Filter</pre>
<div class="block">This filter requests policy decisions from OpenAM which evaluates the
 original URI based on the context and the policies configured, and according
 to the decisions, allows or denies the current request.
 <p>
 If the decision denies the request, a 403 FORBIDDEN is returned.
 If an error occurred during the process, a 500 INTERNAL SERVER ERROR is returned.
 <p>
 Policy decisions are cached for each filter and eviction is based on the
 "time-to-live" given in the policy decision returned by AM, if this one
 exceed the duration expressed in the cacheMaxExpiration, then the value of
 cacheMaxExpiration is used to cache the policy.

 <pre>
 <code>{
      "type": "PolicyEnforcementFilter",
      "config": {
          "openamUrl"              :    uriExpression,      [REQUIRED]
          "pepUsername"            :    expression,         [REQUIRED*]
          "pepPassword"            :    expression,         [REQUIRED*]
          "pepRealm"               :    String,             [OPTIONAL*- default value is the one used for "realm"
                                                                        attribute]
          "amHandler"              :    handler,            [OPTIONAL - by default it uses the
                                                                        'ForgeRockClientHandler' provided in heap.]
          "realm"                  :    String,             [OPTIONAL - default is '/']
          "ssoTokenHeader"         :    String,             [OPTIONAL]
          "application"            :    String,             [OPTIONAL]
          "ssoTokenSubject"        :    expression,         [OPTIONAL - must be specified if no jwtSubject or
                                                                        claimsSubject ]
          "jwtSubject"             :    expression,         [OPTIONAL - must be specified if no ssoTokenSubject or
                                                                        claimsSubject ]
          "claimsSubject"          :    map/expression,     [OPTIONAL - must be specified if no jwtSubject or
                                                                        ssoTokenSubject - instance of
                                                                        Map&lt;String, Object&gt; JWT claims ]
          "environment"            :    map/expression,     [OPTIONAL - instance of Map&lt;String, List&lt;Object&gt;&gt;]
          "executor"               :    executor,           [OPTIONAL - by default uses 'ScheduledThreadPool'
                                                                        heap object]
          "failureHandler          :    handler,            [OPTIONAL - default to 403]
          "cache"                  :    object,             [OPTIONAL - cache configuration. Default is no caching.]
              "enabled"            :    boolean,            [OPTIONAL - default to false. Enable or not the caching of
                                                                        the policy decisions.]
              "defaultTimeout"     :    duration,           [OPTIONAL - default to 1 minute. If no valid ttl value is
                                                                        provided by the policy decision, we'll cache
                                                                        it during that duration.]
              "maxTimeout"         :    duration,           [OPTIONAL - If a value is provided by the policy decision
                                                                        but is greater that this value then we'll use
                                                                        that value. ("zero" and "unlimited" are not
                                                                        acceptable values).]
      }
  }
  </code>
 </pre>
 <p>
 (*) "pepUsername" and "pepPassword" are the credentials, and "pepRealm" is the
 realm of the user who has access to perform the operation.
 <p>
 This heaplet adds an HeadlessAuthenticationFilter to the amHandler's chain and its
 role is to retrieve and set the SSO token header of this given user (REST API
 calls must present the session token, aka SSO Token, in an HTTP header as
 proof of authentication).
 <p>
 The "attributes" and "advices" from the policy decision are saved in a <a href="PolicyDecisionContext.html" title="class in org.forgerock.openig.openam"><code>PolicyDecisionContext</code></a>.
 <p>
 Example of use:

 <pre>
 <code>{
      "name": "PEPFilter",
      "type": "PolicyEnforcementFilter",
      "config": {
          "openamUrl": "http://example.com:8090/openam/",
          "pepUsername": "bjensen",
          "pepPassword": "${system['pep.password']}",
          "application": "myApplication",
          "ssoTokenSubject": "${attributes.SSOCurrentUser}",
          "claimsSubject": "${attributes.claimsSubject}",
          "environment": {
              "DAY_OF_WEEK": [
                  "Saturday"
              ]
          }
      }
  }
  </code>
 </pre></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="http://openam.forgerock.org/doc/bootstrap/dev-guide/index.html#rest-api-authz-policy-decisions">
      Requesting Policy Decisions in OpenAM</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="PolicyEnforcementFilter.Heaplet.html" title="class in org.forgerock.openig.openam">PolicyEnforcementFilter.Heaplet</a></span></code></th>
<td class="colLast">
<div class="block">Creates and initializes a policy enforcement filter in a heap environment.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.forgerock.json.resource.RequestHandler,org.forgerock.http.Handler)">PolicyEnforcementFilter</a></span>&#8203;(org.forgerock.json.resource.RequestHandler&nbsp;requestHandler,
                       org.forgerock.http.Handler&nbsp;failureHandler)</code></th>
<td class="colLast">
<div class="block">Creates a new OpenAM enforcement filter.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>org.forgerock.util.promise.Promise&lt;org.forgerock.http.protocol.Response,&#8203;org.forgerock.util.promise.NeverThrowsException&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#filter(org.forgerock.services.context.Context,org.forgerock.http.protocol.Request,org.forgerock.http.Handler)">filter</a></span>&#8203;(org.forgerock.services.context.Context&nbsp;context,
      org.forgerock.http.protocol.Request&nbsp;request,
      org.forgerock.http.Handler&nbsp;next)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setApplication(java.lang.String)">setApplication</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;application)</code></th>
<td class="colLast">
<div class="block">Sets the application where the policies are defined.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setClaimsSubject(org.forgerock.util.Function)">setClaimsSubject</a></span>&#8203;(org.forgerock.util.Function&lt;<a href="../el/Bindings.html" title="class in org.forgerock.openig.el">Bindings</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;,&#8203;<a href="../el/ExpressionException.html" title="class in org.forgerock.openig.el">ExpressionException</a>&gt;&nbsp;claimsSubject)</code></th>
<td class="colLast">
<div class="block">Sets a function that returns a map of JWT claims to their values, for the
 subject.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setEnvironment(org.forgerock.util.Function)">setEnvironment</a></span>&#8203;(org.forgerock.util.Function&lt;<a href="../el/Bindings.html" title="class in org.forgerock.openig.el">Bindings</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;&gt;,&#8203;<a href="../el/ExpressionException.html" title="class in org.forgerock.openig.el">ExpressionException</a>&gt;&nbsp;environment)</code></th>
<td class="colLast">
<div class="block">The environment passed from the client making the authorization request
 as a sets a map of keys to lists of values.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setJwtSubject(org.forgerock.openig.el.Expression)">setJwtSubject</a></span>&#8203;(<a href="../el/Expression.html" title="class in org.forgerock.openig.el">Expression</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;jwtSubject)</code></th>
<td class="colLast">
<div class="block">Sets the JWT string for the subject.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setSsoTokenSubject(org.forgerock.openig.el.Expression)">setSsoTokenSubject</a></span>&#8203;(<a href="../el/Expression.html" title="class in org.forgerock.openig.el">Expression</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;ssoTokenSubject)</code></th>
<td class="colLast">
<div class="block">Sets the SSO token for the subject.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(org.forgerock.json.resource.RequestHandler,org.forgerock.http.Handler)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PolicyEnforcementFilter</h4>
<pre>public&nbsp;PolicyEnforcementFilter&#8203;(org.forgerock.json.resource.RequestHandler&nbsp;requestHandler,
                               org.forgerock.http.Handler&nbsp;failureHandler)</pre>
<div class="block">Creates a new OpenAM enforcement filter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>requestHandler</code> - the CREST handler to use for asking the policy decisions.</dd>
<dd><code>failureHandler</code> - The handler which will be invoked when policy denies access.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="filter(org.forgerock.services.context.Context,org.forgerock.http.protocol.Request,org.forgerock.http.Handler)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>filter</h4>
<pre class="methodSignature">public&nbsp;org.forgerock.util.promise.Promise&lt;org.forgerock.http.protocol.Response,&#8203;org.forgerock.util.promise.NeverThrowsException&gt;&nbsp;filter&#8203;(org.forgerock.services.context.Context&nbsp;context,
                                                                                                                                             org.forgerock.http.protocol.Request&nbsp;request,
                                                                                                                                             org.forgerock.http.Handler&nbsp;next)</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>filter</code>&nbsp;in interface&nbsp;<code>org.forgerock.http.Filter</code></dd>
</dl>
</li>
</ul>
<a id="setApplication(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setApplication</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setApplication&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;application)</pre>
<div class="block">Sets the application where the policies are defined. If none, OpenAM will
 use the iPlanetAMWebAgentService.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>application</code> - The application where the policies are defined. If none,
            OpenAM will use the iPlanetAMWebAgentService.</dd>
</dl>
</li>
</ul>
<a id="setClaimsSubject(org.forgerock.util.Function)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setClaimsSubject</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setClaimsSubject&#8203;(org.forgerock.util.Function&lt;<a href="../el/Bindings.html" title="class in org.forgerock.openig.el">Bindings</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;,&#8203;<a href="../el/ExpressionException.html" title="class in org.forgerock.openig.el">ExpressionException</a>&gt;&nbsp;claimsSubject)</pre>
<div class="block">Sets a function that returns a map of JWT claims to their values, for the
 subject.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>claimsSubject</code> - A function that returns a map of JWT claims for the subject.</dd>
</dl>
</li>
</ul>
<a id="setEnvironment(org.forgerock.util.Function)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setEnvironment</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setEnvironment&#8203;(org.forgerock.util.Function&lt;<a href="../el/Bindings.html" title="class in org.forgerock.openig.el">Bindings</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>,&#8203;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&gt;&gt;,&#8203;<a href="../el/ExpressionException.html" title="class in org.forgerock.openig.el">ExpressionException</a>&gt;&nbsp;environment)</pre>
<div class="block">The environment passed from the client making the authorization request
 as a sets a map of keys to lists of values.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>environment</code> - A function that returns a map of keys to lists of values.</dd>
</dl>
</li>
</ul>
<a id="setSsoTokenSubject(org.forgerock.openig.el.Expression)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSsoTokenSubject</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setSsoTokenSubject&#8203;(<a href="../el/Expression.html" title="class in org.forgerock.openig.el">Expression</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;ssoTokenSubject)</pre>
<div class="block">Sets the SSO token for the subject.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ssoTokenSubject</code> - The SSO Token for the subject.</dd>
</dl>
</li>
</ul>
<a id="setJwtSubject(org.forgerock.openig.el.Expression)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setJwtSubject</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setJwtSubject&#8203;(<a href="../el/Expression.html" title="class in org.forgerock.openig.el">Expression</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;jwtSubject)</pre>
<div class="block">Sets the JWT string for the subject.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jwtSubject</code> - The JWT string for the subject.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PolicyEnforcementFilter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2026 <a href="https://github.com/OpenIdentityPlatform">Open Identity Platform Community</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
