<!DOCTYPE HTML>
<!-- NewPage -->
<html lang>
<head>
<!-- Generated by javadoc -->
<title>PasswordReplayFilterHeaplet (OpenIG Project 6.0.0-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PasswordReplayFilterHeaplet (OpenIG Project 6.0.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PasswordReplayFilterHeaplet.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.forgerock.openig.filter</a></div>
<h2 title="Class PasswordReplayFilterHeaplet" class="title">Class PasswordReplayFilterHeaplet</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../heap/GenericHeaplet.html" title="class in org.forgerock.openig.heap">org.forgerock.openig.heap.GenericHeaplet</a></li>
<li>
<ul class="inheritance">
<li>org.forgerock.openig.filter.PasswordReplayFilterHeaplet</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../heap/Heaplet.html" title="interface in org.forgerock.openig.heap">Heaplet</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">PasswordReplayFilterHeaplet</span>
extends <a href="../heap/GenericHeaplet.html" title="class in org.forgerock.openig.heap">GenericHeaplet</a></pre>
<div class="block">Supports password replay feature in a composite filter.
 Two use cases are supported:
 <ul>
     <li>Replaying credentials when a login page is <em>queried</em> (on the request flow)</li>
     <li>Replaying credentials when a login page is <em>returned</em> (on the response flow)</li>
 </ul>

 <p>A variation on the first case is possible: it can let the request flow and extract values from the server's
 response.

 <p>This filter supports value extraction for any server-provided values that would be re-used in the
 authentication request.

 <p>Credentials must be installed by a filter that will only be placed in a chain when needed (in case they're not
 already there). If required (and if the credentials are available as request headers), we can decrypt them using a
 <a href="CryptoHeaderFilter.html" title="class in org.forgerock.openig.filter"><code>CryptoHeaderFilter</code></a>.

 <p>Then an authentication request is built (using a <a href="StaticRequestFilter.html" title="class in org.forgerock.openig.filter"><code>StaticRequestFilter</code></a>) and sent down the chain.

 Note that:
 <ul>
     <li>There is no retry in case of authentication failure</li>
     <li>Extracted patterns need to have at least a single regex group, the first one is always used</li>
 </ul>

 <h3>Usage examples:</h3>

 <h4>Authenticate on behalf of the user when a login page is GET</h4>

 <p>When a GET request to the login page is intercepted, OpenIG will generate an alternative
 authentication request and send it in place of the original request. The response is forwarded as-is to the caller.
 All other requests are forwarded untouched.

 <pre>
     <code>{
         "loginPage": "${matches(request.uri.path, '/login') and (request.method == 'GET')}",
         "request": {
           "method": "POST",
           "uri": "http://internal.example.com/login",
           "form": {
             "username": [ "${attributes.username}" ],
             "password": [ "${attributes.password}" ]
           }
         }
       }
     </code>
 </pre>

 <h4>Authenticate on behalf of the user when a login page is returned</h4>

 <p>When a response that is identified to be a login page is intercepted, OpenIG will generate an authentication
 request and send it. The authentication response is ignored ATM. Then OpenIG replays the original incoming request.

 <pre>
     <code>{
         "loginPageContentMarker": "I'm a login page",
         "request": {
           "method": "POST",
           "uri": "http://internal.example.com/login",
           "headers": {
             "X-OpenAM-Username": [ "${attributes.username}" ],
             "X-OpenAM-Password": [ "${attributes.password}" ]
           }
         }
       }
     </code>
 </pre>

 <h2>Options</h2>

 <h3>Obtain credentials</h3>

 The PasswordReplay Filter can be configured (with the <code>credentials</code> attribute) to invoke an additional
 Filter that would be responsible to obtain credentials and make them available in the request processing data
 structures. These values can then be used to create an appropriate authentication request.

 <p>The <code>credentials</code> attribute expects a reference to a <code>Filter</code> heap object.

 <p>Examples of such filters can be <a href="FileAttributesFilter.html" title="class in org.forgerock.openig.filter"><code>FileAttributesFilter</code></a> (to load credentials from a local CSV file)
 or <a href="SqlAttributesFilter.html" title="class in org.forgerock.openig.filter"><code>SqlAttributesFilter</code></a> (to load credentials from a database).

 <pre>
     <code>{
         "loginPageContentMarker": "I'm a login page",
         "credentials": {
             "type": "FileAttributesFilter",
             "config": {
                 "file": "${system.home}/users.csv",
                 "key": "uid",
                 "value": "${attributes.whoami}",
                 "target": "${attributes.user}"
             }
         }
         "request": {
           "method": "POST",
           "uri": "http://internal.example.com/login",
           "headers": {
             "X-OpenAM-Username": [ "${attributes.user.uid}" ],
             "X-OpenAM-Password": [ "${attributes.user.password}" ]
           }
         }
       }
     </code>
 </pre>

 <h3>Extract custom values from intercepted response page</h3>

 It may happen that the login page contains a form with hidden fields that will be send back to the IDP when submit
 button will be hit.
 As this filter doesn't interpret the returned page content and generate a new authentication request, it needs a
 way to extract some values from the response's entity.

 <p>Multiple values can be extracted at once, extraction is based on pattern matching (and use a
 <a href="EntityExtractFilter.html" title="class in org.forgerock.openig.filter"><code>EntityExtractFilter</code></a> under the hood).
 As opposed to the EntityExtractFilter, only 1 group is supported, and matched group value is placed in
 the results. All extracted values will be placed in a Map available in
 attributes.extracted.

 <pre>
     <code>{
         "loginPageContentMarker": "I'm a login page",
         "loginPageExtractions": [
             {
                 "name": "nonce",
                 "pattern": " nonce='(.*)'"
             }
         ],
         "request": {
           "method": "POST",
           "uri": "http://internal.example.com/login",
           "form": {
             "username": [ "${attributes.username}" ],
             "password": [ "${attributes.password}" ]
             "nonce": [ "${attributes.extracted.nonce}" ]
           }
         }
       }
     </code>
 </pre>

 <h3>Decrypt values provided as request headers</h3>

 When using an OpenAM policy agent in front of OpenIG, the agent configured to retrieve username and password, the
 request will contains encrypted headers.
 For replaying them, this filter needs to decrypt theses values before creating the authentication request.

 <p>This filter use a <a href="CryptoHeaderFilter.html" title="class in org.forgerock.openig.filter"><code>CryptoHeaderFilter</code></a> to do the decryption of values. Note that it only decrypts and
 always acts on the request flow. All other attributes are the same as those used for configuring a normal
 <a href="CryptoHeaderFilter.html" title="class in org.forgerock.openig.filter"><code>CryptoHeaderFilter</code></a>.

 <p>Note that this is only one example usage, as soon as there are encrypted values in headers, this function is
 here to decrypt them in place if needed.

 <pre>
     <code>{
         "loginPageContentMarker": "I'm a login page",
         "headerDecryption": {
             "algorithm": "DES/ECB/NoPadding",
             "key": "....",
             "keyType": "DES",
             "headers": [ "X-OpenAM-Password" ]
         },
         "request": {
           "method": "POST",
           "uri": "http://internal.example.com/login",
           "form": {
             "username": [ "${request.headers['X-OpenAM-Username'][0]}" ],
             "password": [ "${request.headers['X-OpenAM-Password'][0]}" ]
           }
         }
       }
     </code>
 </pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.org.forgerock.openig.heap.GenericHeaplet">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;org.forgerock.openig.heap.<a href="../heap/GenericHeaplet.html" title="class in org.forgerock.openig.heap">GenericHeaplet</a></h3>
<code><a href="../heap/GenericHeaplet.html#config">config</a>, <a href="../heap/GenericHeaplet.html#heap">heap</a>, <a href="../heap/GenericHeaplet.html#name">name</a>, <a href="../heap/GenericHeaplet.html#object">object</a>, <a href="../heap/GenericHeaplet.html#qualified">qualified</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">PasswordReplayFilterHeaplet</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#create()">create</a></span>()</code></th>
<td class="colLast">
<div class="block">Called to request the heaplet create an object.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.org.forgerock.openig.heap.GenericHeaplet">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.forgerock.openig.heap.<a href="../heap/GenericHeaplet.html" title="class in org.forgerock.openig.heap">GenericHeaplet</a></h3>
<code><a href="../heap/GenericHeaplet.html#create(org.forgerock.openig.heap.Name,org.forgerock.json.JsonValue,org.forgerock.openig.heap.Heap)">create</a>, <a href="../heap/GenericHeaplet.html#destroy()">destroy</a>, <a href="../heap/GenericHeaplet.html#endpointRegistry()">endpointRegistry</a>, <a href="../heap/GenericHeaplet.html#evaluatedWithHeapProperties()">evaluatedWithHeapProperties</a>, <a href="../heap/GenericHeaplet.html#expression(java.lang.Class)">expression</a>, <a href="../heap/GenericHeaplet.html#start()">start</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PasswordReplayFilterHeaplet</h4>
<pre>public&nbsp;PasswordReplayFilterHeaplet()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="create()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>create</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;create()
              throws <a href="../heap/HeapException.html" title="class in org.forgerock.openig.heap">HeapException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../heap/GenericHeaplet.html#create()">GenericHeaplet</a></code></span></div>
<div class="block">Called to request the heaplet create an object. Called by
 <a href="../heap/Heaplet.html#create(org.forgerock.openig.heap.Name,org.forgerock.json.JsonValue,org.forgerock.openig.heap.Heap)"><code>Heaplet.create(Name, JsonValue, Heap)</code></a> after initializing
 the protected field members. Implementations should parse configuration
 but not acquire resources, start threads, or log any initialization
 messages. These tasks should be performed by the <a href="../heap/GenericHeaplet.html#start()"><code>GenericHeaplet.start()</code></a> method.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../heap/GenericHeaplet.html#create()">create</a></code>&nbsp;in class&nbsp;<code><a href="../heap/GenericHeaplet.html" title="class in org.forgerock.openig.heap">GenericHeaplet</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The created object.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../heap/HeapException.html" title="class in org.forgerock.openig.heap">HeapException</a></code> - if an exception occurred during creation of the heap object
             or any of its dependencies.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PasswordReplayFilterHeaplet.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2025 <a href="https://github.com/OpenIdentityPlatform">Open Identity Platform Community</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
