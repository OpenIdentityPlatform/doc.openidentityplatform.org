<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <style type="text/css">
   /*
* The contents of this file are subject to the terms of the Common Development and
* Distribution License (the License). You may not use this file except in compliance with the
* License.
*
* You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the
* specific language governing permission and limitations under the License.
*
* When distributing Covered Software, include this CDDL Header Notice in each file and include
* the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL
* Header, with the fields enclosed by brackets [] replaced by your own identifying
* information: "Portions copyright [year] [name of copyright owner]".
*
* Copyright 2015 ForgeRock AS.
* Portions copyright 2024 3A Systems LLC.
*/

/***********************************/
/* Imported Styles
/***********************************/

@import url(https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,300,400,700);
@import url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css);
@import url(https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css);
/* @import url(https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css); */
@import url(https://cdnjs.cloudflare.com/ajax/libs/jquery.colorbox/1.4.33/example1/colorbox.css);

/***********************************/
/* General Styles
/***********************************/

html {
    height: 100%;
}

body {
    /* Dark Grey */

    color: #2a2f32;
    font-family: 'Open Sans', "proxima-nova", sans-serif;
}

a {
    color: #1e20b4;
}

a:hover, a:focus {
    color: #1e20b4;
}

a.link[href^="http"] {
    background-image: url("includes/logos/Icon_External_Link.png");
    background-position: top right;
    background-repeat: no-repeat;
    padding-right: 15px;
    margin-right: 2px;
}

a.self-link, a.self-link:hover, a.self-link:active {
    color: inherit;
    text-decoration: none;
}

a[href].self-link:hover::after
{
    -moz-osx-font-smoothing: grayscale;
    content: "\e144";
    color: #1e20b4;
    display: inline-block;
    font-family: "Glyphicons Halflings";
    font-size: 75%;
    font-style: normal;
    line-height: 1;
    padding-left: 5px;
    position: relative;
    top: 1px;
}


li.L0,
li.L1,
li.L2,
li.L3,
li.L5,
li.L6,
li.L7,
li.L8 {
    list-style-type: decimal !important
}

.section,
.chapter,
.preface,
.glossary,
.refentry,
.reference,
.appendix,
.index,
.titlepage h2,
.titlepage h3,
.titlepage h4,
.titlepage h5 {
    padding-top: 60px;
    margin-top: -50px;
}

.left-shape-content {
    background: no-repeat scroll 0 0 rgba(0, 0, 0, 0);
    float: left;
    height: 566px;
    position: fixed;
    width: 57px;
    top: 60%;
    z-index: -1;
}

/***********************************/
/* Bootstrap Override Styles
/***********************************/

/* Button Styles */

.btn-primary {
    /* Sea Green */
    background-color: #519387;

    /* Dark Sea Green */
    border-color: #488378;
    color: #fff;
}

.btn-default {
    background-color: #A1A8AD;
    border-color: #8a9298;
    color: #ffffff;
}

.btn-default:hover,
.btn-default:focus,
.btn-default.focus,
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
    background-color: #3f4b54;
    border-color: #1B2025;
    color: #ffffff;
}

/* Tooltip Styles */

.tooltip.in {
    opacity: 0.95;
}

.tooltip.bottom .tooltip-arrow {
    border-bottom-color: #27297e;
}

.tooltip-inner {
    background-color: #27297e;
}

/* List Styles */

.dl-horizontal dt {
    white-space: normal;
    padding: 0 3px 0 0;
    width: 200px;
}

.dl-horizontal dd {
    border-bottom: 1px dotted rgb(125, 179, 168);
    border-bottom: 1px dotted rgba(125, 179, 168, 0.8);
    margin-bottom: 18px;
    margin-left: 210px;
}

.dl-horizontal {
    border-top: 1px dotted rgb(125, 179, 168);
    border-top: 1px dotted rgba(125, 179, 168, 0.9);
    padding-top: 10px;
}

.variablelist dt {
    margin: 18px 0 5px 15px;
}

.variablelist dd {
    border-bottom: 1px dotted rgba(125, 179, 168, 0.8);
    margin: 5px 0 5px 30px;
}

.variablelist > dl {
    border-top: 1px dotted rgba(125, 179, 168, 0.8);
}


/***********************************/
/* Redirect Page Styles
/***********************************/

.index-redirect,
.index-redirect body {
    height: 100%;
    background-color: #333;
    font-family: 'Open Sans', "proxima-nova", sans-serif;
}
.index-redirect body {
    color: #fff;
    text-align: center;
}
.index-redirect .container {
    display: table;
    vertical-align: middle;
    height: 100%;
}
.index-redirect .btn-primary {
    /* Sea Green */
    background-color: #519387;

    /* Dark Sea Green */
    border-color: #488378;
    color: #fff;
}
.index-redirect .cover-heading {
    font-weight: 400 !important;
}
.index-redirect .vertical-center-row {
    display: table-cell;
    vertical-align: middle;
}

/***********************************/
/* Header Styles
/***********************************/

.navbar-brand {
    padding: 7px 15px;
    display: flex;
    align-items: center;
}
.navbar-brand > img {
    height: 100%;
}

.navbar.navbar-inverse.navbar-fixed-top {
    box-shadow: 0 0 10px 2px #111;
}
.nav > li > a {
    font-weight: 200;
}

/***********************************/
/* Banner Styles
/***********************************/

.jumbotron {
    /* Sea Green */
    background: no-repeat scroll left top #00013c;
    color: white;
    box-shadow: 0 0 10px 2px grey;
    margin-top: 50px;
    padding: 0 0 10px;
}
.jumbotron small {
    color: white;
}
.jumbotron p {
    font-size: 12px;
    font-weight: 400;
    margin-bottom: 5px;
}
.jumbotron h1 {
    font-size: 23px !important;
    font-weight: 300 !important;
}

/***********************************/
/* Table of Contents Styles
/***********************************/

#sidebar .nav>li>a {
    /* Light Grey */

    color: #777;
    border-left: 4px solid transparent;
    padding: 4px 10px;
    font-size: 13px;
    font-weight: 400;
}
/* nested links */

#sidebar .nav .nav>li>a {
    padding-top: 2px;
    padding-bottom: 2px;
    padding-left: 30px;
    font-size: 12px;
}
/* nested nested links */

#sidebar .nav .nav .nav>li>a {
    font-size: 11px;
    padding-bottom: 2px;
    padding-left: 50px;
    padding-top: 4px;
}
/* nested nested nested links */

#sidebar .nav .nav .nav .nav>li>a {
    font-size: 11px;
    padding-bottom: 2px;
    padding-left: 70px;
    padding-top: 4px;
}
/* active and hover links */

#sidebar .nav>.active>a,
#sidebar .nav>.locked-active>a,
#sidebar .nav>li>a:hover,
#sidebar .nav>li>a:focus {
    text-decoration: none;
    /*
    background-color: rgb(125, 179, 168, 0.8);
    background-color: rgba(125, 179, 168, 0.8);
    border-color: rgb(45, 52, 55, 0.8);
    border-color: rgba(45, 52, 55, 0.8);
    color: white;
    */
    /* Bright Yellow */

    background-color: #e2e2fe;
    border-color: #e2e2fe;
    /* Grey */

    color: #2a2f32;
}
/* all active links */

#sidebar .nav>.active>a,
#sidebar .nav>.active:hover>a,
#sidebar .nav>.active:focus>a {
    font-weight: 600;
}
/* nested active links */

#sidebar .nav .nav>.active>a,
#sidebar .nav .nav>.active:hover>a,
#sidebar .nav .nav>.active:focus>a {
    font-weight: 400;
}
/* nested nested active links */

#sidebar .nav .nav .nav>.active>a,
#sidebar .nav .nav .nav>.active:hover>a,
#sidebar .nav .nav .nav>.active:focus>a {
    font-weight: 300;
}
/* nested nested active links */

#sidebar .nav .nav .nav>.active>a,
#sidebar .nav .nav .nav>.active:hover>a,
#sidebar .nav .nav .nav>.active:focus>a {
    font-weight: 300;
}
/* hide all (inactive) nested list */

#sidebar .nav ul.nav {
    display: none;
}
/* show active nested list */

#sidebar .nav>.active>ul.nav {
    display: block;
}
#sidebar.affix {
    top: 66px;
    position: fixed;
    bottom: 30px;
    height: auto;
    overflow-y: scroll;
}
#sidebar.affix-bottom {
    position: absolute;
}

/***********************************/
/* Content Styles
/***********************************/

/* Main Content Styles */

h1 {
    font-size: 40px !important;
    font-weight: 700 !important;
}

h1 span {
    margin-right: .3em;
}

#doc-content h1,
#doc-content .h1 {
    /* Sea Green */
    border-bottom: 2px solid #27297e;
    font-size: 36px;
    margin-top: 24px;
    padding-bottom: 5px;
}

h2 {
    font-size: 32px !important;
    font-weight: 700 !important;
}

h5, .h5 {
    border-bottom: 1px solid #d3d3d3;
    font-size: 16px;
    padding-bottom: 4px;
    font-style: italic;
}

.anchorjs-link .anchorjs-icon {
    color: #A1A8AD;
    text-decoration: none;
}
.anchorjs-link:hover .anchorjs-icon {
    color: #519387;
    text-decoration: none;
}

h1:hover > .anchorjs-link,
h2:hover > .anchorjs-link,
h3:hover > .anchorjs-link,
h4:hover > .anchorjs-link,
h5:hover > .anchorjs-link,
.anchorjs-link:focus {
    opacity: 1 !important;
    transition: color 0.16s linear 0s;
    text-decoration: none;
}

.chapter > p:first-of-type,
.preface > p:first-of-type {
    font-size: 21px;
    font-weight: 300;
    line-height: 1.4;
    margin-bottom: 20px;
}

#doc-content {
    padding: 0 20px 85px 10px;
}

div.procedure, div.table {
    margin-top:-50px;
    padding-top: 60px;
}

div.procedure-title, div.table-title {
    margin: 6px 0 8px;
}

div.procedure-inner {
    border-color: lightslategray;
    border-left: 6px solid lightslategray;
    border-style: dotted dotted dotted solid;
    border-width: 1px 1px 1px 6px;
    margin: 15px 0 10px;
    padding: 10px 15px 10px 10px;
}

.author {
    display: inline;
}

.table {
    font-size: 14px;
}

div.simplelist {
    margin-bottom: 10px;
    width: 100%;
    font-size: 15px;
}

/* Title Styles */

.procedure-title > a, .procedure-title > a:hover {
    color: lightslategray;
    font-size: 14pt;
    font-weight: 400;
}

.itemizedlist-title {
    font-size: 18px;
    font-weight: 600;
    margin: 12px 0 6px;
}

.figure-title {
    font-weight: bold;
    margin: 16px 0 4px;
    text-align: center;
}

.table-title {
    font-size: 12pt;
    font-weight: 700;
}

.variablelist-title {
    font-weight: bold;
    margin: 10px 0;
    text-decoration: underline;
}

/* Code Styles */

.btn-copy-cmdline,
.btn-copy-codelisting {
    /* White */

    background-color: #fff;
    /* Light Grey */

    border: 1px solid #e1e1e8;
    border-radius: 0 4px;
    color: #777;
    display: block;
    font-size: 12px;
    padding: 5px 8px;
    position: absolute;
    right: 5px;
    top: 5px;
    z-index: 10;
}

pre.prettyprint {
    border: 1px solid #ccc;
    padding: 9.5px;
    font-size: 12px;
}

.zero-clipboard {
    display: block;
    position: relative;
}
.zeroclipboard-is-hover {
    /* Light Sea Green */

    background-color: #6faa9b;
    border-color: #6faa9b;
    color: #fff;
    cursor: pointer;
}

.ui-effects-transfer {
    border: 1px dotted black;
    background-color: yellow;
    opacity: 0.4;
}

/* Modal Dialog Styles */

#doc-content .modal h1.title {
    font-size: 40px !important;
    font-weight: 500 !important;
    margin: 14px 0 5px;
}
#doc-content .modal h2.subtitle {
    font-size: 26px !important;
    font-weight: 400 !important;
    margin-bottom: 26px;
}
#doc-content .modal h3.author {
    font-size: 14px !important;
    font-style: italic;
    font-weight: 100 !important;
    margin: 4px 0 5px 18px;
}
#doc-content .modal .affiliation .orgname {
    display: block;
    font-size: 20px !important;
    font-weight: 400 !important;
    margin: 20px 0 0 0;
}
#doc-content .modal .affiliation .address p {
    font-size: 16px !important;
    font-weight: 100 !important;
    margin: 4px 0;
}
#doc-content .modal .copyright {
    display: none;
}
#doc-content .modal .copyright {
    display: none;
}
#doc-content .modal .abstract .abstract-title {
    font-size: 20px !important;
    font-weight: 400 !important;
}
#doc-content .modal .abstract > p {
    margin: 10px 0 5px 20px;
    font-size: 16px !important;
    font-weight: 100 !important;
}

/* Image Styles */

.fancybox > img {
    cursor: zoom-in;
}
a.fancybox {
    text-decoration: none;
}

#cboxTitle {
    color: #519387;
    font-size: 14px;
    font-weight: 700;
}

#cboxOverlay{
    background: none repeat scroll 0 0 rgba(66, 130, 116, 0.6);
}

img.img-responsive {
    margin-bottom: 20px;
}

/* Index Styles */

.indexdiv > h3 {
    border-bottom: 2px dotted lightgrey;
    padding-bottom: 5px;
}
.indexdiv > dl {
    margin-left: 30px;
}
.indexdiv dl {
    margin-bottom: 5px;
}
.indexdiv dt {
    margin: 5px 0 2px;
}
.indexdiv dd {
    margin-left: 35px;
}
.indexdiv .indexterm {
    font-weight: 200;
}

/* Reference Styles */

.refnamediv h2 {
    display: none;
}

.refsect1 h2,
.refsynopsisdiv h2 {
    font-size: 20px !important;
    font-weight: 400 !important;
}

.refnamediv p {
    font-size: 32px !important;
    font-weight: 700 !important;
}

/***********************************/
/* Footer Styles
/***********************************/

.back-to-top {
    position: fixed;
    bottom: 55px;
    right: 5px;
    display: none;
    z-index: 15;
}

#footer {
    display: none;
}

.footer {
    /* Light Grey */
    background-color: #f5f5f5;

    /* Medium Grey */
    border-top: 1px solid #ACB5BD;
    bottom: 0;
    font-size: 12px;
    height: 30px;
    padding-top: 4px;
    position: fixed;
    width: 100%;
    z-index: 100;
}

.footer h3 {
    margin: 0;
}

.footer a:hover {
    text-decoration: none;
}

.footer-item {
    line-height: 22px;
    margin-left: 10px;
}

.footer-item.highlighted {
    /* Orange */
    color: #f7a540;
}

.footer-item.highlighted:hover {
    /* Dark Orange */
    color: #c97208;
}

.footer span {
    /* Grey */
    color: #2a2f32;
    margin-bottom: 0;
}

.footer .footer-left {
    float: left;
}

.footer .footer-right {
    float: right;
}

/***********************************/
  </style><meta name="viewport" content="width=device-width, initial-scale=1"><title>OpenIDM 6.2.1-SNAPSHOT Developer's Guide</title><script src="https://code.jquery.com/jquery-1.11.2.min.js" type="text/javascript"></script><script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><script type="text/javascript">
     /*
 * The contents of this file are subject to the terms of the Common Development and
 * Distribution License (the License). You may not use this file except in compliance with the
 * License.
 *
 * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the
 * specific language governing permission and limitations under the License.
 *
 * When distributing Covered Software, include this CDDL Header Notice in each file and include
 * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL
 * Header, with the fields enclosed by brackets [] replaced by your own identifying
 * information: "Portions copyright [year] [name of copyright owner]".
 *
 * Copyright 2015 ForgeRock AS.
 */

//

var loadJavaScriptsFN = function () {
    $.ajaxSetup({ cache: true });
    $.getScript("http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js", function () { prettyPrint() });
    $.getScript("http://cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.2.0/ZeroClipboard.min.js", function () {enableZeroClipboardFN() });
    $.getScript("http://cdnjs.cloudflare.com/ajax/libs/jquery.colorbox/1.4.33/jquery.colorbox-min.js", function () { enableColorboxFN() });
};

var wrapConfigurablesFn = function () {
    $('*:contains("https://openam.example.com:8443")').each(function(){
        if($(this).children().length < 1)
            $(this).html(
                $(this).text().replace(new RegExp("https://openam.example.com:8443", 'g'),'<span class="exampleUrl">https://openam.example.com:8443</span>')
            )
    });
    $('*:contains("amadmin")').each(function(){
        if($(this).children().length < 1)
            $(this).html(
                $(this).text().replace(new RegExp("amadmin", 'g'),'<span class="exampleAdmin">amadmin</span>')
            )
    });
    $('*:contains("iPlanetDirectoryPro")').each(function(){
        if($(this).children().length < 1)
            $(this).html(
                $(this).text().replace(new RegExp("iPlanetDirectoryPro", 'g'),'<span class="exampleSsoCookieName">iPlanetDirectoryPro</span>')
            )
    });
};

var btnClickHandler = function () {
    $("button#applyDocUpdate").click(function(){

        $('span.exampleUrl').fadeOut("slow", function(){
            $('span.exampleUrl').text($("input#exampleUrl").val());
            $('span.exampleUrl').fadeIn("slow");
        });

        $('span.exampleAdmin').fadeOut("slow", function(){
            $('span.exampleAdmin').text($("input#exampleAdmin").val());
            $('span.exampleAdmin').fadeIn("slow");
        });

        $('span.exampleSsoCookieName').fadeOut("slow", function(){
            $('span.exampleSsoCookieName').text($("input#exampleSsoCookieName").val());
            $('span.exampleSsoCookieName').fadeIn("slow");
        });

        $('#docConfig').modal('hide');
    });
};


var addCopyButtonFN = function () {
    $( ".cmdline" ).each(function() {
        $(this).before('<div class="zero-clipboard hidden-xs"><span class="btn-copy-cmdline"><span class="glyphicon glyphicon-pencil"></span> Copy<span class="hidden-sm"> command to clipboard</span></span></div>');
    });

    $( ".codelisting" ).each(function() {
        $(this).before('<div class="zero-clipboard hidden-xs"><span class="btn-copy-codelisting"><span class="glyphicon glyphicon-pencil"></span> Copy<span class="hidden-sm"> code to clipboard</span></span></div>');
    });
};
var enableScrollSpyFN = function () {
    $('body').scrollspy({
        target: '#sidebar',
        offset: 16
    });
};

var enableToolTipFN = function () {
    $(function () {
        $("[data-toggle='tooltip']").tooltip({placement: 'bottom'});
    });
};

var enableBackToTopFadeInFN = function () {
    var offset = 220;
    var duration = 500;
    $(window).scroll(function() {
        if ($(this).scrollTop() > offset) {
            $('.back-to-top').fadeIn(duration);
        } else {
            $('.back-to-top').fadeOut(duration);
        }
    });

    $('.back-to-top').click(function(event) {
        event.preventDefault();
        $('html, body').animate({scrollTop: 0}, duration);
        return false;
    })
};

var enableClampedWidthsFN = function () {

    /*
     * Clamped-width.
     * Usage:
     *  <div data-clampedwidth=".myParent">This long content will force clamped width</div>
     *
     * Author: LV
     */
    $('[data-clampedwidth]').each(function () {
        var elem = $(this);
        var parentPanel = elem.data('clampedwidth');
        var resizeFn = function () {
            var sideBarNavWidth = $(parentPanel).width() - parseInt(elem.css('paddingLeft')) - parseInt(elem.css('paddingRight')) - parseInt(elem.css('marginLeft')) - parseInt(elem.css('marginRight')) - parseInt(elem.css('borderLeftWidth')) - parseInt(elem.css('borderRightWidth'));
            elem.css('width', sideBarNavWidth);
        };

        resizeFn();
        $(window).resize(resizeFn);
    });
};

var affixToCFN = function() {
    $('#sidebar').affix({
        offset: {
            top: function () {
                return (this.top = $('.jumbotron').outerHeight(true)-66)
            }
        }
    });
};

var attachAnchorsToHeadings = function() {
    //addAnchors('h1.title, h2.title, h3.title, h4.title, h5.title');


    $('h1.title, h2.title, h3.title, h4.title, h5.title, .procedure-title, .table-title').each(function () {

        var href = $(this).closest("div[id]").attr("id");

        if (href === undefined || href === "") { // Unable to locate ID of parent element.
            return;
        }

        $(this).wrapInner('<a class=\"self-link" href=\"#' + href + '\"></a>');

    });
};

var addZeroClipboardToCmdlineButtonsFN = function () {
    var copycmdline = new ZeroClipboard( $('.btn-copy-cmdline') );

    copycmdline.on( 'ready', function(event) {
        // console.log( 'movie is loaded' );

        copycmdline.on( 'copy', function(event) {
            var wrappedText = "";
            $(event.target).parent().next().find("strong").each(function(index) {
                wrappedText += $(this).text() + "\n";
            });
            event.clipboardData.setData('text/plain', wrappedText);
        });

        copycmdline.on( 'aftercopy', function(event) {
            // console.log('Copied to clipboard: ' + event.data['text/plain']);
            $(event.target).parent().next().find("strong").each(function(index) {
                $(this).effect("transfer", { to: $(event.target)}, 750);
            });
        });
    });

    copycmdline.on( 'error', function(event) {
        console.log( 'ZeroClipboard error of type "' + event.name + '": ' + event.message );
        ZeroClipboard.destroy();
    });
};

var addZeroClipboardToCodeButtonsFN = function () {
    var copycodelisting = new ZeroClipboard( $('.btn-copy-codelisting') );

    copycodelisting.on( 'ready', function(event) {
        //console.log( 'movie is loaded' );

        copycodelisting.on( 'copy', function(event) {
            var wrappedText = "";
            $(event.target).parent().next(".codelisting.linenums").children().contents().each(function(index) {
                wrappedText += $(this).text() + "\n";
            });
            if(wrappedText == "") {
                wrappedText = $(event.target).parent().next(".codelisting").contents().text();
            };
            event.clipboardData.setData('text/plain', wrappedText);
        });

        copycodelisting.on( 'aftercopy', function(event) {
            // console.log('Copied code to clipboard: ' + event.data['text/plain']);
            $(event.target).parent().next(".codelisting").first().effect("transfer", { to: $(event.target)}, 750);
        });
    });

    copycodelisting.on( 'error', function(event) {
        console.log( 'ZeroClipboard error of type "' + event.name + '": ' + event.message );
        ZeroClipboard.destroy();
    });
};

var enableColorboxFN = function () {
    $(".fancybox").colorbox({
        title: function() {
            return $(this).children('img').attr('alt');
        },
        opacity: 1,
        transition:"elastic",
        initialWidth: 0,
        initialHeight: 0,
        maxWidth:"95%",
        maxHeight: "95%",
        scalePhotos: true,
        fixed: true
    });
};

var trackPageViewsFN = function () {

    $("a").click(function() {
        var href = $(this).attr('href');
        if(href) {
            var titleText =  $(this).text();
            if(href.charAt(0) === '#') {
                ga('send', {
                    'hitType': 'pageview',
                    'page': location.pathname + location.search + href,
                    'title': titleText
                });
            };
            if(href.charAt(0) === '.') {
                var lastHashPos = href.lastIndexOf('#');
                var cleanHref = href.slice(3,lastHashPos);
                var cleanFrag = href.slice(lastHashPos);
                if(window.location.href.search(cleanHref) > -1)
                {
                    ga('send', {
                        'hitType': 'pageview',
                        'page': location.pathname + location.search + cleanFrag,
                        'title': titleText
                    });
                }
            };
        }
    });
};

var enableZeroClipboardFN = function () {
    ZeroClipboard.config({
            swfPath:  "includes/swf/ZeroClipboard.swf",
            trustedDomains: ["*"],
            forceEnhancedClipboard: false,
            forceHandCursor: true,
            debug: false}
    );
    addCopyButtonFN();
    addZeroClipboardToCmdlineButtonsFN();
    addZeroClipboardToCodeButtonsFN();
};

$(document).ready(function() {
    //wrapConfigurablesFn();
    btnClickHandler();
    enableToolTipFN();
    enableBackToTopFadeInFN();
    enableClampedWidthsFN();
    enableScrollSpyFN();
    affixToCFN();
    attachAnchorsToHeadings();
    trackPageViewsFN();
    loadJavaScriptsFN();
});

//

    </script></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navbar navbar-inverse navbar-fixed-top"><nav class="container-fluid"><div class="navbar-header"><a href="/" class="navbar-brand"><span>Open Identity Platform</span></a></div><ul id="pdf-link" class="nav navbar-nav navbar-right hidden-xs"><li><a href="https://github.com/OpenIdentityPlatform/OpenIDM/wiki/docbkx/pdf/OpenIDM-Dev-Guide.pdf" target="_blank"><span class="glyphicon glyphicon-save"></span> Download PDF Version</a></li></ul></nav></div><div class="jumbotron"><div class="container-fluid"><h1>OpenIDM 6.2.1-SNAPSHOT Developer's Guide<span></span><small></small></h1><p></p></div></div><div class="left-shape-content"></div><div class="container-fluid"><div class="row"><div class="col-sm-3 hidden-xs"><div id="sidebar" data-clampedwidth=".col-sm-3"><h4 class="toc-title">OpenIDM 6.2.1-SNAPSHOT Developer's Guide<br><small class="toc-subtitle"></small></h4><ul class="nav nav-stacked"><li><a href="#preface">Preface</a><ul class="nav nav-stacked"><li><a href="#d3595e124">1. Who Should Use this Guide</a></li><li><a href="#d3595e133">2. Using Samples</a></li><li><a href="#d3595e143">3. Formatting Conventions</a></li><li><a href="#d3595e177">4. Accessing OpenIDM Documentation Online</a></li><li><a href="#d3595e199">5. Joining the OpenIDM Community</a></li></ul></li><li><a href="#d3595e220">A. Overview</a><ul class="nav nav-stacked"><li><a href="#chap-api-overview">1. OpenIDM APIs and Protocols</a><ul class="nav nav-stacked"><li><a href="#d3595e230">1.1. Development</a><ul class="nav nav-stacked"><li><a href="#d3595e235">1.1.1. Dependencies</a></li><li><a href="#d3595e363">1.1.2. Guidelines</a></li></ul></li></ul></li><li><a href="#chap-distributed_task">2. Distributed Task</a><ul class="nav nav-stacked"><li><a href="#d3595e401">2.1. Approach Basics</a></li><li><a href="#d3595e408">2.2. High Availability / HA</a></li><li><a href="#d3595e418">2.3. Scaling</a></li><li><a href="#d3595e425">2.4. Task Handlers</a></li><li><a href="#d3595e432">2.5. Implementation Notes</a></li><li><a href="#d3595e439">2.6. Concurrency/Locking Notes</a></li><li><a href="#d3595e449">2.7. Disallowing Concurrent Execution and Serialized Executions in the Cluster</a></li><li><a href="#d3595e459">2.8. QoS / Transactionality</a></li><li><a href="#d3595e466">2.9. Sub-tasks and Grouping</a></li><li><a href="#d3595e506">2.10. Scheduling </a></li><li><a href="#d3595e536">2.11. API</a></li></ul></li><li><a href="#chap-object_model">3. Object model</a></li><li><a href="#chap-repository">4. Repository</a><ul class="nav nav-stacked"><li><a href="#d3595e564">4.1. Query</a></li></ul></li><li><a href="#chap-terminology">5. Terminology</a><ul class="nav nav-stacked"><li><a href="#d3595e780">5.1. Managed object</a></li><li><a href="#d3595e786">5.2. Mapping object</a></li><li><a href="#d3595e792">5.3. Object</a></li><li><a href="#d3595e798">5.4. Resource</a></li><li><a href="#d3595e804">5.5. Resource object</a></li><li><a href="#d3595e810">5.6. Schema object</a></li></ul></li><li><a href="#chap-best-practices">6. Best Practices For OpenIDM Integration</a></li></ul></li><li><a href="#d3595e822">Index</a></li></ul></div></div><div id="doc-content" class="col-sm-9"><div class="titlepage modal fade" id="myModal"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">X</span></button><h4 class="modal-title">About this document</h4></div><div class="modal-body"><div><div><h1 class="title">OpenIDM 6.2.1-SNAPSHOT Developer's Guide</h1></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Mark</span> <span class="surname">Craig</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Paul</span> <span class="surname">Bryan</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Andi</span> <span class="surname">Egloff</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Laszlo</span> <span class="surname">Hordos</span></h3></div></div></div><div><p class="releaseinfo"></p></div><div><p class="copyright">Copyright &copy; 2011 ForgeRock AS</p></div><div><a href="legalnotice.html">Legal Notice</a></div><div><p class="pubdate">Publication date: September&nbsp;09,&nbsp;2024</p></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div><div lang="en" class="preface" id="preface"><div class="titlepage"><div><div><h1 class="title">Preface</h1></div></div></div><p>This guide shows you how to work with OpenIDM APIs to integrate data
 stores and applications in your organization with OpenIDM services for
 identity management, provisioning, and compliance.</p><div class="section" id="d3595e124"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1.&nbsp;Who Should Use this Guide</h2></div></div></div><p>This guide is written for Java and web developers who build OpenIDM
  services into the workflows of their organizations.</p><p>This guide starts by explaining identity management with OpenIDM
  briefly, and describing best practices for integration OpenIDM services
  into your organization. Then it demonstrates how to connect your applications
  with OpenIDM services and to build workflows for identity management,
  provisioning, and compliance.</p><p>You do not need to be an OpenIDM wizard to learn something from this
  guide. You do need some background in writing Java and web applications to
  get the most out of this guide. You can nevertheless get started with this
  guide, and then learn more as you go along.</p></div><div class="section" id="d3595e133"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.&nbsp;Using Samples</h2></div></div></div><p>This work is licensed under the <a class="link" href="http://creativecommons.org/licenses/by-nc-nd/3.0/" target="_top">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported
  License</a>.</p><p>See the license for the specific language governing permissions
  and limitations under the license.</p></div><div class="section" id="d3595e143"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3.&nbsp;Formatting Conventions</h2></div></div></div><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>Pay attention to notes like this one.</p></div></div><p>Some items might be formatted differently from other text, like
  <code class="filename">filenames</code>, <span class="command"><strong>commands</strong></span>, and
  <code class="literal">literal values</code>.</p><pre class="cmdline prettyprint">$ echo Terminal sessions are formatted like this.
Terminal sessions are formatted like this.</pre><pre class="codelisting prettyprint">class Test
{
    public static void main(String [] args)
    {
        System.out.println("This is a program listing.");

    }
}</pre><p>In many cases, sections pertaining to UNIX, GNU/Linux, Mac OS X, BSD,
  and so forth are marked (UNIX). Sections pertaining to Microsoft Windows
  might be marked (Windows). To avoid repetition, however, file system
  directory names are often given only in UNIX format as in
  <code class="filename">/path/to/OpenIDM</code>, even if the text applies to
  <code class="filename">C:\path\to\OpenIDM</code> as well.</p><div class="panel panel-warning"><div class="panel-heading"><h3 class="panel-title">Warning</h3></div><div class="panel-body"><p>Ignore warnings at your own risk.</p></div></div></div><div class="section" id="d3595e177"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.&nbsp;Accessing OpenIDM Documentation Online</h2></div></div></div><p>Core documentation, such as what you are now reading, aims to
  be technically accurate and complete with respect to the software
  documented. Core documentation therefore follows a <a class="link" href="https://wikis.forgerock.org/confluence/display/devcom/Review+Process" target="_top">three-phase review process</a> designed to eliminate errors. The
  review process should slow authors down enough that documentation you get
  with a stable release has had time to bake fully.</p><p>Fully baked core documentation is available at <a class="link" href="http://..." target="_top">...</a>.</p><p>The <a class="link" href="https://wikis.forgerock.org/confluence/display/OPENIDM/Home" target="_blank">OpenIDM Wiki</a> regularly brings you more, fresh
  content. In addition, you are welcome to <a class="link" href="https://idp.forgerock.org/openam/UI/Login?service=register" target="_blank">sign
  up</a> and then edit the Wiki if you notice an error, or if you have
  something to share.</p></div><div class="section" id="d3595e199"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.&nbsp;Joining the OpenIDM Community</h2></div></div></div><p>After you <a class="link" href="https://idp.forgerock.org/openam/UI/Login?service=register" target="_top">sign up</a> at ForgeRock, you can also login to the Wiki and the issue
  database to follow what is happening with the project.</p><p>If you have questions regarding OpenIDM which are not answered by the
  documentation, there is a mailing list which can be found at
  <a class="link" href="https://lists.forgerock.org/mailman/listinfo/openidm" target="_top">https://lists.forgerock.org/mailman/listinfo/openidm</a> where you are
  likely to find an answer.</p><p>The Wiki has information on how to check out OpenIDM source code.
  There is also a mailing list for OpenIDM development which can be found at
  <a class="link" href="https://lists.forgerock.org/mailman/listinfo/openidm-dev" target="_top">https://lists.forgerock.org/mailman/listinfo/openidm-dev</a>
  Should you want to contribute a patch, test, or feature, or want to author
  part of the core documentation, first have a look on the ForgeRock site
  at <a class="link" href="http://www.forgerock.org/get_involved.html" target="_top">how to get
  involved</a>.</p></div></div><div class="part" id="d3595e220"><div class="titlepage"><div><div><h1 class="title">Part&nbsp;A.&nbsp;Overview</h1></div></div></div><div class="partintro" id="d3595e223"><div></div><p>TODO</p></div><div lang="en" class="chapter" id="chap-api-overview"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;1.&nbsp;OpenIDM APIs and Protocols</h2></div></div></div><div class="sect1" id="d3595e230"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1.1.&nbsp;Development</h2></div></div></div><p>Pages in this section should be aimed toward developers working on OpenIDM.</p><div class="sect2" id="d3595e235"><div class="titlepage"><div><div><h3 class="title">1.1.1.&nbsp;Dependencies</h3></div></div></div><p>This page outlines the external library dependencies that OpenIDM has with a brief description for each. For the exact version dependency consult the maven POM files.</p><div class="sect3" id="d3595e240"><div class="titlepage"><div><div><h4 class="title">1.1.1.1.&nbsp;Runtime dependencies</h4></div></div></div><p></p><p>These are prerequisites to deploy and run the OpenIDM zip package.</p><p></p><p>
                    <a class="link" href="http://www.oracle.com/technetwork/java/javase/overview/index.html" target="_top">Oracle Java SE JDK 6 Update 24+</a>
                </p><p>The latest stable version of the Sun Java Development Kit and runtime. We may elect to switch to OpenJDK in future, but there are known bugs that are still in it that are known to be fixed in Sun&#8217;s.</p><p></p></div><div class="sect3" id="d3595e255"><div class="titlepage"><div><div><h4 class="title">1.1.1.2.&nbsp;Build dependencies</h4></div></div></div><p></p><p>These are dependencies that are required to build OpenIDM from source.</p><p></p><p>
                    <a class="link" href="http://maven.apache.org/" target="_top">Maven 3.0+</a>
                </p><p>Manages the build of the OpenIDM project from source. Resolves module dependencies, compiles code, executes testing, provides build and test reporting and documentation.</p><p></p></div><div class="sect3" id="d3595e270"><div class="titlepage"><div><div><h4 class="title">1.1.1.3.&nbsp;Bundled dependencies</h4></div></div></div><p></p><p>These are runtime dependencies that we include in our zip package distribution. These are automatically resolved by Maven during the build.</p><p></p><p>
                    <a class="link" href="http://felix.apache.org/site/index.html" target="_top">Apache Felix</a>
                </p><p>The OSGi modularity framework that is bundled with the default packaging. We leverage additional optional bundles, such as the web console.</p><p></p><p>
                    <a class="link" href="http://jackson.codehaus.org" target="_top">Jackson</a>
                </p><p>A high-performance JSON processor. In most cases, we will be using this for simple data binding to standard Java data types: Map, List, String, Number, Boolean. Has good integration with Restlet for providing JSON representation of in-memory object structures.</p><p></p><p>
                    <a class="link" href="http://wiki.ops4j.org/display/paxweb/Pax+Web" target="_top">Jetty/Pax Web Bundle</a>
                </p><p>Servlet Container and HTTP service embedded as an OSGi bundle.</p><p></p><p>
                    <a class="link" href="http://www.orientechnologies.com/orient-db.htm" target="_top">OrientDB</a>
                </p><p>An embeddable NoSQL database that is bundled with OpenIDM as its default data store.</p><p></p><p>
                    <a class="link" href="http://www.quartz-scheduler.org" target="_top">Quartz Scheduler</a>
                </p><p>Scheduling service to perform periodic jobs. We currently use a wrapped version with an OSGi manifest created by servicemix.</p><p></p><p>
                    <a class="link" href="http://www.restlet.org" target="_top">Restlet</a>
                </p><p>Provides a resource-oriented architecture framework for exposure of objects via a RESTful HTTP API. Allows for more dynamic resource taxonomy and routing than other frameworks such as JAX-RS.</p><p></p><p>
                    <a class="link" href="http://www.mozilla.org/rhino" target="_top">Rhino</a>
                </p><p>Rhino is an open-source implementation of JavaScript written entirely in Java. It is typically embedded into Java applications to provide scripting to end users.</p><p></p><p>
                    <a class="link" href="http://www.slf4j.org" target="_top">SLF4J</a>
                </p><p>The Simple Logging Facade for Java, a facade for Java logging to defer binding to a particular logging implementation to deployment time. Extremely small, with nice features such as parameterized logging as well as nested and mapped diagnostic contexts (NDC/MDC).</p><p></p><p></p></div><div class="sect3" id="d3595e342"><div class="titlepage"><div><div><h4 class="title">1.1.1.4.&nbsp;Test dependencies</h4></div></div></div><p>These are dependencies that are required to perform unit and integration testing of OpenIDM. These are automatically resolved by Maven during the unit test phase.</p><p></p><p>
                    <a class="link" href="http://testng.org" target="_top">TestNG</a>
                </p><p>A testing framework for unit, functional, end-to-end and integration testing.</p><p></p><p>
                    <a class="link" href="http://docs.codehaus.org/display/FEST/Fluent+Assertions+Module" target="_top">FEST-Assert</a>
                </p><p>A library for writing fluent assertions in unit tests.</p></div></div><div class="sect2" id="d3595e363"><div class="titlepage"><div><div><h3 class="title">1.1.2.&nbsp;Guidelines</h3></div></div></div><div class="sect3" id="d3595e366"><div class="titlepage"><div><div><h4 class="title">1.1.2.1.&nbsp;Design guidelines</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Adhere to resource-oriented architecture patterns wherever practical.</p></li><li class="listitem"><p>Maintain JavaScript object model for objects with desired interoperability with applications, services, scripts.</p></li><li class="listitem"><p>Use OSGi bundles for loose coupling of components.</p></li></ul></div></div><div class="sect3" id="d3595e379"><div class="titlepage"><div><div><h4 class="title">1.1.2.2.&nbsp;Coding guidelines</h4></div></div></div><p>All coding conventions should follow the Code Conventions for the Java Programming Language, with the following exceptions:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Indentation: spaces, no tabs.</p></li><li class="listitem"><p>Line length limit: 128 characters.</p></li></ul></div></div></div></div></div><div lang="en" class="chapter" id="chap-distributed_task"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;2.&nbsp;Distributed Task</h2></div></div></div><p>The purpose of the distributed task mechanism is to allow for scaling and fail-over capabilities. </p><p></p><p>The implementation utilizes the existing shared infrastructure of the cluster nodes in the form of the shared repository (e.g. database) rather than adding another shared mechanism to install and administer. This mechanism is suitable for medium frequency/coarse grained jobs. If a need arises for fine grained/very frequent task distribution, utilizing an existing mechanism such as the http front-end is a possibility.</p><p></p><div class="sect1" id="d3595e401"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.1.&nbsp;Approach Basics</h2></div></div></div><p></p><p>The data store (repository) is used to add new tasks that any node can pick up (poll based model) and claim. Upon claiming a task, the node "leases" the task for a specified amount of time (e.g. 5 minutes). As it processes the task it renews the lease, i.e. regularly asks again for the lease to expire in 5 minutes. If the node for any reason stops processing (e.g. crashed) the lease expires, and another node is free to claim the task. The node can store a result in the task. This mechanism operates similar to a map/reduce mechanism.</p><p></p></div><div class="sect1" id="d3595e408"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.2.&nbsp;High Availability / HA</h2></div></div></div><p></p><p>The lease mechanism provides for automatic fail-over if a task does not make any progress anymore.</p><p></p><p>There is no leader and hence no single point of failure or need to re-elect leaders.</p><p></p></div><div class="sect1" id="d3595e418"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.3.&nbsp;Scaling</h2></div></div></div><p></p><p>A node can split out a task (such as a recon batch) into many pieces (such as 1000 records to recon each), and create individual tasks that can be claimed and processed by many nodes in parallel. By grouping the tasks a subsequent "join" task can be triggered that can process the completion of the whole batch.</p><p></p></div><div class="sect1" id="d3595e425"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.4.&nbsp;Task Handlers</h2></div></div></div><p></p><p>Nodes in the cluster upon start/up configuration should register all task handlers they are willing to handle. Nodes will only pick up work for task types it has handlers for, this is primarily intended to remove start-up race conditions, but can also be used to disable certain kinds of tasks (e.g. reconciliation) on a given node.</p><p></p></div><div class="sect1" id="d3595e432"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.5.&nbsp;Implementation Notes</h2></div></div></div><p></p><p>Each node has a scheduled activity that periodically checks for new work, and scans the tasks for abandoned tasks.</p><p></p></div><div class="sect1" id="d3595e439"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.6.&nbsp;Concurrency/Locking Notes</h2></div></div></div><p></p><p>The underlying store must provide for some way to allow a node to uniquely claim a task, e.g. optimistic concurrency to check that the "claim" update succeeded rather than conflicted with another node already claiming the task.</p><p></p><p>There is no guaranteed ordering amongst the distributed tasks; they can happen in any order and concurrently.</p><p></p></div><div class="sect1" id="d3595e449"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.7.&nbsp;Disallowing Concurrent Execution and Serialized Executions in the Cluster</h2></div></div></div><p></p><p>When there is a requirement that a given functionality is only executed by one node at any given time in the cluster, this mechanism can be used as well. If the nodes know of a unique name/id for the functionality (e.g. "check-database-consistency", they can assign that id as the taskId and ask the submit to ignore if the tasks entry already exists in the DB. This way even if multiple nodes ask to submit the same task, only one task will be stored and hence picked up. </p><p></p><p>Queing serialized execution of tasks is currently not supported, i.e. note that the task is only executed once. Multiple submits are not queued for serialized execution, duplicate submits are discarded/ignored. We could add a submitSerialExecution() capability going forward if required (which would queue the tasks and only serially process each in the cluster).</p><p></p></div><div class="sect1" id="d3595e459"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.8.&nbsp;QoS / Transactionality</h2></div></div></div><p></p><p>The task is processed on an at-least-once approach; i.e. until the task handler says it completed the task successfully, or it says there is something wrong in the task and it should not be re-tried - triggering an error handler.</p><p></p></div><div class="sect1" id="d3595e466"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.9.&nbsp;Sub-tasks and Grouping</h2></div></div></div><p></p><p>A group name (in the context of task type) &nbsp;provides for a way to define a "join" on the group - a task that gets triggered when the whole group finished (either successfully or not). </p><p></p><p>A group task's unique identifier consists of the task type (e.g. "reconcile-set-of-records"), a group name ("reconcile-system-x"), task number in group(10), group total tasks (100). The group task generation/submission should be done in a fashion that re-doing the generation results in the same identifier.</p><p></p><p>When the total number of task that will be submitted for a group is unknown whilst generating the tasks, only the last record submitted for group has both the task number in group and group total tasks, which must be the same (100/100). This is necessary for the system to detect when the whole group has finished. Previous tasks only have the task number in group set. The generation of tasks within a group should be idempotent, i.e. it should be able to re-do the task generation in a fashion that duplicates are ignored because the taskid is the same again.</p><p></p><p>A task can submit sub-tasks through the handler provided context. This implies that the spawning task is the parent of these sub-tasks. This allows for an enclosing task to a) ensure only one enclosing task of the same type (controlled through task id) runs at the same time in the cluster, and b) there is a place to handle a "join" (group finished handler) of the overall task, after all the sub-tasks are finished.</p><p></p><p>Only when the sub-tasks all finished will the parent task's "group finished handler" be triggered. For example, if only one reconciliation for a given system should run at any given time, and it is broken into sub-tasks a Handler for Single task "[recon-parent][recon-system-x] will submit 100 sub-tasks as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Submit single task with task type [recon-parent], task name &nbsp;"recon-system-x". </p></li><li class="listitem"><p>Node 1 picks up "[recon-parent][recon-system-x]", submits 100x grouped tasks with task type "recon-record-set", group name "recon-system-x", record numbers 1-100 / 100</p></li><li class="listitem"><p>All nodes start picking up and processing "[recon-record-set][recon-system-x][&lt;batch number&gt;/100]" tasks</p></li><li class="listitem"><p>When all "[recon-record-set][recon-system-x][&lt;batch number&gt;/100]" tasks finished, a task gets inserted to trigger the group finished handler for "recon-batch".</p></li><li class="listitem"><p>A node picks up and handles the group finished handler 'task' for "recon-record-set"</p></li><li class="listitem"><p>Upon completion of the "[recon-record-set][recon-system-x][group-finished-task]" group finished handler, a task gets inserted to trigger the group finished handler on the parent task, "[recon-parent][recon-system-x][group-finished-task]"</p></li><li class="listitem"><p>A node picks up and handles the group finished handler task for "[recon-parent][recon-system-x][group-finished-task]" </p></li></ul></div></div><div class="sect1" id="d3595e506"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.10.&nbsp;Scheduling </h2></div></div></div><p>Rather than having the scheduler be cluster aware, every node will have its own local scheduler - configured with a homogenous schedule. Where there are tasks that should be triggered only once cluster-wide this can be achieved by inserting a task with a taskId that is the same for all nodes, and for example encodes the configured trigger time. The submit should be configured to ignore if the task already exists. Hence, examples of some variations upon a scheduler triggering:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Execute something immediately on each node: no need to use the distributed task</p></li><li class="listitem"><p>Execute something once for this timer, on only one node: insert a distributed task with taskId "check-database-&lt;configured trigger date/time&gt;'</p></li><li class="listitem"><p>Execute something at most once in parallel, even if different timers trigger: insert a distributed task with taskid "active-sync-systemx"</p></li><li class="listitem"><p>Note that this would result in a subsequent configured active sync schedule of same type to be ignored if the existing still is in progress</p></li><li class="listitem"><p>Execute a group of tasks at most once in parallel, even if different configured timers trigger: insert a distributed task to spawn sub-tasks within a group, i.e.</p></li><li class="listitem"><p>Insert a distributed taks with taskid "recon-systemx" (group "recon-parent"), which spawns sub-tasks with taskids "recon-systemx-&lt;batch number&gt;" (group "recon-batch")</p></li><li class="listitem"><p>Note that this would result in a subsequent configured active sync schedule of same type to be ignored if the existing still is in progress</p></li><li class="listitem"><p>Queueing and Serializing executions not yet supported, i.e. can't queue group y to only start when group x finished.</p></li></ul></div></div><div class="sect1" id="d3595e536"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.11.&nbsp;API</h2></div></div></div><pre class="codelisting prettyprint linenums lang-java">
package org.forgerock.openidm.distributedtask;


/**
 * Distribute tasks across the cluster nodes for both scaling and HA/fail-over
 */

public interface DistributedTask {

    /**
     * @param failGroupFast if true a single task failure within the group
     * aborts further processing of the group and eventually triggers the
     * group handler
     * @param taskData the data associated with the task. Content must be
     * either 1. String, 2. JSON based object model and/or 3. Serializable
     * @return Task ID
     */

    String submit(TaskIdentifier taskId, int priority, Object taskData);

    /**
     * Register the implementation for a given task type
     * Will get invoked when a node claims a task and hands it to this handler.
     * The handler is responsible for executing the task, maintaining the
     * lease as it is processing, and for returning results if any
     */

    void registerTaskHandler(String taskType, TaskHandler taskHandler);

    /**
     * Handle if a group is finished processing, either successfully
     * (all tasks) or not.
     */

    void registerGroupFinishedHandler(String taskType, TaskHandler taskHandler);

    /**
     * Optional handler to customize how failed tasks are treated. Default
     * is to log, remove individual task and trigger group complete handling
     * if appropriate.
     */

    void registerInvalidTaskHandler(TaskHandler taskHandler);

}


public interface TaskIdentifier {

    String getStringifiedTaskId();

}



public class SingleTaskId implements TaskIdentifier {

    public SingleTaskId(String taskType, String taskName) {...};

}


public class GroupedTaskId implements TaskIdentifier {

    public GroupedTaskId(String taskType, String groupName,
        boolean failGroupFast, int taskNumber, int totalGroupTasks) {...};

}


public abstract class TaskHandler {

    /**
     * @param leaseSeconds sets the initial number of seconds the task
     * handler should own the task, it should be
     * plenty of time to either process the task, or to renew the lease;
     * but at the same time be reasonably short to achieve the desired
     * fail-over times when a handler/node has a problem and stops
     * processing/renewing the lease.
     */

    public void setInitialLeaseTime(int leaseSeconds) {

    }

    /**
     * @param taskData The data for the task to process. For a regular task
     * this data is what was submitted, for group finished tasks this
     * contains the success/failure and results of all the tasks that ran in
     * the group.
     * @return optional result, which can be used in the group complete
     * handler
     */

    Object process(TaskIdentifier taskId, int priority, Object taskData,
        LeaseManager leaseManager) throws InvalidTaskException,
        RetryLaterException, LeaseExpiredException;

}


public interface LeaseManager {

    /**
     * Renew the lease (the time allotted for the task handler to process the
     * next step and before someone else should assume that this taskHandler
     * has an issue and another node should take over. The lease time should
     * be selected so that during normal operation it is plenty of time for
     * the taskHandler to renew the lease for continous processing.
     * An example would be a lease of 5 minutes, and the taskHandler expects
     * to renew the lease every ~30 seconds.
     * To allow for frequent lease updates without unnecessary performance
     * overhead, the lease manager may batch/time writes to the persistence
     * store, but it must first check continued ownership of the task with
     * sufficient time.
     * @param leaseSeconds how many seconds from current time the lease
     * should expire
     * @throws LeaseExpiredException if the lease renewal did not succeed.
     * The task handler is required to abort the task processing as it now
     * does not own the task anymore.
     */

    boolean renewLease(int leaseSeconds) throws LeaseExpiredException {}

}</pre></div></div><div lang="en" class="chapter" id="chap-object_model"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;3.&nbsp;Object model</h2></div></div></div><p>Artifacts handled by OpenIDM are Java object representations of the JavaScript object model as defined by JSON. This supports interoperability and potential integration with a vast number of applications, services and programming languages. As OpenIDM is a Java-based product, these representations are instances of classes: Map, List, String, Number, Boolean and null (known in this documentation by the initialism: MLSNBN). OpenIDM can serialize/deserialize these structures to/from JSON as required.</p><p></p><p>OpenIDM exposes a set of triggers and functions that system administrators can define in JavaScript (with the ability to expand into other scripting and programming languages in the future), which can natively read and modify these JSON-based object model structures.</p><p></p></div><div lang="en" class="chapter" id="chap-repository"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;4.&nbsp;Repository</h2></div></div></div><p>The repository provides a common abstraction for a pluggable persistence layer. Plugged in repositories could be NoSQL, relational databases, ldap etc.</p><p></p><p>The API operates with (JSON-based) object model parameters/results, with the same RESTful principles as the other internal APIs.</p><p></p><p>Aside from get, put, patch, delete it also provides for queries for sets of objects.</p><p></p><div class="sect1" id="d3595e564"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.1.&nbsp;Query</h2></div></div></div><p>Repository Query</p><p></p><p>Implementation Phases</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In a first phase native queries are supported</p></li><li class="listitem"><p>In a second phase a common query expression independent of the underlying technology is planned.</p></li></ol></div><p></p><p>Assumptions</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>We will provide for native queries as a baseline. This way even when we add a common query language doesn't have to cover every possibility</p></li><li class="listitem"><p>A common expression/language to define queries, independent of the underlying data store is desirable in the long run</p></li><li class="listitem"><p>The client API provides for both the ability to execute pre-defined, parameterized queries, and the ability to supply the query as a parameter as well.</p></li></ol></div><p></p><p>Query Configuration</p><p></p><p>Queries can be configured either on the OrientDB service, i.e. the queries section of the file </p><p>conf/org.forgerock.repo.orientdb.json</p><p></p><p>Or they can be declared in the context of the calling module if it passes the expression to the repository as part of the query.</p><p></p><p>Query Types</p><p>The default is to express the query in the native language of the underlying store.</p><p></p><p>An optional querytype can be added going foward to explicitly declare the query type, e.g.</p><p></p><p>- Native query languages(s) - Languages/expressions directly understood by the underlying persistence store</p><p>- Common query languages(s) - NOTE: format TBD (*) &nbsp;</p><p>examples:</p><p></p><p>QueryType NATIVE</p><p>QueryType COMMON_JSON_PATH (*)</p><p>QueryType COMMON_SQL (*)</p><p></p><p>Common Query Formats</p><p></p><p>To be decided</p><p>&nbsp; </p><p>Query Tokens</p><p></p><p>Queries can contain tokens of the format ${token-name}, which will get replaced from parameters passed to the query.</p><p></p><p>Queries can be of type String or List.</p><p></p><p>At token of type List typically will be converted into a repository specific string representation to insert into the query, e.g. for an orientdb "query of "select ${_fields} from managed/user" a List of fields with firstname, lastname, email will be expanded to "select firstname,lastname,email from managed/user"</p><p></p><p>Query API</p><p></p><p>Object query(String id, Map params)</p><p></p><p>id: </p><p>identifies the resource set to query against, such as a relative uri for all "user" objects </p><p></p><p>params: </p><p>set of parameters that can be substituted as tokens into the query. Reserved property keys are defined in QueryConstants. </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The reserved property _queryId (QueryConstants.QUERY_ID) can specify a pre-configured parameterized query to execute</p></li><li class="listitem"><p>The reserved properties _queryExpressions ((QueryConstants.QUERY_EXPRESSION) (and optional _query-type) allow to pass add-hoc queries rather than specifying a query by id</p></li><li class="listitem"><p>The optional reserved properties _page-from (*), _page-size (*), _page-direction (*) can be used to page through the results either forwards or backwards. For the first page, the _page-from property can be empty; in the result meta-data the query will return two tokens for subsequent use in the _page-from parameter - a token representing the first record to page backwards, and a token representing the last record to page forward </p></li></ol></div><p></p><p>The system also populates the OrientDB document class name in the property "_resource" (QueryConstants.RESOURCE_NAME), which can be resulved as a query token, e.g.</p><p>select * from ${_resource}</p><p></p><p>return value:</p><p></p><p>a Map&lt;String, Object&gt; JSON based object model</p><p></p><p>The actual result set "records" are in the "result" map entry (QueryConstants.QUERY_RESULT) and of format List&lt;Map&lt;String, Object&gt;&gt;. Each list entry is a (potentially parts of) an object matching the query. If not all fields of an object were selected, only the selected parts of the object will be present.</p><p></p><p>Additional meta-data is available at the top level of the returned map, e.g. QueryConstants.STATISTICS_QUERY_TIME (time to execute the query in ms) or &nbsp;QueryConstants.STATISTICS_CONVERSION_TIME (time to convert the results to the object model in ms)</p><p></p><p>The metadata in the future can contain more information about the query, such as paging token for the first and last result to page backwards/forwards.</p><p></p><p>The paging mechanism does not guarantee isolation or consistency across the consecutive paging calls, i.e. changing the underlying data in between/during paging calls(s) will show up in the results. &nbsp;</p><p></p><p>Query Definition</p><p></p><p>The query definition happens based on structure of the stored object, e.g.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The mapping object which links arbitrary objects (managed and/or system objects)</p></li><li class="listitem"><p>The managed object structure and its associated schema</p></li><li class="listitem"><p>Intermediate objects constructed for recon and sync purposes</p></li><li class="listitem"><p>Objects constructed for reporting purposes</p></li></ol></div><p>The query can contain tokens (e.g. ${firstname}) that will get substituted at runtime by the value supplied in the params map argument</p><p></p><p>For example, assuming a managed object "managed/user"</p><div class="example" id="d3595e717"><div class="example-title">Example&nbsp;4.1.&nbsp;</div><div class="example-contents"><pre class="codelisting prettyprint">
{
    "_id" : "999",
    "_rev" : "0",
    "firstname" : "John",
    "lastname" : "Doe",
    "address":
    {
         "street":"Some ln",
         "city":"Somewhere",
         "zip":"99999"
    }
}</pre></div></div><br class="example-break"><p></p><p>Example associated queries</p><div class="example" id="d3595e724"><div class="example-title">Example&nbsp;4.2.&nbsp;</div><div class="example-contents"><pre class="codelisting prettyprint">
queries: {
    "my-query" : "select firstname, lastname from user where address.city = '${city}'"
}</pre></div></div><br class="example-break"><p></p><p>The call to Managed Object API can look something equivalent to the following (e.g. from the REST API, or from recon code)</p><p></p><pre class="codelisting prettyprint">
Map&lt;String, String&gt; params = new HashMap&lt;String, String&gt;();
params.put(QueryConstants.QUERY_ID, "my-query");
params.put("city", "Some");

Map&lt;String, Object&gt; result = query("managed/user", params);

List&lt;Map&lt;String, Object&gt;&gt; records = (List&lt;Map&lt;String, Object&gt;&gt;) result.get(QueryConstants.QUERY_RESULT);
for (Map&lt;String, Object&gt; entry : records.entrySet()) {
    entry.get("firstname");
    entry.get("lastname");
    entry.get("_id");
    entry.get("_rev");
}
Long queryTimeMs = (String) result.get(QueryConstants.STATISTICS_QUERY_TIME);
Long conversionTimeMs = result.get(QueryConstants.STATISTICS_CONVERSION_TIME);

// Not yet supported
// result.get(QueryConstants.PAGING_TOKEN_FIRST);
// result.get(QueryConstants.PAGING_TOKEN_LAST);
        </pre><p></p><p>It may pass this query directly to the repository service, "as is". The specific repository service implementation, e.g. the repo-orientdb would have read in the query definitions. If necessary it can translate a common query format into something it natively understands, or - as in this example - use the native query directly. </p><p></p><p>Performance Considerations</p><p></p><p>Care needs to be taken to create appropriate indexes on queried fields.</p><p></p><p>When creating queries with tokens, note that OrientDB can only make prepared statements with tokens in the "where" clause. Hence if tokens are used elsewhere, the repository will create queries on demand with the replaced tokens.</p><p></p><p>Comments</p><p></p><p>TODO: make sure the API aligns with the query API specified on the managed object</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Might need to provide less rigid pre-defined queries, e.g. being able to search a user given any number of combinations of fields</p></li><li class="listitem"><p>The common query technology choice is a concern. </p></li><li class="listitem"><p>JSONPath (or JSONQuery) is not a standard and not well known. Although technically it fits nicely into the architecture, this may not appeal that much to folks that might be DB developers/admins.</p></li><li class="listitem"><p>SQL is more familiar to many, but we may have to invent a query syntax that allows querying embedded documents. It also is not terribly JSON related.</p></li><li class="listitem"><p>XPath is another technology that is pretty well known, but obviously is typically thought of as XML related - although JXPath provides queries on arbitrary java objects for example.</p></li><li class="listitem"><p>The common query flexiblity/effort is a concern: Depending on the extent of what needs to be expressable this could become a considerable effort for every persistence option, including concerns about lowest common denominator and other incompatibilities.</p></li><li class="listitem"><p>Rather than simple token substitution from a single dimension map we could support notations to traverse objects, akin to the JSP expression language (EL). We could also then include whole resource "objects" as a paramter map entry, e.g. "${systemobject.firstname}". This could remove the need for a javascript mapping to extract parameters for simple cases.</p></li></ol></div><p></p></div></div><div lang="en" class="chapter" id="chap-terminology"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;5.&nbsp;Terminology</h2></div></div></div><div class="sect1" id="d3595e780"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.1.&nbsp;Managed object</h2></div></div></div><p>An object modeled to represent the identity-related data managed by OpenIDM and potentially across multiple resources.</p><p></p></div><div class="sect1" id="d3595e786"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.2.&nbsp;Mapping object</h2></div></div></div><p>An artifact that defines the mappings between the properties of a managed object type and the properties of a resource object type.</p><p></p></div><div class="sect1" id="d3595e792"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.3.&nbsp;Object</h2></div></div></div><p>An object, per the object model. Addressable objects have identifiers that can be used to establish a location where the object can be accessed, per OpenIDM's resource oriented architecture.</p><p></p></div><div class="sect1" id="d3595e798"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.4.&nbsp;Resource</h2></div></div></div><p>An application, service or data store with which OpenIDM synchronizes data with its own internal managed objects.</p><p></p></div><div class="sect1" id="d3595e804"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.5.&nbsp;Resource object</h2></div></div></div><p>An artifact that is stored in a resource, which OpenIDM accesses during provisioning, synchronization and reconciliation.</p><p></p></div><div class="sect1" id="d3595e810"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.6.&nbsp;Schema object</h2></div></div></div><p>An artifact that defines the structure and semantics of an object.</p><p></p></div></div><div lang="en" class="chapter" id="chap-best-practices"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;6.&nbsp;Best Practices For OpenIDM Integration</h2></div></div></div><p>This chapter presents best practices to keep in mind when integrating
 and extending OpenIDM services in your organization.</p></div></div><div class="index" id="d3595e822"><div class="titlepage"><div><div><h1 class="title">Index</h1></div></div></div><div xmlns:xlink="http://www.w3.org/1999/xlink" class="index"></div></div></div><a href="#" class="back-to-top hidden-xs"><button type="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-chevron-up"></span></button></a></div></div><div class="footer"><div class="container-fluid"><div class="footer-left"></div><div class="footer-right"><a target="_blank" class="footer-item snap-left" href="legalnotice.html"><i class="glyphicon glyphicon-briefcase"></i> Legal Notice</a><a target="_blank" class="footer-item snap-left" href="https://github.com/OpenIdentityPlatform/OpenAM/issues"><i class="glyphicon glyphicon-ok-sign"></i> Feedback</a><a target="_blank" class="footer-item snap-left" href="#" data-toggle="modal" data-target="#myModal"><i class="glyphicon glyphicon-info-sign"></i> About</a></div></div></div></body></html>