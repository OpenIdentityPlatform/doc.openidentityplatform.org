---
layout: 'null'
---
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <style type="text/css">
   /*
* The contents of this file are subject to the terms of the Common Development and
* Distribution License (the License). You may not use this file except in compliance with the
* License.
*
* You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the
* specific language governing permission and limitations under the License.
*
* When distributing Covered Software, include this CDDL Header Notice in each file and include
* the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL
* Header, with the fields enclosed by brackets [] replaced by your own identifying
* information: "Portions copyright [year] [name of copyright owner]".
*
* Copyright 2015 ForgeRock AS.
* Portions copyright 2024 3A Systems LLC.
*/

/***********************************/
/* Imported Styles
/***********************************/

@import url(http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,300,400,700);
@import url(http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css);
@import url(http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css);
/* @import url(http://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css); */
@import url(http://cdnjs.cloudflare.com/ajax/libs/jquery.colorbox/1.4.33/example1/colorbox.css);

/***********************************/
/* General Styles
/***********************************/

html {
    height: 100%;
}

body {
    /* Dark Grey */

    color: #2a2f32;
    font-family: 'Open Sans', "proxima-nova", sans-serif;
}

a {
    /* Sea Green */
    color: #519387;
}

a.link[href^="http"] {
    background-image: url("includes/logos/Icon_External_Link.png");
    background-position: top right;
    background-repeat: no-repeat;
    padding-right: 15px;
    margin-right: 2px;
}

a.self-link, a.self-link:hover, a.self-link:active {
    color: inherit;
    text-decoration: none;
}

a[href].self-link:hover::after
{
    -moz-osx-font-smoothing: grayscale;
    content: "\e144";
    color: #519387;
    display: inline-block;
    font-family: "Glyphicons Halflings";
    font-size: 75%;
    font-style: normal;
    line-height: 1;
    padding-left: 5px;
    position: relative;
    top: 1px;
}


li.L0,
li.L1,
li.L2,
li.L3,
li.L5,
li.L6,
li.L7,
li.L8 {
    list-style-type: decimal !important
}

.section,
.chapter,
.preface,
.glossary,
.refentry,
.reference,
.appendix,
.index,
.titlepage h2,
.titlepage h3,
.titlepage h4,
.titlepage h5 {
    padding-top: 60px;
    margin-top: -50px;
}

.left-shape-content {
    background: url("includes/logos/left-shape-4.png") no-repeat scroll 0 0 rgba(0, 0, 0, 0);
    float: left;
    height: 566px;
    position: fixed;
    width: 57px;
    top: 60%;
    z-index: -1;
}

/***********************************/
/* Bootstrap Override Styles
/***********************************/

/* Button Styles */

.btn-primary {
    /* Sea Green */
    background-color: #519387;

    /* Dark Sea Green */
    border-color: #488378;
    color: #fff;
}

.btn-default {
    background-color: #A1A8AD;
    border-color: #8a9298;
    color: #ffffff;
}

.btn-default:hover,
.btn-default:focus,
.btn-default.focus,
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
    background-color: #3f4b54;
    border-color: #1B2025;
    color: #ffffff;
}

/* Tooltip Styles */

.tooltip.in {
    opacity: 0.95;
}

.tooltip.bottom .tooltip-arrow {
    border-bottom-color: #519387;
}

.tooltip-inner {
    background-color: #519387;
}

/* List Styles */

.dl-horizontal dt {
    white-space: normal;
    padding: 0 3px 0 0;
    width: 200px;
}

.dl-horizontal dd {
    border-bottom: 1px dotted rgb(125, 179, 168);
    border-bottom: 1px dotted rgba(125, 179, 168, 0.8);
    margin-bottom: 18px;
    margin-left: 210px;
}

.dl-horizontal {
    border-top: 1px dotted rgb(125, 179, 168);
    border-top: 1px dotted rgba(125, 179, 168, 0.9);
    padding-top: 10px;
}

.variablelist dt {
    margin: 18px 0 5px 15px;
}

.variablelist dd {
    border-bottom: 1px dotted rgba(125, 179, 168, 0.8);
    margin: 5px 0 5px 30px;
}

.variablelist > dl {
    border-top: 1px dotted rgba(125, 179, 168, 0.8);
}


/***********************************/
/* Redirect Page Styles
/***********************************/

.index-redirect,
.index-redirect body {
    height: 100%;
    background-color: #333;
    font-family: 'Open Sans', "proxima-nova", sans-serif;
}
.index-redirect body {
    color: #fff;
    text-align: center;
}
.index-redirect .container {
    display: table;
    vertical-align: middle;
    height: 100%;
}
.index-redirect .btn-primary {
    /* Sea Green */
    background-color: #519387;

    /* Dark Sea Green */
    border-color: #488378;
    color: #fff;
}
.index-redirect .cover-heading {
    font-weight: 400 !important;
}
.index-redirect .vertical-center-row {
    display: table-cell;
    vertical-align: middle;
}

/***********************************/
/* Header Styles
/***********************************/

.navbar-brand {
    padding: 7px 15px;
    display: flex;
    align-items: center;
}
.navbar-brand > img {
    height: 100%;
}

.navbar.navbar-inverse.navbar-fixed-top {
    box-shadow: 0 0 10px 2px #111;
}
.nav > li > a {
    font-weight: 200;
}

/***********************************/
/* Banner Styles
/***********************************/

.jumbotron {
    /* Sea Green */
    background: url("includes/logos/hero-bg-01.png") no-repeat scroll left top #519387;
    color: white;
    box-shadow: 0 0 10px 2px grey;
    margin-top: 50px;
    padding: 0 0 10px;
}
.jumbotron small {
    color: white;
}
.jumbotron p {
    font-size: 12px;
    font-weight: 400;
    margin-bottom: 5px;
}
.jumbotron h1 {
    font-size: 23px !important;
    font-weight: 300 !important;
}

/***********************************/
/* Table of Contents Styles
/***********************************/

#sidebar .nav>li>a {
    /* Light Grey */

    color: #777;
    border-left: 4px solid transparent;
    padding: 4px 10px;
    font-size: 13px;
    font-weight: 400;
}
/* nested links */

#sidebar .nav .nav>li>a {
    padding-top: 2px;
    padding-bottom: 2px;
    padding-left: 30px;
    font-size: 12px;
}
/* nested nested links */

#sidebar .nav .nav .nav>li>a {
    font-size: 11px;
    padding-bottom: 2px;
    padding-left: 50px;
    padding-top: 4px;
}
/* nested nested nested links */

#sidebar .nav .nav .nav .nav>li>a {
    font-size: 11px;
    padding-bottom: 2px;
    padding-left: 70px;
    padding-top: 4px;
}
/* active and hover links */

#sidebar .nav>.active>a,
#sidebar .nav>.locked-active>a,
#sidebar .nav>li>a:hover,
#sidebar .nav>li>a:focus {
    text-decoration: none;
    /*
    background-color: rgb(125, 179, 168, 0.8);
    background-color: rgba(125, 179, 168, 0.8);
    border-color: rgb(45, 52, 55, 0.8);
    border-color: rgba(45, 52, 55, 0.8);
    color: white;
    */
    /* Bright Yellow */

    background-color: #eeea07;
    border-color: #eeea07;
    /* Grey */

    color: #2a2f32;
}
/* all active links */

#sidebar .nav>.active>a,
#sidebar .nav>.active:hover>a,
#sidebar .nav>.active:focus>a {
    font-weight: 600;
}
/* nested active links */

#sidebar .nav .nav>.active>a,
#sidebar .nav .nav>.active:hover>a,
#sidebar .nav .nav>.active:focus>a {
    font-weight: 400;
}
/* nested nested active links */

#sidebar .nav .nav .nav>.active>a,
#sidebar .nav .nav .nav>.active:hover>a,
#sidebar .nav .nav .nav>.active:focus>a {
    font-weight: 300;
}
/* nested nested active links */

#sidebar .nav .nav .nav>.active>a,
#sidebar .nav .nav .nav>.active:hover>a,
#sidebar .nav .nav .nav>.active:focus>a {
    font-weight: 300;
}
/* hide all (inactive) nested list */

#sidebar .nav ul.nav {
    display: none;
}
/* show active nested list */

#sidebar .nav>.active>ul.nav {
    display: block;
}
#sidebar.affix {
    top: 66px;
    position: fixed;
    bottom: 30px;
    height: auto;
    overflow-y: scroll;
}
#sidebar.affix-bottom {
    position: absolute;
}

/***********************************/
/* Content Styles
/***********************************/

/* Main Content Styles */

h1 {
    font-size: 40px !important;
    font-weight: 700 !important;
}

h1 span {
    margin-right: .3em;
}

#doc-content h1,
#doc-content .h1 {
    /* Sea Green */
    border-bottom: 2px solid #70ab9b;
    font-size: 36px;
    margin-top: 24px;
    padding-bottom: 5px;
}

h2 {
    font-size: 32px !important;
    font-weight: 700 !important;
}

h5, .h5 {
    border-bottom: 1px solid #d3d3d3;
    font-size: 16px;
    padding-bottom: 4px;
    font-style: italic;
}

.anchorjs-link .anchorjs-icon {
    color: #A1A8AD;
    text-decoration: none;
}
.anchorjs-link:hover .anchorjs-icon {
    color: #519387;
    text-decoration: none;
}

h1:hover > .anchorjs-link,
h2:hover > .anchorjs-link,
h3:hover > .anchorjs-link,
h4:hover > .anchorjs-link,
h5:hover > .anchorjs-link,
.anchorjs-link:focus {
    opacity: 1 !important;
    transition: color 0.16s linear 0s;
    text-decoration: none;
}

.chapter > p:first-of-type,
.preface > p:first-of-type {
    font-size: 21px;
    font-weight: 300;
    line-height: 1.4;
    margin-bottom: 20px;
}

#doc-content {
    padding: 0 20px 85px 10px;
}

div.procedure, div.table {
    margin-top:-50px;
    padding-top: 60px;
}

div.procedure-title, div.table-title {
    margin: 6px 0 8px;
}

div.procedure-inner {
    border-color: lightslategray;
    border-left: 6px solid lightslategray;
    border-style: dotted dotted dotted solid;
    border-width: 1px 1px 1px 6px;
    margin: 15px 0 10px;
    padding: 10px 15px 10px 10px;
}

.author {
    display: inline;
}

.table {
    font-size: 14px;
}

div.simplelist {
    margin-bottom: 10px;
    width: 100%;
    font-size: 15px;
}

/* Title Styles */

.procedure-title > a, .procedure-title > a:hover {
    color: lightslategray;
    font-size: 14pt;
    font-weight: 400;
}

.itemizedlist-title {
    font-size: 18px;
    font-weight: 600;
    margin: 12px 0 6px;
}

.figure-title {
    font-weight: bold;
    margin: 16px 0 4px;
    text-align: center;
}

.table-title {
    font-size: 12pt;
    font-weight: 700;
}

.variablelist-title {
    font-weight: bold;
    margin: 10px 0;
    text-decoration: underline;
}

/* Code Styles */

.btn-copy-cmdline,
.btn-copy-codelisting {
    /* White */

    background-color: #fff;
    /* Light Grey */

    border: 1px solid #e1e1e8;
    border-radius: 0 4px;
    color: #777;
    display: block;
    font-size: 12px;
    padding: 5px 8px;
    position: absolute;
    right: 5px;
    top: 5px;
    z-index: 10;
}

pre.prettyprint {
    border: 1px solid #ccc;
    padding: 9.5px;
    font-size: 12px;
}

.zero-clipboard {
    display: block;
    position: relative;
}
.zeroclipboard-is-hover {
    /* Light Sea Green */

    background-color: #6faa9b;
    border-color: #6faa9b;
    color: #fff;
    cursor: pointer;
}

.ui-effects-transfer {
    border: 1px dotted black;
    background-color: yellow;
    opacity: 0.4;
}

/* Modal Dialog Styles */

#doc-content .modal h1.title {
    font-size: 40px !important;
    font-weight: 500 !important;
    margin: 14px 0 5px;
}
#doc-content .modal h2.subtitle {
    font-size: 26px !important;
    font-weight: 400 !important;
    margin-bottom: 26px;
}
#doc-content .modal h3.author {
    font-size: 14px !important;
    font-style: italic;
    font-weight: 100 !important;
    margin: 4px 0 5px 18px;
}
#doc-content .modal .affiliation .orgname {
    display: block;
    font-size: 20px !important;
    font-weight: 400 !important;
    margin: 20px 0 0 0;
}
#doc-content .modal .affiliation .address p {
    font-size: 16px !important;
    font-weight: 100 !important;
    margin: 4px 0;
}
#doc-content .modal .copyright {
    display: none;
}
#doc-content .modal .copyright {
    display: none;
}
#doc-content .modal .abstract .abstract-title {
    font-size: 20px !important;
    font-weight: 400 !important;
}
#doc-content .modal .abstract > p {
    margin: 10px 0 5px 20px;
    font-size: 16px !important;
    font-weight: 100 !important;
}

/* Image Styles */

.fancybox > img {
    cursor: zoom-in;
}
a.fancybox {
    text-decoration: none;
}

#cboxTitle {
    color: #519387;
    font-size: 14px;
    font-weight: 700;
}

#cboxOverlay{
    background: none repeat scroll 0 0 rgba(66, 130, 116, 0.6);
}

img.img-responsive {
    margin-bottom: 20px;
}

/* Index Styles */

.indexdiv > h3 {
    border-bottom: 2px dotted lightgrey;
    padding-bottom: 5px;
}
.indexdiv > dl {
    margin-left: 30px;
}
.indexdiv dl {
    margin-bottom: 5px;
}
.indexdiv dt {
    margin: 5px 0 2px;
}
.indexdiv dd {
    margin-left: 35px;
}
.indexdiv .indexterm {
    font-weight: 200;
}

/* Reference Styles */

.refnamediv h2 {
    display: none;
}

.refsect1 h2,
.refsynopsisdiv h2 {
    font-size: 20px !important;
    font-weight: 400 !important;
}

.refnamediv p {
    font-size: 32px !important;
    font-weight: 700 !important;
}

/***********************************/
/* Footer Styles
/***********************************/

.back-to-top {
    position: fixed;
    bottom: 55px;
    right: 5px;
    display: none;
    z-index: 15;
}

#footer {
    display: none;
}

.footer {
    /* Light Grey */
    background-color: #f5f5f5;

    /* Medium Grey */
    border-top: 1px solid #ACB5BD;
    bottom: 0;
    font-size: 12px;
    height: 30px;
    padding-top: 4px;
    position: fixed;
    width: 100%;
    z-index: 100;
}

.footer h3 {
    margin: 0;
}

.footer a:hover {
    text-decoration: none;
}

.footer-item {
    line-height: 22px;
    margin-left: 10px;
}

.footer-item.highlighted {
    /* Orange */
    color: #f7a540;
}

.footer-item.highlighted:hover {
    /* Dark Orange */
    color: #c97208;
}

.footer span {
    /* Grey */
    color: #2a2f32;
    margin-bottom: 0;
}

.footer .footer-left {
    float: left;
}

.footer .footer-right {
    float: right;
}

/***********************************/

  </style><meta name="viewport" content="width=device-width, initial-scale=1"><title>OpenAM Java EE Policy Agent Installation Guide</title><script src="http://code.jquery.com/jquery-1.11.2.min.js" type="text/javascript"></script><script src="http://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script><script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="description" content="Guide to installing OpenAM Java EE policy agents. OpenAM provides open source Authentication, Authorization, Entitlement and Federation software."><script type="text/javascript">
     /*
 * The contents of this file are subject to the terms of the Common Development and
 * Distribution License (the License). You may not use this file except in compliance with the
 * License.
 *
 * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the
 * specific language governing permission and limitations under the License.
 *
 * When distributing Covered Software, include this CDDL Header Notice in each file and include
 * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL
 * Header, with the fields enclosed by brackets [] replaced by your own identifying
 * information: "Portions copyright [year] [name of copyright owner]".
 *
 * Copyright 2015 ForgeRock AS.
 */

//

var loadJavaScriptsFN = function () {
    $.ajaxSetup({ cache: true });
    $.getScript("http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js", function () { prettyPrint() });
    $.getScript("http://cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.2.0/ZeroClipboard.min.js", function () {enableZeroClipboardFN() });
    $.getScript("http://cdnjs.cloudflare.com/ajax/libs/jquery.colorbox/1.4.33/jquery.colorbox-min.js", function () { enableColorboxFN() });
};

var wrapConfigurablesFn = function () {
    $('*:contains("https://openam.example.com:8443")').each(function(){
        if($(this).children().length < 1)
            $(this).html(
                $(this).text().replace(new RegExp("https://openam.example.com:8443", 'g'),'<span class="exampleUrl">https://openam.example.com:8443</span>')
            )
    });
    $('*:contains("amadmin")').each(function(){
        if($(this).children().length < 1)
            $(this).html(
                $(this).text().replace(new RegExp("amadmin", 'g'),'<span class="exampleAdmin">amadmin</span>')
            )
    });
    $('*:contains("iPlanetDirectoryPro")').each(function(){
        if($(this).children().length < 1)
            $(this).html(
                $(this).text().replace(new RegExp("iPlanetDirectoryPro", 'g'),'<span class="exampleSsoCookieName">iPlanetDirectoryPro</span>')
            )
    });
};

var btnClickHandler = function () {
    $("button#applyDocUpdate").click(function(){

        $('span.exampleUrl').fadeOut("slow", function(){
            $('span.exampleUrl').text($("input#exampleUrl").val());
            $('span.exampleUrl').fadeIn("slow");
        });

        $('span.exampleAdmin').fadeOut("slow", function(){
            $('span.exampleAdmin').text($("input#exampleAdmin").val());
            $('span.exampleAdmin').fadeIn("slow");
        });

        $('span.exampleSsoCookieName').fadeOut("slow", function(){
            $('span.exampleSsoCookieName').text($("input#exampleSsoCookieName").val());
            $('span.exampleSsoCookieName').fadeIn("slow");
        });

        $('#docConfig').modal('hide');
    });
};


var addCopyButtonFN = function () {
    $( ".cmdline" ).each(function() {
        $(this).before('<div class="zero-clipboard hidden-xs"><span class="btn-copy-cmdline"><span class="glyphicon glyphicon-pencil"></span> Copy<span class="hidden-sm"> command to clipboard</span></span></div>');
    });

    $( ".codelisting" ).each(function() {
        $(this).before('<div class="zero-clipboard hidden-xs"><span class="btn-copy-codelisting"><span class="glyphicon glyphicon-pencil"></span> Copy<span class="hidden-sm"> code to clipboard</span></span></div>');
    });
};
var enableScrollSpyFN = function () {
    $('body').scrollspy({
        target: '#sidebar',
        offset: 16
    });
};

var enableToolTipFN = function () {
    $(function () {
        $("[data-toggle='tooltip']").tooltip({placement: 'bottom'});
    });
};

var enableBackToTopFadeInFN = function () {
    var offset = 220;
    var duration = 500;
    $(window).scroll(function() {
        if ($(this).scrollTop() > offset) {
            $('.back-to-top').fadeIn(duration);
        } else {
            $('.back-to-top').fadeOut(duration);
        }
    });

    $('.back-to-top').click(function(event) {
        event.preventDefault();
        $('html, body').animate({scrollTop: 0}, duration);
        return false;
    })
};

var enableClampedWidthsFN = function () {

    /*
     * Clamped-width.
     * Usage:
     *  <div data-clampedwidth=".myParent">This long content will force clamped width</div>
     *
     * Author: LV
     */
    $('[data-clampedwidth]').each(function () {
        var elem = $(this);
        var parentPanel = elem.data('clampedwidth');
        var resizeFn = function () {
            var sideBarNavWidth = $(parentPanel).width() - parseInt(elem.css('paddingLeft')) - parseInt(elem.css('paddingRight')) - parseInt(elem.css('marginLeft')) - parseInt(elem.css('marginRight')) - parseInt(elem.css('borderLeftWidth')) - parseInt(elem.css('borderRightWidth'));
            elem.css('width', sideBarNavWidth);
        };

        resizeFn();
        $(window).resize(resizeFn);
    });
};

var affixToCFN = function() {
    $('#sidebar').affix({
        offset: {
            top: function () {
                return (this.top = $('.jumbotron').outerHeight(true)-66)
            }
        }
    });
};

var attachAnchorsToHeadings = function() {
    //addAnchors('h1.title, h2.title, h3.title, h4.title, h5.title');


    $('h1.title, h2.title, h3.title, h4.title, h5.title, .procedure-title, .table-title').each(function () {

        var href = $(this).closest("div[id]").attr("id");

        if (href === undefined || href === "") { // Unable to locate ID of parent element.
            return;
        }

        $(this).wrapInner('<a class=\"self-link" href=\"#' + href + '\"></a>');

    });
};

var addZeroClipboardToCmdlineButtonsFN = function () {
    var copycmdline = new ZeroClipboard( $('.btn-copy-cmdline') );

    copycmdline.on( 'ready', function(event) {
        // console.log( 'movie is loaded' );

        copycmdline.on( 'copy', function(event) {
            var wrappedText = "";
            $(event.target).parent().next().find("strong").each(function(index) {
                wrappedText += $(this).text() + "\n";
            });
            event.clipboardData.setData('text/plain', wrappedText);
        });

        copycmdline.on( 'aftercopy', function(event) {
            // console.log('Copied to clipboard: ' + event.data['text/plain']);
            $(event.target).parent().next().find("strong").each(function(index) {
                $(this).effect("transfer", { to: $(event.target)}, 750);
            });
        });
    });

    copycmdline.on( 'error', function(event) {
        console.log( 'ZeroClipboard error of type "' + event.name + '": ' + event.message );
        ZeroClipboard.destroy();
    });
};

var addZeroClipboardToCodeButtonsFN = function () {
    var copycodelisting = new ZeroClipboard( $('.btn-copy-codelisting') );

    copycodelisting.on( 'ready', function(event) {
        //console.log( 'movie is loaded' );

        copycodelisting.on( 'copy', function(event) {
            var wrappedText = "";
            $(event.target).parent().next(".codelisting.linenums").children().contents().each(function(index) {
                wrappedText += $(this).text() + "\n";
            });
            if(wrappedText == "") {
                wrappedText = $(event.target).parent().next(".codelisting").contents().text();
            };
            event.clipboardData.setData('text/plain', wrappedText);
        });

        copycodelisting.on( 'aftercopy', function(event) {
            // console.log('Copied code to clipboard: ' + event.data['text/plain']);
            $(event.target).parent().next(".codelisting").first().effect("transfer", { to: $(event.target)}, 750);
        });
    });

    copycodelisting.on( 'error', function(event) {
        console.log( 'ZeroClipboard error of type "' + event.name + '": ' + event.message );
        ZeroClipboard.destroy();
    });
};

var enableColorboxFN = function () {
    $(".fancybox").colorbox({
        title: function() {
            return $(this).children('img').attr('alt');
        },
        opacity: 1,
        transition:"elastic",
        initialWidth: 0,
        initialHeight: 0,
        maxWidth:"95%",
        maxHeight: "95%",
        scalePhotos: true,
        fixed: true
    });
};

var trackPageViewsFN = function () {

    $("a").click(function() {
        var href = $(this).attr('href');
        if(href) {
            var titleText =  $(this).text();
            if(href.charAt(0) === '#') {
                ga('send', {
                    'hitType': 'pageview',
                    'page': location.pathname + location.search + href,
                    'title': titleText
                });
            };
            if(href.charAt(0) === '.') {
                var lastHashPos = href.lastIndexOf('#');
                var cleanHref = href.slice(3,lastHashPos);
                var cleanFrag = href.slice(lastHashPos);
                if(window.location.href.search(cleanHref) > -1)
                {
                    ga('send', {
                        'hitType': 'pageview',
                        'page': location.pathname + location.search + cleanFrag,
                        'title': titleText
                    });
                }
            };
        }
    });
};

var enableZeroClipboardFN = function () {
    ZeroClipboard.config({
            swfPath:  "includes/swf/ZeroClipboard.swf",
            trustedDomains: ["*"],
            forceEnhancedClipboard: false,
            forceHandCursor: true,
            debug: false}
    );
    addCopyButtonFN();
    addZeroClipboardToCmdlineButtonsFN();
    addZeroClipboardToCodeButtonsFN();
};

$(document).ready(function() {
    //wrapConfigurablesFn();
    btnClickHandler();
    enableToolTipFN();
    enableBackToTopFadeInFN();
    enableClampedWidthsFN();
    enableScrollSpyFN();
    affixToCFN();
    attachAnchorsToHeadings();
    trackPageViewsFN();
    loadJavaScriptsFN();
});

//

    </script></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navbar navbar-inverse navbar-fixed-top"><nav class="container-fluid"><div class="navbar-header"><a href="/" class="navbar-brand"><span>Open Identity Platform</span></a></div><ul id="pdf-link"></ul></nav></div><div class="jumbotron"><div class="container-fluid"><h1>OpenAM Java EE Policy Agent  Installation Guide<span></span><small></small></h1><p>Guide to installing OpenAM Java EE policy agents. OpenAM provides open source
   Authentication, Authorization, Entitlement and Federation software.</p></div></div><div class="left-shape-content"></div><div class="container-fluid"><div class="row"><div class="col-sm-3 hidden-xs"><div id="sidebar" data-clampedwidth=".col-sm-3"><h4 class="toc-title">OpenAM Java EE Policy Agent  Installation Guide<br><small class="toc-subtitle"></small></h4><ul class="nav nav-stacked"><li><a href="#preface">Preface</a><ul class="nav nav-stacked"><li><a href="#d0e122">1. Who Should Use this Guide</a></li><li><a href="#formatting-conventions">2. Formatting Conventions</a></li><li><a href="#accessing-doc-online">3. Accessing Documentation Online</a></li><li><a href="#joining-the-community">4. Joining the Open Identity Platform Community</a></li></ul></li><li><a href="#chap-about-jee-agents">1. About OpenAM Java EE Policy Agents</a><ul class="nav nav-stacked"><li><a href="#example-j2ee-agent-interaction">1.1. How the User, Application, Policy Agent, &amp; OpenAM Interact</a></li><li><a href="#j2ee-agent-configuration">1.2. How J2EE Policy Agents are Configured</a></li></ul></li><li><a href="#chap-apache-tomcat">2. Installing the Apache Tomcat Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-tomcat-agent-install">2.1. Before You Install</a></li><li><a href="#install-tomcat-agent">2.2. Installing the Tomcat Policy Agent</a></li><li><a href="#silent-tomcat-agent-installation">2.3. Silent Tomcat Policy Agent Installation</a></li><li><a href="#uninstall-tomcat-agent">2.4. Remove Tomcat Policy Agent Software</a></li></ul></li><li><a href="#chap-glassfish">3. Installing the GlassFish Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-glassfish-agent-install">3.1. Before You Install</a></li><li><a href="#install-glassfish-agent">3.2. Installing the GlassFish Policy Agent</a></li><li><a href="#silent-glassfish-agent-installation">3.3. Silent GlassFish Policy Agent Installation</a></li><li><a href="#uninstall-glassfish-agent">3.4. Removing GlassFish Policy Agent Software</a></li></ul></li><li><a href="#chap-jboss-4and5">4. Installing the JBoss 4 and 5 Application Server Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-jboss4and5-agent-install">4.1. Before You Install</a></li><li><a href="#install-jboss4and5-agent">4.2. Installing the JBoss Policy Agent</a></li><li><a href="#silent-jboss4and5-agent-installation">4.3. Silent JBoss Policy Agent Installation</a></li><li><a href="#uninstall4and5-jboss-agent">4.4. Removing JBoss Policy Agent Software</a></li></ul></li><li><a href="#chap-jboss-7">5. Installing the JBoss 7 Application Server Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-jboss7-agent-install">5.1. Before You Install</a></li><li><a href="#install-jboss7-agent">5.2. Installing the JBoss Policy Agent</a></li><li><a href="#silent-jboss7-agent-installation">5.3. Silent JBoss Policy Agent Installation</a></li><li><a href="#uninstall-jboss7-agent">5.4. Removing JBoss Policy Agent Software</a></li></ul></li><li><a href="#chap-jetty">6. Installing the Jetty Server Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-jetty-agent-install">6.1. Before You Install</a></li><li><a href="#install-jetty-agent">6.2. Installing the Jetty Policy Agent</a></li><li><a href="#silent-jetty-agent-installation">6.3. Silent Jetty Policy Agent Installation</a></li><li><a href="#uninstall-jetty-agent">6.4. Removing Jetty Policy Agent Software</a></li></ul></li><li><a href="#chap-weblogic">7. Installing the Oracle WebLogic Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-weblogic-agent-install">7.1. Before You Install</a></li><li><a href="#install-weblogic-agent">7.2. Installing the WebLogic Policy Agent</a></li><li><a href="#silent-weblogic-agent-installation">7.3. Silent WebLogic Policy Agent Installation</a></li><li><a href="#post-weblogic-agent-installation">7.4. Post Installation of WebLogic Policy Agent</a></li><li><a href="#uninstall-weblogic-agent">7.5. Removing WebLogic Policy Agent Software</a></li></ul></li><li><a href="#chap-websphere">8. Installing the IBM WebSphere Policy Agent</a><ul class="nav nav-stacked"><li><a href="#before-websphere-agent-install">8.1. Before You Install</a></li><li><a href="#install-websphere-agent">8.2. Installing the WebSphere Policy Agent</a></li><li><a href="#silent-websphere-agent-installation">8.3. Silent WebSphere Policy Agent Installation</a></li><li><a href="#uninstall-websphere-agent">8.4. Removing WebSphere Policy Agent Software</a></li><li><a href="#websphere-network-deployment">8.5. Notes About WebSphere Network Deployment</a></li></ul></li><li><a href="#chap-troubleshooting">9. Troubleshooting</a></li><li><a href="#d0e3033">Index</a></li></ul></div></div><div id="doc-content" class="col-sm-9"><div class="titlepage modal fade" id="myModal"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">X</span></button><h4 class="modal-title">About this document</h4></div><div class="modal-body"><div><div><h1 class="title">OpenAM Java EE Policy Agent  Installation Guide</h1></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Mark</span> <span class="surname">Craig</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Vanessa</span> <span class="surname">Richie</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Mike</span> <span class="surname">Jang</span></h3></div></div></div><div><p class="releaseinfo"></p></div><div><p class="copyright">Copyright &copy; 2011-2013 ForgeRock AS</p></div><div><a href="legalnotice.html">Legal Notice</a></div><div><p class="pubdate">Publication date: July&nbsp;05,&nbsp;2024</p></div><div><div class="abstract"><div class="abstract-title">Abstract</div><p>Guide to installing OpenAM Java EE policy agents. OpenAM provides open source
   Authentication, Authorization, Entitlement and Federation software.</p></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div><div lang="en" class="preface" id="preface"><div class="titlepage"><div><div><h1 class="title">Preface</h1></div></div></div><p>This guide shows you how to install OpenAM Java EE policy agents, as well as 
 how to integrate with other access management software. Read the 
 <em class="citetitle">Release Notes</em> before you get started.</p><div class="section" id="d0e122"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1.&nbsp;Who Should Use this Guide</h2></div></div></div><p>This guide is written for anyone installing OpenAM policy agents to 
  interface with supported Java EE application containers.</p><p>This guide covers procedures that you theoretically perform only
  once per version. This guide aims to provide you with at least some idea
  of what happens behind the scenes when you perform the steps.</p><p>You do not need to be an OpenAM wizard to learn something from
  this guide, though a background in access management and maintaining
  web application software can help. You do need some background in
  managing services on your operating systems and in your application
  servers. You can nevertheless get started with this guide, and then
  learn more as you go along.</p></div><div lang="en" class="section" id="formatting-conventions"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.&nbsp;Formatting Conventions</h2></div></div></div><p>
  Most examples in the documentation are created in GNU/Linux or Mac OS X
  operating environments.

  If distinctions are necessary between operating environments,
  examples are labeled with the operating environment name in parentheses.

  To avoid repetition file system directory names are often given
  only in UNIX format as in <code class="filename">/path/to/server</code>,
  even if the text applies to <code class="filename">C:\path\to\server</code> as well.
 </p><p>
  Absolute path names usually begin with the placeholder
  <code class="filename">/path/to/</code>.

  This path might translate to <code class="filename">/opt/</code>,
  <code class="filename">C:\Program Files\</code>, or somewhere else on your system.
 </p><p>
  Command line, terminal sessions are formatted as follows:
 </p><pre class="cmdline prettyprint">$ <strong>echo $JAVA_HOME</strong>
<em>/path/to/jdk</em></pre><p>
  Command output is sometimes formatted for narrower, more readable output
  even though formatting parameters are not shown in the command.
  In the following example,
  the query string parameter <code class="literal">_prettyPrint=true</code> is omitted
  and some of the output is replaced with an ellipsis (<code class="literal">...</code>):
 </p><pre class="cmdline prettyprint">
$ <strong>curl https://bjensen:hifalutin@opendj.example.com:8443/users/newuser</strong>
<em>{
  "_rev" : "000000005b337348",
  "_id" : "newuser",
  ...
}</em>
 </pre><p>
  Program listings are formatted as follows:
 </p><pre class="codelisting prettyprint linenums lang-java">
class Test {
    public static void main(String [] args)  {
        System.out.println("This is a program listing.");
    }
}
 </pre></div><div lang="en" class="section" id="accessing-doc-online"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3.&nbsp;Accessing Documentation Online</h2></div></div></div><p>
  Open Identity Platform core documentation, such as this document, aims to be
  technically accurate and complete with respect to the software documented.
 </p><div class="itemizedlist"><p>
   Core documentation therefore follows a three-phase review process
   designed to eliminate errors:
  </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
    Product managers and software architects review project documentation design
    with respect to the readers' software lifecycle needs.
   </p></li><li class="listitem"><p>
    Subject matter experts review proposed documentation changes for
    technical accuracy and completeness
    with respect to the corresponding software.
   </p></li><li class="listitem"><p>
    Quality experts validate implemented documentation changes
    for technical accuracy, completeness in scope,
    and usability for the readership.
   </p></li></ul></div><p>
  The review process helps to ensure that documentation published for
  a ForgeRock release is technically accurate and complete.
 </p><p>
  Fully reviewed, published core documentation is available at
  <a class="link" href="https://www.openidentityplatform.org/" target="_blank">https://www.openidentityplatform.org/</a>.
  Use this documentation when working with a ForgeRock Enterprise release.
 </p><p>
  You can find pre-release draft documentation at the online
  <a class="link" href="https://github.com/OpenIdentityPlatform" target="_blank">community resource center</a>.
  Use this documentation when trying a nightly build.
 </p></div><div lang="en" class="section" id="joining-the-community"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.&nbsp;Joining the Open Identity Platform Community</h2></div></div></div><p>
  Visit the
  <a class="link" href="https://github.com/OpenIdentityPlatform" target="_blank">community resource center</a>
  where you can find information about each project,
  download nightly builds, browse the resource catalog,
  ask and answer questions on the forums, find community events near you,
  and of course get the source code as well.
 </p></div></div><div lang="en" class="chapter" id="chap-about-jee-agents"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;1.&nbsp;About OpenAM Java EE Policy Agents</h1></div></div></div><p>OpenAM Java EE policy agents provide medium touch integration for
 web applications running in supported web application containers. Java EE
 policy agents require some configuration and code changes to deployed web
 applications. This chapter covers what Java EE policy agents do and how they
 work.</p><p>A <em class="firstterm">policy agent</em> enforces policy for OpenAM. A
 <em class="firstterm">J2EE policy agent</em> installed in a web application
 container intercepts requests from users trying to access resources in
 protected web applications. The agent denies access until the user has
 authorization from OpenAM to access a particular resource.</p><div class="section" id="example-j2ee-agent-interaction"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1.1.&nbsp;How the User, Application, Policy Agent, &amp; OpenAM Interact</h2></div></div></div><p>Imagine that a user attempts to access a protected resource before
  having authenticated by pointing her browser to a page in a protected
  application. Assume that you have configured OpenAM to protect the web
  application. You have therefore installed the J2EE agent in the web container,
  and also configured the protected web application to use the agent filter,
  thus sending requests through the agent. Then the J2EE policy agent
  intercepting her filtered browser's request finds no session token in the
  request, and so redirects the user's browser to the OpenAM login page for
  authentication. After the user has successfully authenticated, OpenAM
  sets a session token in a browser cookie, and redirects her browser back to
  the page she tried to access initially.</p><p>When the user's browser reiterates the request, the policy agent again
  checks that the request has a session token, finds a session token this
  time, and validates the session token with OpenAM. Given the valid session
  token, the policy agent gets a policy decision from OpenAM concerning whether
  the user can access the page. If OpenAM's Policy Service determines that
  the user is allowed to access the page, OpenAM responds to the policy agent
  that access should be granted. The J2EE policy agent then permits the page
  to be returned to the user's browser.</p><p>You can also configure J2EE agent filters to work in tandem with
  the J2EE security policies defined alongside the policies for OpenAM. In this
  case the filter ensures the J2EE security policy grants access to the
  resource before the agent gets a decision from OpenAM.</p><p>The following diagram shows how the pieces fit together when a Java
  EE client accesses a resource protected by a policy agent. This diagram is
  simplified to show only the essential principals rather than to describe
  every possible case.</p><div class="mediaobject" align="center" id="figure-jee-pa-overview"><a class="fancybox" href="images/jee-pa-overview.png"><img class="img-responsive center-block" data-toggle="tooltip" src="images/thumb_jee-pa-overview.png" align="middle" alt="Diagram of Java EE policy agent use" title="The interaction happens as described in the following list."></a></div><div class="orderedlist"><p>A Java EE policy agent is a web application installed in the web
   application container. Other applications have filters configured to
   call the policy agent when a client requests access to a protected resource
   in the application.</p><ol class="orderedlist" type="1"><li class="listitem"><p>The web client requests access to a protected resource.</p></li><li class="listitem"><p>The web application filter settings put the request through the
    policy agent that protects the resource according to OpenAM policy. The
    policy agent acts to enforce policy, whereas the policy configuration and
    decisions are handled by OpenAM.</p></li><li class="listitem"><p>The policy agent communicates with OpenAM to get the policy
    decision to enforce.</p></li><li class="listitem"><p>For a resource to which OpenAM approves access, the policy agent
    allows access.</p></li><li class="listitem"><p>The web application returns the requested access to the web
    client.</p></li></ol></div></div><div class="section" id="j2ee-agent-configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1.2.&nbsp;How J2EE Policy Agents are Configured</h2></div></div></div><p>You install J2EE policy agents in the web application containers
  serving web applications that you want to protect. J2EE policy agents are
  themselves web applications running in the container whose applications you
  configure OpenAM to protect. By default, the J2EE policy agent has only
  enough configuration at installation time to connect to OpenAM in order to
  get the rest of its configuration from the OpenAM configuration store. With
  nearly all configuration stored centrally, you can manage policy agents
  centrally from the OpenAM console.<a href="#ftn.d0e277" class="footnote"><sup class="footnote" id="d0e277">[1]</sup></a></p><p>For each web application that you protect, you also configure at least
  the deployment descriptor to filter requests through the policy agent.
  ForgeRock delivers the J2EE policy agents with a sample application under
  <code class="filename">j2ee_agents/<em class="replaceable"><code>container</code></em>_agent/sampleapp/</code>
  demonstrating the configuration to use to protect your web application.</p><p>You configure J2EE policy agents per OpenAM realm. Thus to access
  centralized configuration, you select Access Control &gt; <em class="replaceable"><code>Realm
  Name</code></em> &gt; Agents &gt; J2EE &gt; <em class="replaceable"><code>Agent
  Name</code></em>. J2EE policy agent configuration is distinct from
  policy configuration. The only policy-like configuration that you apply to
  J2EE policy agents is indicating which URLs in the web server can be
  ignored (<em class="firstterm">not enforced URLs</em>) and which client IP
  address are exempt from policy enforcement (<em class="firstterm">not enforced
  IPs</em>).</p><p>For each aspect of J2EE policy agent configuration, you can configure
  the policy agent through the OpenAM console during testing, and then
  export the resulting configuration in order to script configuration in
  your production environment.</p></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d0e277" class="footnote"><p><a href="#d0e277" class="para"><sup class="para">[1] </sup></a>You can opt to store the
  agent configuration locally if necessary.</p></div></div></div><div lang="en" class="chapter" id="chap-apache-tomcat"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;2.&nbsp;Installing the Apache Tomcat Policy Agent</h1></div></div></div><a class="indexterm" name="d0e308"></a><p>This chapter covers installation of the policy agent for Apache
 Tomcat.</p><div class="section" id="before-tomcat-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install Apache Tomcat before you install the policy
  agent, and you must stop the server during installation.</p><p>All of the Tomcat scripts must be present in
  <code class="filename">$CATALINA_HOME/bin</code>. The Tomcat Windows executable
  installer does not include the scripts, for example. If the scripts
  are not present in your installation, copy the contents of the
  <code class="filename">bin</code> directory from a .zip download of Tomcat of
  the same version as the one you installed.</p><p>You must install a supported version of the Java runtime environment.
          Please review the <a href="../release-notes/index.html#java-requirements" class="link">
              <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
          of Java, and set the <code class="literal">JAVA_HOME</code> environment
          variable accordingly. The policy agent installer requires Java.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/tomcat_v6_agent</code> directory.</p><p>Despite the directory name, <code class="filename">/path/to/j2ee_agents/tomcat_v6_agent</code>,
   the policy agent supports .</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">data</code></span></dt><dd><p>Not used</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Configuration templates used during installation</p></dd><dt><span class="term"><code class="filename">installer-logs</code></span></dt><dd><p>Location for log files written during installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div><p>The <code class="filename">web.xml</code> file is the basic Java configuration file for web
  applications. As such, you may find significantly different versions of this file in
  various directories. For the purpose of installing the Tomcat policy agent, you should be
  concerned with the Tomcat <code class="filename">web.xml</code> file, which you can find in the
  <code class="filename">/path/to/tomcat/conf</code> directory, along with the <code class="filename">web.xml</code>
  file associated with the actual web application. This section refers to a sample Web application
  <code class="filename">web.xml</code> file in the <code class="filename">/path/to/j2ee_agents/tomcat_v6_agent/sampleapp/etc</code>
  directory.</p></div><div class="section" id="install-tomcat-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.2.&nbsp;Installing the Tomcat Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#create-tomcat-agent-profile" title="Procedure&nbsp;2.1.&nbsp;To Create the Tomcat Agent Profile">Procedure&nbsp;2.1, &#8220;To Create the Tomcat Agent Profile&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#create-tomcat-agent-pwdfile" title="Procedure&nbsp;2.2.&nbsp;To Create the Password File">Procedure&nbsp;2.2, &#8220;To Create the Password File&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#install-agent-into-tomcat6" title="Procedure&nbsp;2.3.&nbsp;To Install the Policy Agent into Tomcat 6">Procedure&nbsp;2.3, &#8220;To Install the Policy Agent into Tomcat 6&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#install-agent-into-tomcat7" title="Procedure&nbsp;2.4.&nbsp;To Install the Policy Agent into Tomcat 7">Procedure&nbsp;2.4, &#8220;To Install the Policy Agent into Tomcat 7&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#check-tomcat-agent-installation" title="Procedure&nbsp;2.5.&nbsp;To Check the Policy Agent Installation">Procedure&nbsp;2.5, &#8220;To Check the Policy Agent Installation&#8221;</a></p></li></ul></div><div class="procedure" id="create-tomcat-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;2.1.&nbsp;To Create the Tomcat Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE application that the agent protects</p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-tomcat-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;2.2.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent-into-tomcat6"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;2.3.&nbsp;To Install the Policy Agent into Tomcat 6</div><p>The steps required for policy agent installation into Tomcat 6 are subtly different from those
     required for Tomcat 7. For Tomcat 6, you should include the associated global <code class="filename">web.xml</code>
     file during the installation process, and do not need to include the agent application war archive,
     <code class="filename">agentapp.war</code>.</p><ol class="procedure" type="1"><li class="step"><p>Shut down the Tomcat server where you plan to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/tomcat/bin/shutdown.sh</pre></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent. For Tomcat 6,
          do accept the option to install the global <code class="filename">web.xml</code> filter.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/tomcat_v6_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
Tomcat Server Config Directory : /path/to/tomcat/conf
OpenAM server URL : http://openam.example.com:8080/openam
$CATALINA_HOME environment variable : /path/to/tomcat
Tomcat global web.xml filter install : true
Agent URL : http://www.example.com:8080/agentapp
Agent Profile name : Tomcat Agent
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/config/

Agent Configuration file location
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/config/

Agent Audit directory location:
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/logs/debug

Install log file location:
/path/to/j2ee_agents/tomcat_v6_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has added the agent
              configuration to the Tomcat 6 configuration, and also set up configuration
              and log directories for the agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to
              <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
              Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
              numbered configuration and logs directory. The first agent's configuration
              and logs are thus located under the directory
              <code class="filename">j2ee_agents/tomcat_v6_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
                          connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
                          configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
                          to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the <code class="filename">debug.out</code> debug
                          file resides. Useful in troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
              then you must edit config/ to identify
              the sub-realm that has your policy agent configuration.
              Find com.sun.identity.agents.config.organization.name and change
              the / to the path to your policy agent profile. This allows the policy agent
              to properly identify itself to the OpenAM server. </p></li><li class="step"><p>Start the Tomcat server where you installed the agent.</p><pre class="cmdline prettyprint">$ /path/to/tomcat/bin/startup.sh</pre></li></ol></div></div><div class="procedure" id="install-agent-into-tomcat7"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;2.4.&nbsp;To Install the Policy Agent into Tomcat 7</div><p>The steps required for policy agent installation into Tomcat 7 are subtly different from those
   required for Tomcat 6. For Tomcat 7, you should not install the global <code class="filename">web.xml</code>
   file, but configure the application-specific <code class="filename">web.xml</code> file
   after basic installation is complete. You will also need to include the
   agent application war archive, <code class="filename">agentappp.war</code>.</p><ol class="procedure" type="1"><li class="step"><p>Shut down the Tomcat server where you plan to install the
    agent.</p><pre class="cmdline prettyprint">$ /path/to/tomcat/bin/shutdown.sh</pre></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/tomcat_v6_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
Tomcat Server Config Directory : /path/to/tomcat/conf
OpenAM server URL : http://openam.example.com:8080/openam
$CATALINA_HOME environment variable : /path/to/tomcat
Tomcat global web.xml filter install : false
Agent URL : http://www.example.com:8080/agentapp
Agent Profile name : Tomcat Agent
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/tomcat_v6_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/tomcat_v6_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has added the agent
    configuration to Tomcat's configuration, and also set up configuration
    and log directories for the agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to
     <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link">
   <em class="citetitle">Configuring Cross-Domain Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/tomcat_v6_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the <code class="filename">debug.out</code> debug
       file resides. Useful in troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the path to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>Since you did not install a global filter in the Tomcat 7
    <code class="filename">web.xml</code>, then you must add the filter
    manually for each protected application's <code class="filename">web.xml</code>
    configuration, following the opening &lt;web-app&gt; tag. The file for  
    the sample application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/tomcat_v6_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre></li><li class="step"><p>Add the agent application web archive to Tomcat's webapps.</p><p>$ cp /path/to/j2ee_agents/tomcat_v6_agent/etc/agentapp.war
 /path/to/tomcat/webapps/</p></li><li class="step"><p>Start the Tomcat server where you installed the agent.</p><pre class="cmdline prettyprint">$ /path/to/tomcat/bin/startup.sh</pre></li></ol></div></div><div class="procedure" id="check-tomcat-agent-installation"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;2.5.&nbsp;To Check the Policy Agent Installation</div><ol class="procedure" type="1"><li class="step"><p>Check the Tomcat server log after you start the server to make
    sure startup completed successfully.</p><pre class="cmdline prettyprint">$ tail -n 1 /path/to/tomcat/logs/catalina.out
INFO: Server startup in 810 ms</pre></li><li class="step"><p>Check the <code class="filename">debug.out</code> debug log to verify that
    the agent did start up.</p><pre class="cmdline prettyprint">$ tail -n 7 /path/to/j2ee_agents/tomcat_v6_agent/Agent_001/logs/debug/debug.out
=======================================
Version: ...
Revision: 3111
Build Date: 20120915
Build Machine: builds.forgerock.org
=======================================

</pre></li><li class="step"><p>If you have a policy configured, you can test your policy agent.
    For example, try to browse to a resource that your policy agent protects.
    You should be redirected to OpenAM to authenticate, for example as user
    <code class="literal">demo</code>, password <code class="literal">changeit</code>. After
    you authenticate, OpenAM then redirects you back to the resource you tried
    to access.</p></li></ol></div></div></div><div class="section" id="silent-tomcat-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.3.&nbsp;Silent Tomcat Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="uninstall-tomcat-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.4.&nbsp;Remove Tomcat Policy Agent Software</h2></div></div></div><p>Shut down the Tomcat server before you uninstall the
    policy agent.</p><pre class="cmdline prettyprint">$ /path/to/tomcat/bin/shutdown.sh</pre><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the Tomcat server configuration
  directory location.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from Tomcat.</p></div></div><div lang="en" class="chapter" id="chap-glassfish"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;3.&nbsp;Installing the GlassFish Policy Agent</h1></div></div></div><a class="indexterm" name="d0e793"></a><p>This chapter covers installation of the policy agent for GlassFish.</p><div class="section" id="before-glassfish-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install GlassFish before you install the policy agent, and you
  must stop the domain with applications to protect during installation. Policy
  agents support .</p><p>You must install a supported version of the Java runtime environment.
          Please review the <a href="../release-notes/index.html#java-requirements" class="link">
              <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
          of Java, and set the <code class="literal">JAVA_HOME</code> environment
          variable accordingly.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/appserver_v10_agent</code> directory.</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">data</code></span></dt><dd><p>Not used</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Agent web application used during installation</p></dd><dt><span class="term"><code class="filename">installer-logs</code></span></dt><dd><p>Location for log files written during installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div></div><div class="section" id="install-glassfish-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3.2.&nbsp;Installing the GlassFish Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="procedure" id="create-glassfish-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;3.1.&nbsp;To Create the GlassFish Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE agent application, such as
       <code class="literal">http://www.example.com:8080/agentapp</code></p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-glassfish-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;3.2.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent-into-glassfish"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;3.3.&nbsp;To Install the Policy Agent into GlassFish</div><ol class="procedure" type="1"><li class="step"><p>Shut down the GlassFish domain where you plan to install the
    agent.</p><pre class="cmdline prettyprint">$ /path/to/glassfish/bin/asadmin stop-domain domain1
Waiting for the domain to stop ....
Command stop-domain executed successfully.</pre></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/appserver_v10_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
Application Server Config Directory :
/path/to/glassfish/glassfish/domains/domain1/config
Application Server Instance name : server
OpenAM server URL : http://openam.example.com:8080/openam
Agent URL : http://www.example.com:8080/agentapp
Agent Profile name : GlassFish Agent
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/appserver_v10_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/appserver_v10_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/appserver_v10_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/appserver_v10_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/appserver_v10_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has updated the GlassFish
    configuration, and also set up configuration and log directories for the
    agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
   Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/appserver_v10_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the debug file resides. Useful in
       troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the path to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>To protect a web application, you must add the following filter
    to the application's <code class="filename">web.xml</code> configuration,
    following the opening &lt;web-app&gt; tag. The file for the sample 
    application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/appserver_v10_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre><p>Applications without the filter configuration are not protected by
    the policy agent. For example, if you add the filter for a particular
    application but not for the root context, then the root context is not
    protected by the policy agent.</p></li><li class="step"><p>Start the GlassFish domain where you installed the agent.</p><pre class="cmdline prettyprint">$ /path/to/glassfish/bin/asadmin start-domain domain1
Waiting for domain1 to start .....
Successfully started the domain : domain1
domain  Location: /path/to/glassfish/glassfish/domains/domain1
Log File: /path/to/glassfish/glassfish/domains/domain1/logs/server.log
Admin Port: 4848
Command start-domain executed successfully.</pre></li><li class="step"><p>Deploy the agent web application.</p><pre class="cmdline prettyprint">cd /path/to/glassfish/glassfish/bin/asadmin
    $ deploy --name agentapp --contextroot /agentapp
 /path/to/j2ee_agents/appserver_v10_agent/etc/agentapp.war</pre></li><li class="step"><p>Check your work by quickly deploying the sample application,
    <code class="filename">/path/to/j2ee_agents/appserver_v10_agent/sampleapp/dist/agentsample.ear</code>
    through the GlassFish administration console, and verifying that the agent
    redirects to OpenAM for authentication and that access is denied after
    successful login to OpenAM. (Access is denied because when no policy exists
    for a protected resource the default decision for OpenAM is to deny all
    access.)</p></li></ol></div></div></div><div class="section" id="silent-glassfish-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3.3.&nbsp;Silent GlassFish Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="uninstall-glassfish-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3.4.&nbsp;Removing GlassFish Policy Agent Software</h2></div></div></div><p>Shut down the GlassFish domain before you uninstall the
    policy agent.</p><pre class="cmdline prettyprint">$ /path/to/glassfish/bin/asadmin stop-domain domain1
    Waiting for the domain to stop ....
    Command stop-domain executed successfully.</pre><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the GlassFish configuration directory
  location, and the instance name.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from GlassFish.</p></div></div><div lang="en" class="chapter" id="chap-jboss-4and5"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;4.&nbsp;Installing the JBoss 4 and 5 Application Server Policy Agent</h1></div></div></div><a class="indexterm" name="d0e1106"></a><p>This chapter covers installation of the policy agent for JBoss
 Application Server.</p><div class="section" id="before-jboss4and5-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install JBoss before installing the policy agent.</p><p>You must install a supported version of the Java runtime environment.
  Please review the <a href="../release-notes/index.html#java-requirements" class="link">
  <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
  of Java, and set the <code class="literal">JAVA_HOME</code> environment variable accordingly.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/jboss_v42_agent</code> directory.</p><p>Despite the directory name, the policy agent supports
   .</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">data</code></span></dt><dd><p>Not used</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Agent web application and configuration templates used during
     installation</p></dd><dt><span class="term"><code class="filename">installer-logs</code></span></dt><dd><p>Location for log files written during installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div></div><div class="section" id="install-jboss4and5-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.2.&nbsp;Installing the JBoss Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="procedure" id="create-jboss4and5-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;4.1.&nbsp;To Create the JBoss Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE agent application, such as
       <code class="literal">http://www.example.com:8080/agentapp</code></p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-jboss4and5-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;4.2.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent4and5-into-jboss"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;4.3.&nbsp;To Install the Policy Agent into JBoss</div><ol class="procedure" type="1"><li class="step"><p>Shut down the JBoss server where you plan to install the
    agent.</p></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/jboss_v42_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
JBoss Server Config Directory : /path/to/jboss/server/default/conf
JBoss Server Home Directory : /path/to/jboss
OpenAM server URL : http://openam.example.com:8080/openam
Agent URL : http://www.example.com:8080/agentapp
Agent Profile name : JBoss Agent
Agent Profile Password file name : /tmp/pwd.txt
Agent permissions gets added to java permissions policy file : false

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/jboss_v42_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/jboss_v42_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/jboss_v42_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/jboss_v42_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/jboss_v42_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has updated the JBoss
    configuration, created a
    <code class="filename">JBOSS_HOME/bin/setAgentClasspathdefault.sh</code> script,
    added the agent web application under
    <code class="filename">JBOSS_HOME/server/default/deploy/</code>, and also set up
    configuration and log directories for the agent. The name of the
    script may vary; for example, if you installed the agent using the
    <code class="filename">/path/to/jboss/server/web/conf</code> configuration directory,
    the script would be named <code class="filename">setAgentClasspathweb.sh</code>.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
   Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/jboss_v42_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the debug file resides. Useful in
       troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the realm to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>To protect a web application, you must add the following filter
    to the application's <code class="filename">web.xml</code> configuration,
    following the opening &lt;web-app&gt; tag. The file for the sample 
    application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/jboss_v42_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre><p>If you are using the J2EE-POLICY or ALL mode, you must also add the following 
    security domain specification to the application's <code class="filename">jboss.xml</code> and
    <code class="filename">jboss-web.xml</code> configuration files. You do not need to
    make this change if you are using the URL_POLICY, NONE, or SSO_ONLY mode.</p><pre class="codelisting prettyprint lang-xml">&lt;security-domain&gt;java:/jaas/AMRealm&lt;/security-domain&gt;</pre></li></ol></div></div><div class="procedure" id="run-jboss-after-agent-installation"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;4.4.&nbsp;To Run JBoss After Agent Installation</div><ol class="procedure" type="1"><li class="step"><p>Adjust the script to set the agent classpath executable.</p><pre class="cmdline prettyprint">$ chmod +x $JBOSS_HOME/bin/setAgentClasspathdefault.sh</pre></li><li class="step"><p>Open the <code class="filename">JBOSS_HOME/bin/run.sh</code> script for
    editing, and locate the following code block.</p><pre class="codelisting prettyprint lang-sh">if [ "x$JBOSS_CLASSPATH" = "x" ]; then
    JBOSS_CLASSPATH="$JBOSS_BOOT_CLASSPATH"
else
    JBOSS_CLASSPATH="$JBOSS_CLASSPATH:$JBOSS_BOOT_CLASSPATH"
fi
if [ "x$JAVAC_JAR_FILE" != "x" ]; then
    JBOSS_CLASSPATH="$JBOSS_CLASSPATH:$JAVAC_JAR_FILE"
fi</pre></li><li class="step"><p>Edit the <code class="filename">JBOSS_HOME/bin/run.sh</code> script
    to set the classpath needed for the agent, by adding these lines after
    the code block you located in the previous step.</p><pre class="codelisting prettyprint lang-sh">if [ -r "$JBOSS_HOME/bin/setAgentClasspathdefault.sh" ]; then 
    . $JBOSS_HOME/bin/setAgentClasspathdefault.sh
fi</pre></li><li class="step"><p>Start the JBoss server where you installed the agent.</p><pre class="cmdline prettyprint">$ cd $JBOSS_HOME ; ./bin/run.sh -b 0.0.0.0
...
16:30:31,172 INFO  [ServerImpl] JBoss ... Started in 1m:44s:759ms</pre></li><li class="step"><p>If you have a policy configured, you can test your policy agent.
    For example, try to browse to a resource that your policy agent protects.
    You should be redirected to OpenAM to authenticate, for example as user
    <code class="literal">demo</code>, password <code class="literal">changeit</code>. After
    you authenticate, OpenAM then redirects you back to the resource you tried
    to access.</p></li></ol></div></div></div><div class="section" id="silent-jboss4and5-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.3.&nbsp;Silent JBoss Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="uninstall4and5-jboss-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.4.&nbsp;Removing JBoss Policy Agent Software</h2></div></div></div><p>Shut down the JBoss server before you uninstall the
    policy agent.</p><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the JBoss configuration directory
  location.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from JBoss.</p></div></div><div lang="en" class="chapter" id="chap-jboss-7"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;5.&nbsp;Installing the JBoss 7 Application Server Policy Agent</h1></div></div></div><a class="indexterm" name="d0e1459"></a><p>This chapter covers installation of the policy agent for JBoss
 Application Server.</p><div class="section" id="before-jboss7-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install JBoss before installing the policy agent.</p><p>You must install a supported version of the Java runtime environment.
  Please review the <a href="../release-notes/index.html#java-requirements" class="link">
  <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
  of Java, and set the <code class="literal">JAVA_HOME</code> environment variable accordingly.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/jboss_v7_agent</code> directory.</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Agent web application and configuration templates used during
     installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div></div><div class="section" id="install-jboss7-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.2.&nbsp;Installing the JBoss Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="procedure" id="create-jboss7-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;5.1.&nbsp;To Create the JBoss Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE agent application, such as
       <code class="literal">http://www.example.com:8080/agentapp</code></p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-jboss7-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;5.2.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent-into-jboss7"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;5.3.&nbsp;To Install the Policy Agent into JBoss</div><ol class="procedure" type="1"><li class="step"><p>Shut down the JBoss server where you plan to install the
    agent.</p></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/jboss_v7_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
JBoss home directory : /path/to/jboss/
JBoss deployment mode: standalone
Install agent as global module: true
OpenAM server URL : http://openam.example.com:8080/openam
Agent URL : http://www.example.com:8080/agentapp
Agent Profile name : JBossAgent
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/jboss_v7_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/jboss_v7_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/jboss_v7_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/jboss_v7_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/jboss_v7_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has updated the JBoss
    configuration, added the agent web application under
    <code class="filename">JBOSS_HOME/server/standalone/deployments</code>, and also set up
    configuration and log directories for the agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
   Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/jboss_v7_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the debug file resides. Useful in
       troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the realm to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>To protect a web application, you must add the following filter
    to the application's <code class="filename">web.xml</code> configuration,
    following the opening &lt;web-app&gt; tag. The file for the sample 
    application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/jboss_v7_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre><p>You must also add the following security domain specification to the
    application's <code class="filename">jboss.xml</code> and
    <code class="filename">jboss-web.xml</code> configuration files.</p><pre class="codelisting prettyprint lang-xml">&lt;security-domain&gt;java:/jaas/AMRealm&lt;/security-domain&gt;</pre></li></ol></div></div><div class="procedure" id="run-jboss7-after-agent-installation"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;5.4.&nbsp;To Run JBoss After Agent Installation</div><ol class="procedure" type="1"><li class="step"><p>Run JBoss.</p></li><li class="step"><p>If you have a policy configured, you can test your policy agent.
    For example, try to browse to a resource that your policy agent protects.
    You should be redirected to OpenAM to authenticate, for example as user
    <code class="literal">demo</code>, password <code class="literal">changeit</code>. After
    you authenticate, OpenAM then redirects you back to the resource you tried
    to access.</p></li></ol></div></div></div><div class="section" id="silent-jboss7-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.3.&nbsp;Silent JBoss Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="uninstall-jboss7-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5.4.&nbsp;Removing JBoss Policy Agent Software</h2></div></div></div><p>Shut down the JBoss server before you uninstall the
    policy agent.</p><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the JBoss configuration directory
  location.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from JBoss.</p></div></div><div lang="en" class="chapter" id="chap-jetty"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;6.&nbsp;Installing the Jetty Server Policy Agent</h1></div></div></div><a class="indexterm" name="d0e1764"></a><p>This chapter covers installation of the policy agent for Jetty.</p><div class="section" id="before-jetty-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install Jetty before you install the policy agent, and you
  must stop the server during installation.</p><p>You must install a supported version of the Java runtime environment.
          Please review the <a href="../release-notes/index.html#java-requirements" class="link">
              <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
          of Java, and set the <code class="literal">JAVA_HOME</code> environment
          variable accordingly.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>Command line examples in this chapter show Jetty accessed remotely. If 
   you are following the examples and have issues accessing Jetty remotely,
    you might have to change the test filter settings in
   <code class="filename">/path/to/jetty/webapps/test/WEB-INF/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml">&lt;filter&gt;
 &lt;filter-name&gt;TestFilter&lt;/filter-name&gt;
 &lt;filter-class&gt;com.acme.TestFilter&lt;/filter-class&gt;
 &lt;init-param&gt;
  &lt;param-name&gt;remote&lt;/param-name&gt;
  &lt;param-value&gt;true&lt;/param-value&gt; &lt;!-- default: false --&gt;
 &lt;/init-param&gt;
&lt;/filter&gt;</pre></div></div><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/jetty_v61_agent</code> directory.</p><p>Despite the directory name, the policy agent supports
   .</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">data</code></span></dt><dd><p>Not used</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Agent web application used during installation</p></dd><dt><span class="term"><code class="filename">installer-logs</code></span></dt><dd><p>Location for log files written during installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div></div><div class="section" id="install-jetty-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6.2.&nbsp;Installing the Jetty Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="procedure" id="create-jetty-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;6.1.&nbsp;To Create the Jetty Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE agent application, such as
       <code class="literal">http://www.example.com:8080/agentapp</code></p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-jetty-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;6.2.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent-into-jetty"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;6.3.&nbsp;To Install the Policy Agent into Jetty</div><ol class="procedure" type="1"><li class="step"><p>Shut down the Jetty server where you plan to install the
    agent.</p></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/jetty_v61_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
Jetty Server Config Directory : /path/to/jetty/etc
OpenAM server URL : http://openam.example.com:8080/openam
Jetty installation directory. : /path/to/jetty
Agent URL : http://www.example.com:8080/agentapp
Agent Profile name : Jetty Agent
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/jetty_v61_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/jetty_v61_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/jetty_v61_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/jetty_v61_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/jetty_v61_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has updated Jetty's
    <code class="filename">start.jar</code> to reference the agent, set up the agent
    web application, and also set up configuration and log directories for the
    agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
   Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/jetty_v61_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the <code class="filename">debug.out</code> debug
       file resides. Useful in troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the path to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>To protect a web application, you must add the following filter
    to the application's <code class="filename">web.xml</code> configuration,
    following the opening &lt;web-app&gt; tag. The file for the sample 
    application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/jetty_v61_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre></li><li class="step"><p>Start the Jetty server where you installed the agent.</p><pre class="cmdline prettyprint">$ cd /path/to/jetty ; java -jar start.jar
...
2011-09-15 12:49:55.469:INFO::Extract file:/path/to/jetty/webapps/agentapp.war
...
2011-09-15 12:50:14.163:INFO::Started SelectChannelConnector@0.0.0.0:8080</pre></li><li class="step"><p>If you have a policy configured, you can test your policy agent.
    For example, try to browse to a resource that your policy agent protects.
    You should be redirected to OpenAM to authenticate, for example as user
    <code class="literal">demo</code>, password <code class="literal">changeit</code>. After
    you authenticate, OpenAM then redirects you back to the resource you tried
    to access.</p></li></ol></div></div></div><div class="section" id="silent-jetty-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6.3.&nbsp;Silent Jetty Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="uninstall-jetty-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6.4.&nbsp;Removing Jetty Policy Agent Software</h2></div></div></div><p>Shut down the Jetty server before you uninstall the
    policy agent.</p><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the Jetty configuration directory
  location.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from Jetty.</p></div></div><div lang="en" class="chapter" id="chap-weblogic"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;7.&nbsp;Installing the Oracle WebLogic Policy Agent</h1></div></div></div><a class="indexterm" name="d0e2085"></a><p>This chapter covers installation of the policy agent for Oracle
 WebLogic.</p><div class="section" id="before-weblogic-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install WebLogic before you install the policy agent, and you
  must stop the server during installation.</p><p>You must install a supported version of the Java runtime environment.
          Please review the <a href="../release-notes/index.html#java-requirements" class="link">
              <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
          of Java, and set the <code class="literal">JAVA_HOME</code> environment
          variable accordingly.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/weblogic_v10_agent</code> directory.</p><p>Despite the directory name, the policy agent supports
   .</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">data</code></span></dt><dd><p>Not used</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Agent web application and startup configuration</p></dd><dt><span class="term"><code class="filename">installer-logs</code></span></dt><dd><p>Location for log files written during installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div></div><div class="section" id="install-weblogic-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.2.&nbsp;Installing the WebLogic Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="procedure" id="create-weblogic-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;7.1.&nbsp;To Create the WebLogic Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE agent application, such as
       <code class="literal">http://www.example.com:8080/agentapp</code></p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-weblogic-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;7.2.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent-into-weblogic"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;7.3.&nbsp;To Install the Policy Agent into WebLogic</div><ol class="procedure" type="1"><li class="step"><p>Shut down the WebLogic server where you plan to install the
    agent.</p></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/weblogic_v10_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
Startup script location :
/path/to/domain/mydomain/bin/startWebLogic.sh
WebLogic Server instance name : AdminServer
WebLogic home directory : /path/to/wlserver
OpenAM server URL : http://openam.example.com:8080/openam
Agent URL : http://www.example.com:7001/agentapp
Agent Profile name : WebLogic Agent
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/weblogic_v10_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/weblogic_v10_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/weblogic_v10_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/weblogic_v10_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/weblogic_v10_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has updated the WebLogic
    configuration, copied the agent libraries to WebLogic's library directory,
    and also set up configuration and log directories for the agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
   Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/weblogic_v10_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the debug file resides. Useful in
       troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the path to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>The agent requires sourcing before it will work properly. There are two 
    ways to source.</p><ul class="stepalternatives">
     <li class="step"><p>Manually source the file containing the policy agent environment settings for 
      WebLogic before starting the application server. </p><pre class="cmdline prettyprint">. /path/to/setAgentEnv_AdminServer.sh</pre></li>
     <li class="step"><p>Or edit the <code class="filename">startWebLogic.sh</code> script to set the sourcing
      needed for the agent, by adding these lines after the code block shown. Add the
      setAgentEnv_AdminServer.sh line to the following location in the file. The drawback 
      to this approach is that it could be overwritten, as noted in the file.</p><pre class="cmdline prettyprint">$ vi /path/to/startWebLogic.sh
 # Any changes to this script may be lost when adding extensions to this configuration.
 DOMAIN_HOME="/opt/Oracle/Middleware/user_projects/domains/base_domain"
  . /path/to/setAgentEnv_AdminServer.sh
 ${DOMAIN_HOME}/bin/startWebLogic.sh $*</pre></li>
    </ul><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the sourcing is not properly set, the following message appears.</p><pre class="cmdline prettyprint">&lt;Error&gt; &lt;HTTP&gt; &lt;cent.example.com&gt; 
 &lt;AdminServer&gt; &lt;[STANDBY] ExecuteThread: '5' for queue: 'weblogic.kernel.Default 
 (self-tuning)'&gt; &lt;&lt;WLS Kernel&gt;&gt; &lt;&gt;&lt;&gt; &lt;&gt; &lt;1360800613441&gt; 
 &lt;BEA-101165&gt; &lt;Could not load user defined filter in web.xml: 
 ServletContext@1761850405[app:agentapp module:agentapp.war path:null 
 spec-version:null] com.sun.identity.agents.filter.AmAgentFilter.
 java.lang.ClassNotFoundException: com.sun.identity.agents.filter.AmAgentFilter</pre></div></div></li><li class="step"><p>Start the WebLogic server.</p></li><li class="step"><p>Configure shutdown classes for the environment.</p><ol type="a" class="substeps"><li class="step"><p>In WebLogic console, browse to Environment &gt; Startup &amp;
      Shutdown Classes.</p></li><li class="step"><p>Click Lock &amp; Edit.</p></li><li class="step"><p>Click New.</p></li><li class="step"><p>Select the Shutdown Class option, and then click Next.</p></li><li class="step"><p>Provide the Name <code class="literal">Agent</code>, and the Class Name
      <code class="literal">org.forgerock.agents.weblogic.v10.lifecycle.ShutdownListener</code>.</p></li><li class="step"><p>Select the appropriate targets to call the shutdown class once per
      Java Virtual Machine, and then click Finish.</p></li><li class="step"><p>Click Activate Changes.</p></li></ol></li></ol></div></div><div class="procedure" id="protect-weblogic-apps-after-agent-installation"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;7.4.&nbsp;To Protect Applications After Agent Installation</div><ol class="procedure" type="1"><li class="step"><p>Deploy the
    <code class="filename">/path/to/j2ee_agents/weblogic_v10_agent/etc/agentapp.war</code>
    agent application in WebLogic.</p></li><li class="step"><p>For each web application to protect, add the following filter
    to the application's <code class="filename">web.xml</code> configuration,
    following the opening &lt;web-app&gt; tag. The file for the sample 
    application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/weblogic_v10_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre><p>You might also have to update additional configuration files. See
    the sample application located under
    <code class="filename">/path/to/j2ee_agents/weblogic_v10_agent/sampleapp</code>
    for examples.</p></li><li class="step"><p>If you have a policy configured, you can test your policy agent.
    For example, try to browse to a resource that your policy agent protects.
    You should be redirected to OpenAM to authenticate, for example as user
    <code class="literal">demo</code>, password <code class="literal">changeit</code>. After
    you authenticate, OpenAM then redirects you back to the resource you tried
    to access.</p></li></ol></div></div></div><div class="section" id="silent-weblogic-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.3.&nbsp;Silent WebLogic Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="post-weblogic-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.4.&nbsp;Post Installation of WebLogic Policy Agent</h2></div></div></div><p>After installing WebLogic, some configuration is required before
  the policy agent will work.</p><div class="procedure" id="configure-weblogic-agent"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;7.5.&nbsp;To Configure the WebLogic Policy Agent</div><p>WebLogic is unique in that it requires additional configuration
   after the installation is complete.</p><ol class="procedure" type="1"><li class="step"><p>Go to the WebLogic Server Administratotion Console and login.</p></li><li class="step"><p>Click <code class="literal">Security realms</code>.</p></li><li class="step"><p>Click the name of the realm to use for OpenAM.</p></li><li class="step"><p>Click <code class="literal">Providers</code> &gt; <code class="literal">Authentication</code>.</p></li><li class="step"><p>Click <code class="literal">Lock &amp; Edit</code> &gt; <code class="literal">New</code>.</p></li><li class="step"><p>Enter the desired type in <code class="literal">Type as AgentAuthenticator</code>,
    provide a name, and click <code class="literal">OK</code>.</p></li><li class="step"><p>Click on the name of the agent authenticator you just created.</p></li><li class="step"><p>Use <code class="literal">OPTIONAL</code> for the control flag and save.</p></li><li class="step"><p>Click on <code class="literal">Providers</code> to display the Authentication
    Providers Table.</p></li><li class="step"><p>Click on <code class="literal">Default Authenticator</code>, use <code class="literal">OPTIONAL</code>
    for the control flag, and save.</p></li><li class="step"><p>Activate the changes once the default authenticator is done saving.</p><p>You will need to restart the WebLogic Server to implement the changes.</p></li></ol></div></div></div><div class="section" id="uninstall-weblogic-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.5.&nbsp;Removing WebLogic Policy Agent Software</h2></div></div></div><p>Shut down the WebLogic server before you uninstall the
    policy agent.</p><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the WebLogic configuration directory
  location.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from WebLogic.</p></div></div><div lang="en" class="chapter" id="chap-websphere"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;8.&nbsp;Installing the IBM WebSphere Policy Agent</h1></div></div></div><a class="indexterm" name="d0e2539"></a><p>This chapter covers installation of the policy agent for IBM
 WebSphere.</p><div class="section" id="before-websphere-agent-install"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.1.&nbsp;Before You Install</h2></div></div></div><p>Make sure OpenAM is installed and running, and that you can contact OpenAM
  from the system running the policy agent. Next, create a profile for your
  policy agent as described in the <em class="citetitle">Administration Guide</em>
  section on <a href="../admin-guide/index.html#create-agent-profiles" class="link"><em class="citetitle">Creating Agent
  Profiles</em></a>. To protect resources with the agent also create
  at least one policy as described in the section on <a href="../admin-guide/index.html#configure-authz-policy" class="link"><em class="citetitle">Configuring
  Policies</em></a>. Consider creating a simple policy, such as a
  policy that allows only authenticated users to access your resources, in order
  to test your policy agent after installation.</p><p>You must install WebSphere before you install the policy agent, and you
  must stop the server during installation.</p><p>You must install a supported version of the Java runtime environment.
          Please review the <a href="../release-notes/index.html#java-requirements" class="link">
              <em class="citetitle">OpenAM Release Notes</em></a> for the currently supported version
          of Java, and set the <code class="literal">JAVA_HOME</code> environment
          variable accordingly.</p><pre class="cmdline prettyprint">$ echo $JAVA_HOME
/path/to/java
$ which java
/usr/bin/java</pre><p>If you are using IBM Java, see <a class="xref" href="#install-with-ibm-jvm" title="Procedure&nbsp;8.1.&nbsp;To Install With IBM Java">Procedure&nbsp;8.1, &#8220;To Install With IBM Java&#8221;</a>.</p><p>Go to <a href="../install-guide/index.html#download-openam-software" class="link"><em class="citetitle">Obtaining OpenAM Software</em></a>
  to determine which version of the agent to download and download the agent.
  Also verify the checksum of the file you download against the checksum
  posted on the download page.</p><p>Unzip the file in the directory where you plan to install the J2EE
  policy agent. The agent you install stores its configuration and logs
  under this directory.</p><div class="variablelist"><p>When you unzip the policy agent, you find the following directories
   under the <code class="filename">j2ee_agents/websphere_v61_agent</code> directory.</p><p>Despite the directory name, the policy agent supports
   .</p><dl class="variablelist"><dt><span class="term"><code class="filename">bin</code></span></dt><dd><p>The installation and configuration program,
     <span class="command"><strong>agentadmin</strong></span>.</p></dd><dt><span class="term"><code class="filename">config</code></span></dt><dd><p>Configuration templates used by the <span class="command"><strong>agentadmin</strong></span>
     command during installation</p></dd><dt><span class="term"><code class="filename">data</code></span></dt><dd><p>Not used</p></dd><dt><span class="term"><code class="filename">etc</code></span></dt><dd><p>Agent web application that handles notifications and Cross
     Domain SSO</p></dd><dt><span class="term"><code class="filename">installer-logs</code></span></dt><dd><p>Location for log files written during installation</p></dd><dt><span class="term"><code class="filename">lib</code></span></dt><dd><p>Shared libraries used by the J2EE policy agent</p></dd><dt><span class="term"><code class="filename">locale</code></span></dt><dd><p>Property files used by the installation program</p></dd><dt><span class="term"><code class="filename">sampleapp</code></span></dt><dd><p>Sample application that demonstrates key features of the policy
     agent. Wait until you have installed the agent to deploy this.</p></dd></dl></div><div class="procedure" id="install-with-ibm-jvm"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;8.1.&nbsp;To Install With IBM Java</div><p>The WebSphere policy agent runs with IBM Java. In order to install
   the policy agent using IBM Java on platforms other than AIX, you must first
   change the <span class="command"><strong>agentadmin</strong></span> script to use IBMJCE.</p><ol class="procedure" type="1"><li class="step"><p>Open the file, <code class="filename">bin/agentadmin</code>
    (<code class="filename">bin/agentadmin.bat</code> on Windows), for editing.</p></li><li class="step"><p>Edit the line specifying <code class="literal">AGENT_OPTS</code> on platforms
    other than AIX.</p><pre class="literallayout">AGENT_OPTS="-DamKeyGenDescriptor.provider=IBMJCE \
 -DamCryptoDescriptor.provider=IBMJCE -DamRandomGenProvider=IBMJCE"</pre></li><li class="step"><p>Edit the last line to include the IBMJCE settings before the
    classpath is set.</p><pre class="literallayout">$JAVA_VM \
 -DamCryptoDescriptor.provider=IBMJCE -DamKeyGenDescriptor.provider=IBMJCE \
 -classpath "$AGENT_CLASSPATH" $AGENT_OPTS \
 com.sun.identity.install.tools.launch.AdminToolLauncher $*</pre></li><li class="step"><p>Save your work.</p><p>You can now install the WebSphere policy agent with IBM Java as
    described in <a class="xref" href="#install-websphere-agent" title="8.2.&nbsp;Installing the WebSphere Policy Agent">Section&nbsp;8.2, &#8220;Installing the WebSphere Policy Agent&#8221;</a>.</p></li></ol></div></div></div><div class="section" id="install-websphere-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.2.&nbsp;Installing the WebSphere Policy Agent</h2></div></div></div><p>Complete the following procedures to install the policy agent.</p><div class="procedure" id="create-websphere-agent-profile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;8.2.&nbsp;To Create the WebSphere Agent Profile</div><p>Regardless of whether you store configurations centrally in OpenAM
   or locally with your agents, the agent requires a profile so that it can
   connect to and communicate with OpenAM.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE,
    and then click the New... button in the Agent table.</p></li><li class="step"><p>Complete the web form using the following hints.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>The name for the agent profile used when you install the
       agent</p></dd><dt><span class="term">Password</span></dt><dd><p>Password the agent uses to authenticate to OpenAM</p></dd><dt><span class="term">Configuration</span></dt><dd><p>Centralized configurations are stored in the OpenAM configuration
       store. You can manage the centralized configuration through the OpenAM
       console. Local configurations are stored in a file alongside the
       agent.</p></dd><dt><span class="term">Server URL</span></dt><dd><p>The full URL to an OpenAM instance, or if OpenAM is deployed in
       a site configuration (behind a load balancer) then the site URL</p><p>In centralized configuration mode, the Server URL is used to
       populate the agent profile for services such as Login, Logout, Naming,
       and Cross Domain SSO.</p></dd><dt><span class="term">Agent URL</span></dt><dd><p>The URL to the J2EE agent application, such as
       <code class="literal">http://www.example.com:8080/agentapp</code></p><p>In centralized configuration mode, the Agent URL is used to
       populate the Agent Profile for services such as notifications.</p></dd></dl></div></li></ol></div></div><div class="procedure" id="create-websphere-agent-pwdfile"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;8.3.&nbsp;To Create the Password File</div><ol class="procedure" type="1"><li class="step"><p>Create a text file containing only the password.</p><pre class="cmdline prettyprint">$ echo password &gt; /tmp/pwd.txt</pre></li><li class="step"><p>Protect the password file you create as appropriate for your
    operating system.</p><pre class="cmdline prettyprint">$ chmod 400 /tmp/pwd.txt</pre></li></ol></div></div><div class="procedure" id="install-agent-into-websphere"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;8.4.&nbsp;To Install the Policy Agent into WebSphere</div><ol class="procedure" type="1"><li class="step"><p>Shut down the WebSphere server where you plan to install the
    agent.</p></li><li class="step"><p>Make sure OpenAM is running.</p></li><li class="step"><p>Run <span class="command"><strong>agentadmin --install</strong></span> to install the agent.</p><pre class="cmdline prettyprint">$ /path/to/j2ee_agents/websphere_v61_agent/bin/agentadmin --install
...
-----------------------------------------------
SUMMARY OF YOUR RESPONSES
-----------------------------------------------
Instance Config Directory :
/path/to/WebSphere/AppServer/profiles/AppSrv01/config/cells/wwwNode01Cell/
 nodes/wwwNode01/servers/server1

Instance Server name : server1 
WebSphere Install Root Directory : /path/to/WebSphere/AppServer 
OpenAM server URL : http://openam.example.com:8080/openam 
Agent URL : http://www.example.com:9080/agentapp 
Agent Profile name : WebSphere Agent 
Agent Profile Password file name : /tmp/pwd.txt

...
SUMMARY OF AGENT INSTALLATION
-----------------------------
Agent instance name: Agent_001
Agent Bootstrap file location:
/path/to/j2ee_agents/websphere_v61_agent/Agent_001/config/
 
Agent Configuration file location
/path/to/j2ee_agents/websphere_v61_agent/Agent_001/config/
 
Agent Audit directory location:
/path/to/j2ee_agents/websphere_v61_agent/Agent_001/logs/audit
Agent Debug directory location:
/path/to/j2ee_agents/websphere_v61_agent/Agent_001/logs/debug


Install log file location:
/path/to/j2ee_agents/websphere_v61_agent/installer-logs/audit/install.log
...</pre><p>Upon successful completion, the installer has updated the WebSphere
    configuration, copied the agent libraries to WebSphere's external library
    directory, and also set up configuration and log directories for the
    agent.</p><div class="panel panel-info"><div class="panel-heading"><h3 class="panel-title">Note</h3></div><div class="panel-body"><p>If the agent is in a different domain than the server, refer to <em class="citetitle">Administration Guide</em> procedure, <a href="../admin-guide/index.html#chap-cdsso" class="link"><em class="citetitle">Configuring Cross-Domain
   Single Sign On</em></a>.</p></div></div></li><li class="step"><p>Take note of the configuration files and log locations.</p><p>Each agent instance that you install on the system has its own
    numbered configuration and logs directory. The first agent's configuration
    and logs are thus located under the directory
    <code class="filename">j2ee_agents/websphere_v61_agent/Agent_001/</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Used to bootstrap the J2EE policy agent, allowing the agent to
       connect to OpenAM and download its configuration</p></dd><dt><span class="term"><code class="filename">config/</code></span></dt><dd><p>Only used if you configured the J2EE policy agent to use local
       configuration</p></dd><dt><span class="term"><code class="filename">logs/audit/</code></span></dt><dd><p>Operational audit log directory, only used if remote logging
       to OpenAM is disabled</p></dd><dt><span class="term"><code class="filename">logs/debug/</code></span></dt><dd><p>Debug directory where the debug file resides. Useful in
       troubleshooting policy agent issues.</p></dd></dl></div></li><li class="step"><p>If your policy agent configuration is not in the top-level realm (/),
       then you must edit config/ to identify
       the sub-realm that has your policy agent configuration.
       Find com.sun.identity.agents.config.organization.name and change
       the / to the path to your policy agent profile. This allows the policy agent
       to properly identify itself to the OpenAM server. </p></li><li class="step"><p>Restart the WebSphere server.</p></li></ol></div></div><div class="procedure" id="protect-websphere-apps-after-agent-installation"><div class="procedure-inner"><div class="procedure-title">Procedure&nbsp;8.5.&nbsp;To Protect Applications After Agent Installation</div><ol class="procedure" type="1"><li class="step"><p>Deploy the
    <code class="filename">/path/to/j2ee_agents/websphere_v61_agent/etc/agentapp.war</code>
    agent application in WebSphere.</p></li><li class="step"><p>For each web application to protect, add the following filter
    to the application's <code class="filename">web.xml</code> configuration,
    following the opening &lt;web-app&gt; tag. The file for the sample 
    application delivered with the agent is 
    <code class="filename">/path/to/j2ee_agents/websphere_v61_agent/sampleapp/etc/web.xml</code>.</p><pre class="codelisting prettyprint lang-xml"> &lt;filter&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;display-name&gt;Agent&lt;/display-name&gt;
  &lt;description&gt;OpenAM Policy Agent Filter&lt;/description&gt;
 &lt;filter-class&gt;com.sun.identity.agents.filter.AmAgentFilter&lt;/filter-class&gt;
 &lt;/filter&gt;
 &lt;filter-mapping&gt;
  &lt;filter-name&gt;Agent&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
  &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
  &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
  &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
 &lt;/filter-mapping&gt;</pre><p>You might also have to update additional configuration files. See
    the sample application located under
    <code class="filename">/path/to/j2ee_agents/websphere_v61_agent/sampleapp</code>
    for examples.</p></li><li class="step"><p>If you have a policy configured, you can test your policy agent.
    For example, try to browse to a resource that your policy agent protects.
    You should be redirected to OpenAM to authenticate, for example as user
    <code class="literal">demo</code>, password <code class="literal">changeit</code>. After
    you authenticate, OpenAM then redirects you back to the resource you tried
    to access.</p></li></ol></div></div></div><div class="section" id="silent-websphere-agent-installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.3.&nbsp;Silent WebSphere Policy Agent Installation</h2></div></div></div><p>When performing a scripted, silent installation, use
  <span class="command"><strong>agentadmin --install --saveResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>
  to create a response file for scripted installation. Then install silently
  using <span class="command"><strong>agentadmin --install --useResponse
  <em class="replaceable"><code>response-file</code></em></strong></span>.</p></div><div class="section" id="uninstall-websphere-agent"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.4.&nbsp;Removing WebSphere Policy Agent Software</h2></div></div></div><p>Shut down the WebSphere server before you uninstall the
    policy agent.</p><p>To remove the J2EE policy agent, use <span class="command"><strong>agentadmin
  --uninstall</strong></span>. You must provide the WebSphere configuration directory
  location.</p><p>Uninstall does not remove the agent instance directory, but you can
  do so manually after removing the agent configuration from WebSphere.</p></div><div class="section" id="websphere-network-deployment"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.5.&nbsp;Notes About WebSphere Network Deployment</h2></div></div></div><p>When using WebSphere Application Server Network Deployment, you must
  install policy agents on the Deployment Manager, on each Node Agent, and
  on each Application Server. Installation requires that you stop and then
  restart the Deployment Manager, each Node Agent, and each Application Server
  in the Network Deployment.</p><p>Before installation, synchronize each server configuration with the
  profile saved by the Deployment Manager using the <span class="command"><strong>syncNode</strong></span>
  command. After agent installation, copy the server configuration for each
  node, stored in <code class="filename">server.xml</code>, to the corresponding
  Deployment Manager profile. After you have synchronized the configurations,
  you must restart the Deployment Manager for the Network Deployment.</p></div></div><div lang="en" class="chapter" id="chap-troubleshooting"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;9.&nbsp;Troubleshooting</h1></div></div></div><a class="indexterm" name="d0e2912"></a><p>This chapter offers solutions to issues during installation of OpenAM
  policy agents.</p><div class="qandaset" id="solutions-to-common-issues"><h2 class="title">Solutions to Common Issues</h2><p>This section offers solutions to common problems when installing 
   OpenAM policy agents.</p><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%"><col></colgroup><tbody><tr class="question" id="cannot-install-over-https"><td align="left" valign="top" id="d0e2923"><p><b>Q:</b></p></td><td align="left" valign="top"><p>I am trying to install a policy agent, connecting to OpenAM over
    HTTPS, and seeing the following error.</p><pre class="cmdline prettyprint">OpenAM server URL: https://openam.example.com:8443/openam

WARNING: Unable to connect to OpenAM server URL. Please specify the
correct OpenAM server URL by hitting the Back button (&lt;) or if the OpenAM
server URL is not started and you want to start it later, please proceed with
the installation.
If OpenAM server is SSL enabled and the root CA certificate for the OpenAM
server certificate has been not imported into installer JVMs key store (see
installer-logs/debug/Agent.log for detailed exception), import the root
CA certificate and restart the installer; or continue installation without
verifying OpenAM server URL.</pre><p>What should I do?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>The Java platform includes certificates from many Certificate
    Authorities (CAs). If however you run your own CA, or you use self-signed
    certificates for HTTPS on the container where you run OpenAM, then the
    <span class="command"><strong>agentadmin</strong></span> command cannot trust the certificate
    presented during connection to OpenAM, and so cannot complete installation
    correctly.</p><p>After setting up the container where you run OpenAM to use HTTPS,
    get the certificate to trust in a certificate file. The certificate you
    want is the that of the CA who signed the container certificate, or the
    certificate itself if the container certificate is self-signed.</p><p>Copy the certificate file to the system where you plan to install the
    policy agent. Import the certificate into a trust store that you will use
    during policy agent installation. If you import the certificate into the
    default trust store for the Java platform, then the
    <span class="command"><strong>agentadmin</strong></span> command can recognize it without additional
    configuration.</p><p>Export and import of self-signed certificates is demonstrated in the
    <em class="citetitle">Administration Guide</em> chapter on <a href="../admin-guide/index.html#chap-certs-keystores" class="link"><em class="citetitle">Managing
    Certificates</em></a>.</p></td></tr><tr class="question" id="cannot-install-with-ibm-java"><td align="left" valign="top" id="d0e2953"><p><b>Q:</b></p></td><td align="left" valign="top"><p>I am trying to install the WebSphere policy agent on Linux.
    The system has IBM Java. When I run <span class="command"><strong>agentadmin --install</strong></span>,
    the script fails to encrypt the password from the password file, ending
    with this message:</p><pre class="literallayout">ERROR: An unknown error has occurred (null). Please try again.</pre><p>What should I do?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>You must edit <span class="command"><strong>agentadmin</strong></span> to use IBMJCE, and then
    try again.</p><p>See <span class="olink"><em class="citetitle">To Install
    With IBM Java</em></span>.</p></td></tr><tr class="question" id="websphere-SRVE0190E-file-not-found"><td align="left" valign="top" id="d0e2976"><p><b>Q:</b></p></td><td align="left" valign="top"><p>After installing a Java EE policy agent on WebSphere AS 7 or 8,
    accessing a URL for a folder in a protected application such as
    <code class="literal">http://openam.example.com:9080/test/</code> results in
    <code class="literal">Error 404: SRVE0190E: File not found: {0}</code>, and
    redirection fails. What should I do to work around this problem?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>Perform the following steps to work around the problem, by setting
    the WebSphere custom property
    <code class="literal">com.ibm.ws.webcontainer.invokeFiltersCompatibility=true</code>.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In the administration console, browse to Servers &gt; Server Types,
      and then click WebSphere application servers.</p></li><li class="listitem"><p>Click the server for which to apply the custom property.</p></li><li class="listitem"><p>Browse to Configuration &gt; Container settings &gt; Web Container
      Settings &gt; Web container.</p></li><li class="listitem"><p>Under Configuration &gt; Additional Properties, click Custom
      Properties.</p></li><li class="listitem"><p>In the Custom Properties page, click New.</p></li><li class="listitem"><p>In the settings page, enter the Name
      <code class="literal">com.ibm.ws.webcontainer.invokeFiltersCompatibility</code> and
      Value <code class="literal">true</code> for the custom property.</p><p>Some properties are case sensitive.</p></li><li class="listitem"><p>Click Apply or OK as applicable.</p></li><li class="listitem"><p>Click Save in the Message box that appears.</p></li><li class="listitem"><p>Restart the server for the custom property to take effect.</p></li></ol></div><p>See the IBM documentation on <a class="link" href="http://www-01.ibm.com/support/docview.wss?uid=swg21284395" target="_blank"><em class="citetitle">Setting webcontainer custom properties</em></a>
    for additional information.</p></td></tr></tbody></table></div></div><div class="index" id="d0e3033"><div class="titlepage"><div><div><h1 class="title">Index</h1></div></div></div><div xmlns:xlink="http://www.w3.org/1999/xlink" class="index"><div class="indexdiv"><h3>A</h3><dl><dt id="ientry-d0e308">Apache Tomcat Server, <a class="indexterm" href="#chap-apache-tomcat">Installing the Apache Tomcat Policy Agent</a></dt></dl></div><div class="indexdiv"><h3>G</h3><dl><dt id="ientry-d0e793">GlassFish Server, <a class="indexterm" href="#chap-glassfish">Installing the GlassFish Policy Agent</a></dt></dl></div><div class="indexdiv"><h3>I</h3><dl><dt id="ientry-d0e2539">IBM WebSphere Application Server, <a class="indexterm" href="#chap-websphere">Installing the IBM WebSphere Policy Agent</a></dt></dl></div><div class="indexdiv"><h3>J</h3><dl><dt id="ientry-d0e1106">JBoss Application Server, <a class="indexterm" href="#chap-jboss-4and5">Installing the JBoss 4 and 5 Application Server Policy Agent</a>, <a class="indexterm" href="#chap-jboss-7">Installing the JBoss 7 Application Server Policy Agent</a></dt><dt id="ientry-d0e1764">Jetty Server, <a class="indexterm" href="#chap-jetty">Installing the Jetty Server Policy Agent</a></dt></dl></div><div class="indexdiv"><h3>O</h3><dl><dt id="ientry-d0e2085">Oracle WebLogic Server, <a class="indexterm" href="#chap-weblogic">Installing the Oracle WebLogic Policy Agent</a></dt></dl></div><div class="indexdiv"><h3>T</h3><dl><dt id="ientry-d0e2912">Troubleshooting, <a class="indexterm" href="#chap-troubleshooting">Troubleshooting</a></dt></dl></div></div></div></div><a href="#" class="back-to-top hidden-xs"><button type="button" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-chevron-up"></span></button></a></div></div><div class="footer"><div class="container-fluid"><div class="footer-left"><span class="footer-item">Copyright &copy;
              2011-2013&nbsp;
              ForgeRock AS;&nbsp;
              &nbsp;
              &nbsp;
          </span></div><div class="footer-right"><a target="_blank" class="footer-item snap-left" href="legalnotice.html"><i class="glyphicon glyphicon-briefcase"></i> Legal Notice</a><a target="_blank" class="footer-item snap-left" href="https://github.com/OpenIdentityPlatform/OpenAM/issues"><i class="glyphicon glyphicon-ok-sign"></i> Feedback</a><a target="_blank" class="footer-item snap-left" href="#" data-toggle="modal" data-target="#myModal"><i class="glyphicon glyphicon-info-sign"></i> About</a></div></div></div></body></html>