:leveloffset: -1
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>Managing Schema</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="chap-schema">Managing Schema</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to manage Lightweight Directory Access Protocol (LDAP) schema definitions for directory data. In this chapter you will learn to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understand LDAP schemas including the schema definitions delivered with OpenDJ directory server</p>
</li>
<li>
<p>Change and extend OpenDJ LDAP schemas</p>
</li>
<li>
<p>Relax schema checking when troubleshooting data that does not conform to schema definitions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Schema definitions describe the data, and especially the object classes and attribute types that can be stored in the directory. By default OpenDJ conforms strictly to LDAPv3 standards pertaining to schema definitions and attribute syntax checking, ensuring that data stored is valid and properly formed. Unless your data uses only standard schema present in OpenDJ when you install, then you must add additional schema definitions to account for the data your applications stored.</p>
</div>
<div class="paragraph">
<p>OpenDJ comes with many standard schema definitions out of the box. In addition you can update and extend schema definitions while OpenDJ is online. As a result you can add new applications requiring additional data without stopping your directory service.</p>
</div>
<div class="sect2">
<h3 id="about-schema">About Directory Schema</h3>
<div class="paragraph">
<p>Directory schema, described in <a href="http://tools.ietf.org/html/rfc4512" target="\_top">RFC 4512</a>, defines the kinds of information you find in the directory, and can define how the information are related. This chapter focuses primarily on the following types of directory schema definitions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Attribute type</em> definitions describe attributes of directory entries, such as <code>givenName</code> or <code>mail</code>.</p>
<div class="paragraph">
<p>Here is an example of an attribute type definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ldif"># Attribute type definition
attributeTypes: ( 0.9.2342.19200300.100.1.3 NAME ( 'mail' 'rfc822Mailbox' )
  EQUALITY caseIgnoreIA5Match SUBSTR caseIgnoreIA5SubstringsMatch
  SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{256} X-ORIGIN 'RFC 4524' )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attribute type definitions start with an OID, and generally a short name or names that are easier to remember than the OID. The attribute type definition can specify how attribute values should be collated for sorting, and what syntax they use. The X-ORIGIN is an extension to identify where the definition originated. When you define your own schema, you likely want to provide an X-ORIGIN to help you to track versions of definitions, and where the definitions came from.</p>
</div>
</li>
<li>
<p><em>Object class</em> definitions identify the attribute types that an entry must have, and may have. Examples of object classes include <code>person</code> and <code>organizationalUnit</code>.</p>
<div class="paragraph">
<p>Here is an example of an object class definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ldif"># Object class definition
objectClasses: ( 2.5.6.6 NAME 'person' SUP top STRUCTURAL MUST ( sn $ cn )
  MAY ( userPassword $ telephoneNumber $ seeAlso $ description )
  X-ORIGIN 'RFC 4519' )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Entries all have an attribute identifying their object classes, called <code>objectClass</code>.</p>
</div>
<div class="paragraph">
<p>Object class definitions start with an object identifier (OID), and generally a short name that is easier to remember than the OID. The definition here says that the person object class inherits from the top object class, which is the top-level parent of all object classes. An entry&#8217;s <code>objectclass</code> attribute lists the entry&#8217;s object classes. An entry can have one STRUCTURAL object class inheritance branch, such as <code>top</code> - <code>person</code> - <code>organizationalPerson</code> - <code>inetOrgPerson</code>. Yet entries can have multiple AUXILIARY object classes. The object class then defines the attribute types that must be included, and the attribute types that may be included on entries having the object class.</p>
</div>
</li>
<li>
<p>An <em>attribute syntax</em> constrains what directory clients can store as attribute values.</p>
<div class="paragraph">
<p>An attribute syntax is identified in an attribute type definition by its OID. String-based syntax OIDs are optionally followed by a number set between braces that represents a minimum upper bound on the number of characters in the attribute value. For example, in the attribute type definition shown above, the syntax is <code>1.3.6.1.4.1.1466.115.121.1.26{256}</code>. The syntax is an IA5 string (composed of characters from the international version of the ASCII character set) that can contain at least 256 characters.</p>
</div>
<div class="paragraph">
<p>You can find a table matching attribute syntax OIDs with their human-readable names in RFC 4517, <a href="http://tools.ietf.org/html/rfc4517#appendix-A" target="\_blank">Appendix A. Summary of Syntax Object Identifiers</a>. The RFC describes attribute syntaxes in detail. Alternatively, you can see the attribute syntaxes that OpenDJ supports by opening the OpenDJ control panel and browsing to Schema &gt; Manage Schema &gt; Attribute Syntaxes. You can also list them by using the <code>dsconfig</code> command.</p>
</div>
<div class="paragraph">
<p>Although attribute syntaxes are often specified in attribute type definitions, directory servers do not always check that attribute values comply with attribute syntaxes. OpenDJ directory server does tend to enforce compliance by default, in particular for certificates, country strings, directory strings, JPEG photos, and telephone numbers. The aim is to avoid accumulating garbage in your directory data.</p>
</div>
<div class="paragraph">
<p>If you are trying unsuccessfully to import non-compliant data from a more lenient directory server, you can either clean the data before importing it, or if cleaning the data is not an option, read <a href="#schema-legacy-support">"Relaxing Schema Checking to Import Legacy Data"</a>.</p>
</div>
<div class="paragraph">
<p>When creating your own attribute type definitions, use existing attribute syntaxes where possible. If you must create your own attribute syntax, then consider the extensions in <a href="#attr-syntax-schema-definition-extensions">Extensions for Attribute Syntax Descriptions</a>.</p>
</div>
</li>
<li>
<p>Matching rules determine how the directory server compares attribute values to assertion values for LDAP search and LDAP compare operations.</p>
<div class="paragraph">
<p>For example, suppose you search with the filter <code>(uid=bjensen)</code>. The assertion value in this case is <code>bjensen</code>.</p>
</div>
<div class="paragraph">
<p>OpenDJ has the following schema definition for the user ID attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ldif">attributeTypes: ( 0.9.2342.19200300.100.1.1 NAME ( 'uid' 'userid' )
 EQUALITY caseIgnoreMatch SUBSTR caseIgnoreSubstringsMatch
 SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{256} X-ORIGIN 'RFC 4519' )</code></pre>
</div>
</div>
<div class="paragraph">
<p>When finding an equality match for your search, OpenDJ uses the <code>caseIgnoreMatch</code> matching rule to check for user ID attribute values that equal <code>bjensen</code> without regard to case.</p>
</div>
<div class="paragraph">
<p>You can see the matching rules that OpenDJ supports by opening the OpenDJ control panel and browsing to Schema &gt; Manage Schema &gt; Matching Rules. Notice that many matching rules support string collation in languages other than English. You can also list matching rules by using the <code>dsconfig</code> command.</p>
</div>
<div class="paragraph">
<p>As you can read in examples such as <a href="../server-dev-guide/chap-ldap-operations.html#extensible-match-search">"Search: Listing Active Accounts"</a> in the <em>Directory Server Developer&#8217;s Guide</em>, OpenDJ matching rules enable directory clients to compare other values besides strings, for example.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>OpenDJ exposes schema over protocol through the <code>cn=schema</code> entry. OpenDJ stores the schema definitions corresponding to the entry in LDIF under the <code>config/schema/</code> directory. Many standard definitions and definitions pertaining to the server configuration are included at installation time.</p>
</div>
</div>
<div class="sect2">
<h3 id="update-schema">Updating Directory Schema</h3>
<div class="paragraph">
<p>OpenDJ directory server is designed to permit updating the list of directory schema definitions while the server is running. As a result you can add support for new applications that require new attributes or new kinds of entries without interrupting the directory service. OpenDJ also replicates schema definitions, so the schema you add on one replica is propagated to other replicas without the need for manual intervention.</p>
</div>
<div class="paragraph">
<p>As it is easy to introduce typos into schema definitions, the best way to start defining your own schema is with the OpenDJ Control Panel. Open the control panel &gt; Schema &gt; Manage Schema window to get started creating your custom object classes and attribute types.</p>
</div>
<div id="figure-manage-schema" class="imageblock">
<div class="content">
<img src="images/Manage-Schema.png" alt="Manage Schema">
</div>
</div>
<div class="paragraph">
<p>As object classes reference attribute types, you first create custom attribute types, and then create the object class that references the attribute types.</p>
</div>
<div class="paragraph">
<p>Create a custom attribute type through the New Attribute window.</p>
</div>
<div id="figure-custom-attrtype" class="imageblock">
<div class="content">
<img src="images/custom-attrtype.png" alt="custom attrtype">
</div>
</div>
<div class="paragraph">
<p>Using the New Object Class window, create an auxiliary object class that allows your new custom attribute type. You set the type to Auxiliary under Extra Options.</p>
</div>
<div id="figure-custom-objclass" class="imageblock">
<div class="content">
<img src="images/custom-objclass.png" alt="custom objclass">
</div>
</div>
<div class="paragraph">
<p>When you finish, the schema changes show up by default in the file <code>config/schema/99-user.ldif</code>. Notice that the file name starts with a number, 99. This number is larger than the numbers prefixing other schema file names. In fact, OpenDJ reads the schema files in sorted order, reading schema definitions as they occur. If OpenDJ reads a schema definition for an object class before it has read the definitions of the attribute types mentioned in the object class definition, then it displays an error. Therefore, when naming your schema file, make sure the name appears in the sorted list of file names <em>after</em> all the schema files containing definitions that your schema definitions depends on. The default file name for your schema, <code>99-user.ldif</code>, ensures that your definitions load only after all of the schema files installed by default.</p>
</div>
<div class="paragraph">
<p>You can create this file in the lab using the control panel, and then apply the definitions in production by adapting the content for use with the <code>ldapmodify</code> command, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ cat config/schema/99-user.ldif
dn: cn=schema
objectClass: top
objectClass: ldapSubentry
objectClass: subschema
cn: schema
attributeTypes: ( temporary-fake-attr-id NAME 'myCustomAttribute' EQUALITY case
 IgnoreMatch ORDERING caseIgnoreOrderingMatch SUBSTR caseIgnoreSubstrings
 Match SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 USAGE userApplications )
objectClasses: ( temporary-fake-oc-id NAME 'myCustomObjClass
 ' SUP top AUXILIARY MAY myCustomAttribute )
modifiersName: cn=Directory Manager,cn=Root DNs,cn=config
modifyTimestamp: 20110620095948Z</code></pre>
</div>
</div>
<div class="paragraph">
<p>To test your schema definition, add the object class and attribute to an entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ cat custom-attr.ldif
dn: uid=bjensen,ou=People,dc=example,dc=com
changetype: modify
add: objectClass
objectClass: myCustomObjClass
-
add: myCustomAttribute
myCustomAttribute: Testing 1, 2, 3...

$ ldapmodify \
 --port 1389 \
 --bindDN &quot;cn=Directory Manager&quot; \
 --bindPassword password \
 --filename custom-attr.ldif
Processing MODIFY request for uid=bjensen,ou=People,dc=example,dc=com
MODIFY operation successful for DN uid=bjensen,ou=People,dc=example,dc=com

$ ldapsearch \
 --port 1389 \
 --baseDN dc=example,dc=com \
 uid=bjensen \
 myCustomAttribute
dn: uid=bjensen,ou=People,dc=example,dc=com
myCustomAttribute: Testing 1, 2, 3...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to supporting the standard schema definitions that are described in <a href="http://tools.ietf.org/html/rfc4512#section-4.1" target="\_top">RFC 4512</a>, OpenDJ also supports the following extensions that you can use when adding your own definitions:</p>
</div>
<div id="general-schema-definition-extensions" class="openblock">
<div class="title">Extensions for All Schema Definitions</div>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>X-ORIGIN</code></dt>
<dd>
<p>Used to specify the origin of a schema element. Examples include <code>X-ORIGIN 'RFC 4519'</code>, <code>X-ORIGIN 'draft-ietf-ldup-subentry'</code>, and <code>X-ORIGIN 'OpenDJ Directory Server'</code>.</p>
</dd>
<dt class="hdlist1"><code>X-SCHEMA-FILE</code></dt>
<dd>
<p>Used to specify the relative path to the schema file containing the schema element such as <code>X-SCHEMA-FILE '00-core.ldif'</code>. Schema definitions are located by default in <code>/path/to/opendj/config/schema/*.ldif</code> files.</p>
</dd>
</dl>
</div>
</div>
</div>
<div id="attr-syntax-schema-definition-extensions" class="openblock">
<div class="title">Extensions for Attribute Syntax Descriptions</div>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>X-ENUM</code></dt>
<dd>
<p>Used to define a syntax that is an enumeration of values. The following attribute syntax description defines a syntax allowing four possible attribute values, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ldif">ldapSyntaxes: ( security-label-syntax-oid DESC 'Security Label'
 X-ENUM ( 'top-secret' 'secret' 'confidential' 'unclassified' ) )</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>X-PATTERN</code></dt>
<dd>
<p>Used to define a syntax based on a regular expression pattern, where valid regular expressions are those defined for <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html" target="\_blank">java.util.regex.Pattern</a>. The following attribute syntax description defines a simple, lenient SIP phone URI syntax check:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ldif">ldapSyntaxes: ( simple-sip-uri-syntax-oid DESC 'Lenient SIP URI Syntax'
 X-PATTERN '^sip:[a-zA-Z0-9.]+@[a-zA-Z0-9.]+(:[0-9]+)?$' )</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>X-SUBST</code></dt>
<dd>
<p>Used as a fallback to substitute a defined syntax for one that OpenDJ does not implement. The following example substitutes Directory String syntax, which has OID 1.3.6.1.4.1.1466.115.121.1.15, for a syntax that OpenDJ does not implement:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ldif">ldapSyntaxes: ( non-implemented-syntax-oid DESC 'Not Implemented in OpenDJ'
 X-SUBST '1.3.6.1.4.1.1466.115.121.1.15' )</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div id="attr-type-schema-definition-extensions" class="openblock">
<div class="title">Extension for Attribute Type Descriptions</div>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>X-APPROX</code></dt>
<dd>
<p><code>X-APPROX</code> is used to specify the approximate matching rule to use for a given attribute type when not using the default, which is the <a href="http://aspell.net/metaphone/" target="\_blank">double metaphone approximate match</a>.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="schema-legacy-support">Relaxing Schema Checking to Import Legacy Data</h3>
<div class="paragraph">
<p>By default, OpenDJ accepts data that follows the schema for allowable and rejected data. You might have legacy data from a directory service that is more lenient, allowing non-standard constructions such as multiple structural object classes per entry, not checking attribute value syntax, or even not respecting schema definitions.</p>
</div>
<div class="paragraph">
<p>For example, when importing data with multiple structural object classes defined per entry, you can relax schema checking to warn rather than reject entries having this issue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ dsconfig \
 set-global-configuration-prop \
 --hostname opendj.example.com \
 --port 4444 \
 --bindDN &quot;cn=Directory Manager&quot; \
 --bindPassword password \
 --set single-structural-objectclass-behavior:warn \
 --trustAll \
 --no-prompt</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can allow attribute values that do not respect the defined syntax with the <code>dsconfig</code> command as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ dsconfig \
 set-global-configuration-prop \
 --hostname opendj.example.com \
 --port 4444 \
 --bindDN &quot;cn=Directory Manager&quot; \
 --bindPassword password \
 --set invalid-attribute-syntax-behavior:warn \
 --trustAll \
 --no-prompt</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can even turn off schema checking altogether, although turning off schema checking only really makes sense when you are absolutely sure that the entries and attribute values respect the schema definitions, and you simply want to turn off schema checking temporarily to speed up import processing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ dsconfig \
 set-global-configuration-prop \
 --hostname opendj.example.com \
 --port 4444 \
 --bindDN &quot;cn=Directory Manager&quot; \
 --bindPassword password \
 --set check-schema:false \
 --trustAll \
 --no-prompt</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="standard-schema">Standard Schema Included With OpenDJ Server</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>OpenDJ directory server provides many standard schema definitions in these LDIF files under <code>/path/to/opendj/config/schema</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>00-core.ldif</code></dt>
<dd>
<p>This file contains a core set of attribute type and object class definitions from the following Internet-Drafts, RFCs, and standards:</p>
<div class="ulist none">
<ul class="none">
<li>
<p><a href="https://tools.ietf.org/html/draft-ietf-boreham-numsubordinates" target="\_blank">draft-ietf-boreham-numsubordinates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/draft-findlay-ldap-groupofentries" target="\_blank">draft-findlay-ldap-groupofentries</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/draft-furuseth-ldap-untypedobject" target="\_blank">draft-furuseth-ldap-untypedobject</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/draft-good-ldap-changelog" target="\_blank">draft-good-ldap-changelog</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/draft-ietf-ldup-subentry" target="\_blank">draft-ietf-ldup-subentry</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/draft-wahl-ldap-adminaddr" target="\_blank">draft-wahl-ldap-adminaddr</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc1274" target="\_blank">RFC 1274</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc2079" target="\_blank">RFC 2079</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc2256" target="\_blank">RFC 2256</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc2798" target="\_blank">RFC 2798</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3045" target="\_blank">RFC 3045</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3296" target="\_blank">RFC 3296</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3671" target="\_blank">RFC 3671</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3672" target="\_blank">RFC 3672</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4512" target="\_blank">RFC 4512</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4519" target="\_blank">RFC 4519</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4523" target="\_blank">RFC 4523</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4524" target="\_blank">RFC 4524</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4530" target="\_blank">RFC 4530</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc5020" target="\_blank">RFC 5020</a></p>
</li>
<li>
<p><a href="https://www.itu.int/rec/T-REC-X.501" target="\_blank">X.501</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>01-pwpolicy.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/draft-behera-ldap-password-policy-09" target="\_blank">draft-behera-ldap-password-policy</a> (Draft 09), which defines a mechanism for storing password policy information in an LDAP directory server.</p>
</dd>
<dt class="hdlist1"><code>02-config.ldif</code></dt>
<dd>
<p>This file contains the attribute type and objectclass definitions for use with the directory server configuration.</p>
</dd>
<dt class="hdlist1"><code>03-changelog.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/draft-good-ldap-changelog" target="\_blank">draft-good-ldap-changelog</a>, which defines a mechanism for storing information about changes to directory server data.</p>
</dd>
<dt class="hdlist1"><code>03-rfc2713.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc2713" target="\_blank">RFC 2713</a>, which defines a mechanism for storing serialized Java objects in the directory server.</p>
</dd>
<dt class="hdlist1"><code>03-rfc2714.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc2714" target="\_blank">RFC 2714</a>, which defines a mechanism for storing CORBA objects in the directory server.</p>
</dd>
<dt class="hdlist1"><code>03-rfc2739.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc2739" target="\_blank">RFC 2739</a>, which defines a mechanism for storing calendar and vCard objects in the directory server. Note that the definition in RFC 2739 contains a number of errors, and this schema file has been altered from the standard definition in order to fix a number of those problems.</p>
</dd>
<dt class="hdlist1"><code>03-rfc2926.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc2926" target="\_blank">RFC 2926</a>, which defines a mechanism for mapping between Service Location Protocol (SLP) advertisements and LDAP.</p>
</dd>
<dt class="hdlist1"><code>03-rfc3112.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc3112" target="\_blank">RFC 3112</a>, which defines the authentication password schema.</p>
</dd>
<dt class="hdlist1"><code>03-rfc3712.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc3712" target="\_blank">RFC 3712</a>, which defines a mechanism for storing printer information in the directory server.</p>
</dd>
<dt class="hdlist1"><code>03-uddiv3.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc4403" target="\_blank">RFC 4403</a>, which defines a mechanism for storing UDDIv3 information in the directory server.</p>
</dd>
<dt class="hdlist1"><code>04-rfc2307bis.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/draft-howard-rfc2307bis" target="\_blank">draft-howard-rfc2307bis</a>, which defines a mechanism for storing naming service information in the directory server.</p>
</dd>
<dt class="hdlist1"><code>05-rfc4876.ldif</code></dt>
<dd>
<p>This file contains schema definitions from <a href="https://tools.ietf.org/html/rfc4876" target="\_blank">RFC 4876</a>, which defines a schema for storing Directory User Agent (DUA) profiles and preferences in the directory server.</p>
</dd>
<dt class="hdlist1"><code>05-samba.ldif</code></dt>
<dd>
<p>This file contains schema definitions required when storing Samba user accounts in the directory server.</p>
</dd>
<dt class="hdlist1"><code>05-solaris.ldif</code></dt>
<dd>
<p>This file contains schema definitions required for Solaris and OpenSolaris LDAP naming services.</p>
</dd>
<dt class="hdlist1"><code>06-compat.ldif</code></dt>
<dd>
<p>This file contains the attribute type and objectclass definitions for use with the directory server configuration.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="nf-dsr-schema">Working With DIT Structure Rules &amp; Name Forms</h3>
<div class="paragraph">
<p>This section contains useful information regarding name forms and DIT structure rules.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>At this time, the OpenDJ Control Panel does not support the management of name forms and DIT structure rules. These schema definition types can only be implemented and managed by way of direct schema file edits (which will necessitate a restart of OpenDJ), <em>or</em> through a use of <strong>ldapmodify</strong> against the server&#8217;s <code>cn=schema</code> context.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="nf-schema">Name Forms</h4>
<div class="paragraph">
<p>From clause 13.1.8 of <a href="https://www.itu.int/rec/T-REC-X.501" target="_blank" rel="noopener">ITU-T Rec. X.501</a> and <a href="http://tools.ietf.org/html/rfc4512#section-4.1.7.2" target="_blank"">Section 4.1.7.2 of RFC 4512</a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>name form</em></dt>
<dd>
<p><em>A name form specifies a permissible RDN for entries of a particular structural object class. A name form identifies a named object class and one or more attribute types to be used for naming (i.e., for the RDN). Name forms are primitive pieces of specification used in the definition of DIT structure rules.</em></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In simplest terms, a name form is a particular schema definition which requires specific RDN syntaxes for use upon entries bearing a specific STRUCTURAL class.</p>
</div>
<div class="paragraph">
<p>To offer an example of this, consider the following UDDIv3 name form, per the <code>03-uddiv3.ldif</code> file included with OpenDJ:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>      nameForms: ( 1.3.6.1.1.10.15.1
         NAME 'uddiBusinessEntityNameForm'
         OC uddiBusinessEntity
         MUST ( uddiBusinessKey )
         X-ORIGIN 'RFC 4403' )</code></pre>
</div>
</div>
<div class="paragraph">
<p>This name form states that any entry bearing the STRUCTURAL class <code>uddiBusinessEntity</code> MUST ONLY be designated using the <code>uddiBusinessKey</code> as the principal RDN attribute type, for example, " <code>uddiBusinessKey=ABC123</code> ".</p>
</div>
<div class="paragraph">
<p>Alternatively, when devising custom name forms, it is possible to enforce the use of specific attribute types within multi-valued RDNs. Consider the following hypothetical name form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>      nameForms: ( 1.3.6.1.4.1.56521.999.98.15
         NAME 'cnOrgForm'
         OC groupOfUniqueNames
         MUST ( cn $ o ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>This name form states that any entry bearing the STRUCTURAL object class <code>groupOfUniqueNames</code> MUST be designated using attribute types <code>cn</code> <em>and</em> <code>o</code> for a qualifying entry bearing a multi-valued RDN, such as
" <code>cn=Auditors+o=Acme Audit Co</code> ".</p>
</div>
<div class="paragraph">
<p>Name forms also allow use of MAY clauses. Consider the following hypothetical name form, similar to the above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>      nameForms: ( 1.3.6.1.4.1.56521.999.98.16
         NAME 'cnOrgAltForm'
         OC groupOfUniqueNames
         MUST cn
         MAY o )</code></pre>
</div>
</div>
<div class="paragraph">
<p>This rule enforces use of the <code>cn</code> RDN attribute type the same as before, but while it no longer requires use of <code>o</code>, it will not reject it when present. As such, either of the following RDNs are acceptable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cn=Corporate Auditors</code></p>
</li>
<li>
<p><code>cn=Third Party Auditors+o=Acme Audit Co</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But, regardless of the permutations, a name form does little good in practice&#8201;&#8212;&#8201;unless it is referenced by a DIT structure rule.</p>
</div>
</div>
<div class="sect3">
<h4 id="dsr-schema">DIT Structure Rules</h4>
<div class="paragraph">
<p>From clause 13.1.6 of <a href="https://www.itu.int/rec/T-REC-X.501" target="_blank" rel="noopener">ITU-T Rec. X.501</a> and <a href="http://tools.ietf.org/html/rfc4512#section-4.1.7.1" target="_blank" rel="noopener">Section 4.1.7.1 of RFC 4512</a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>DIT structure rule</em></dt>
<dd>
<p><em>A rule governing the structure of the DIT by specifying a permitted superior to subordinate entry relationship. A structure rule relates a name form, and therefore a structural object class, to superior structure rules. This permits entries of the structural object class identified by the name form to exist in the DIT as subordinates to entries governed by the indicated superior structure rules.</em></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In short, a DIT structure rule enforces the terms of its prescribed name form. To offer a simple analogy, if a name form presents a law, the DIT structure rule is the public official upholding that law.</p>
</div>
<div class="paragraph">
<p>Consider this structure rule, per the included <code>03-uddiv3.ldif</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>     dITStructureRules: ( 1
        NAME 'uddiBusinessEntityStructureRule'
        FORM uddiBusinessEntityNameForm
        X-ORIGIN 'RFC 4403' )</code></pre>
</div>
</div>
<div class="paragraph">
<p>This rule employs the <code>uddiBusinessEntityNameForm</code> definition, and constrains entries bearing the STRUCTURAL object class of the name form&#8201;&#8212;&#8201;also known as the <code>namedObjectClass</code>&#8201;&#8212;&#8201;to the RDN attribute type (in this case, <code>uddiBusinessKey</code>).</p>
</div>
<div class="paragraph">
<p>When a DIT structure rule is introduced to the directory schema, it will not be evaluated until an entry is added to the DIT it enforces.</p>
</div>
<div class="paragraph">
<p>DIT structure rules shall not influence preexisting entries, even if based upon now-illegal STRUCTURAL class and RDN combinations.</p>
</div>
<div class="paragraph">
<p>Once structure rules have been established, when a new entry is added to, or renamed within the DIT in violation of a structure rule, OpenDJ will return "Object class violation (65)" along with additional contextual information for debugging purposes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>As of version 4.8.0, OpenDJ is currently using the result code of "Object class violation (65)" for certain name form related errors, where it should be using "Naming violation (64)".</p>
</div>
<div class="paragraph">
<p>This issue will be resolved in a future release of the package to avoid introducing breaking changes. Users are advised to update any external scripts or applications which may match the incorrect result code, and take steps to allow recognition of the correct result code in parallel for maximum compatibility.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But when a new entry is successfully added to or renamed within the DIT, a new operational attribute type appears on the entry: governingStructureRule.</p>
</div>
<div class="paragraph">
<p>From clause <a href="https://www.itu.int/rec/T-REC-X.501" target="_blank" rel="noopener">13.1.7 of ITU-T Rec. X.501</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"> </dt>
<dd>
<p><em>Governing structure rule (of an entry): With respect to a particular entry, the single DIT structure rule that applies to the entry. This rule is indicated by the governingStructureRule operational attribute.</em></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See also <a href="http://tools.ietf.org/html/rfc4512#section-3.4.6" target="_blank" rel="noopener">Section 3.4.6 of RFC 4512</a>.</p>
</div>
<div class="paragraph">
<p>In simplest terms, the <code>governingStructureRule</code> contains the integer identifier of the DIT structure rule which governs the entry. In the case of the above DIT structure rule, it would appear in LDAP search results as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>governingStructureRule: 1</code></dt>
<dd>
<p> </p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Instances of this attribute type may be used for diagnostic reasons, or by client applications designed to determine the appropriate RDN syntax to be applied for a new entry, or for an entry being renamed and/or moved, in advance of the request.</p>
</div>
<div class="paragraph">
<p>DIT structure rules can be configured in such a way that a particular rule extends from, or is subordinate to, another DIT structure rule using the SUP clause.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>A superior DIT structure rule is often referred to as a superior structure rule, per clause 13.1.9 of <a href="https://www.itu.int/rec/T-REC-X.501" target="_blank" rel="noopener">ITU-T Rec. X.501</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The purpose of the SUP clause is to allow an entry with a particular RDN syntax to reside beneath one of multiple possible choices. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>    SUP ( 20 21 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the integer identifiers 20 and 21 indicate that the bearer of this clause will allow entries to reside as subordinates to either of the entries governed by those rules.</p>
</div>
<div class="paragraph">
<p>Also note that rules can be <em>recursive</em> or "self-referencing". This manifests as an instance where a DIT structure rule possesses a SUP clause member that matches its own integer identifier. This is a particularly useful feature because it allows nesting of compliant entries&#8201;&#8212;&#8201;for example, those bearing the <code>organizationalUnit</code> STRUCTURAL class&#8201;&#8212;&#8201;to exist within superior entries of like-design.</p>
</div>
<div class="paragraph">
<p>For an example of recursive rules in action, see the <code>ouStructure</code> rule (21) in the next section.</p>
</div>
</div>
<div class="sect3">
<h4 id="dsr-dit-design-schema">DIT Design Under Governance - A Practical Overview</h4>
<div class="paragraph">
<p>This section will cover the highlights of creating initial DIT content while under the control of easily-understood DIT structure rules enforcing the use of common attribute types within entry RDNs.</p>
</div>
<div class="paragraph">
<p>The following basic assumptions apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new <code>userRoot</code> backend exists and is identified by the <code>base-dn</code> of <code>dc=example,dc=com</code>, containing no entries whatsoever, and &#8230;&#8203;</p>
</li>
<li>
<p>The eight (8) definitions described have already been saved to <code>/opt/opendj/config/schema/99-user.ldif</code> or a similar file, or otherwise added via <strong>ldapmodify</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To begin, let&#8217;s take a look at the following <code>nameForms</code> definitions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>    #
      nameForms: ( 1.3.6.1.4.1.56521.999.2.7.1
         NAME 'rootSuffixForm'
         OC domain
         MUST dc )
      #
      nameForms: ( 1.3.6.1.4.1.56521.999.2.7.2
         NAME 'ouForm'
         OC organizationalUnit
         MUST ou )
      #
      nameForms: ( 1.3.6.1.4.1.56521.999.2.7.3
         NAME 'accountForm'
         OC inetOrgPerson
         MUST uid )
      #
      nameForms: ( 1.3.6.1.4.1.56521.999.2.7.4
         NAME 'groupForm'
         OC groupOfNames
         MUST cn )</code></pre>
</div>
</div>
<div class="paragraph">
<p>These name forms declare the following mandates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entries bearing the <code>domain</code> STRUCTURAL class, MUST utilize <code>dc</code> for their respective RDNs</p>
</li>
<li>
<p>Entries bearing the <code>organizationalUnit</code> STRUCTURAL class, MUST utilize <code>ou</code> for their respective RDNs</p>
</li>
<li>
<p>Entries bearing the <code>inetOrgPerson</code> STRUCTURAL class, MUST utilize <code>uid</code> for their respective RDNs</p>
</li>
<li>
<p>Entries bearing the <code>groupOfNames</code> STRUCTURAL class, MUST utilize <code>cn</code> for their respective RDNs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, we&#8217;ll take a look at the new <code>dITStructureRules</code> instances, which will bring the above name forms to life:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>   #
      dITStructureRules: ( 20
                NAME 'rootSuffixStructure'
                FORM rootSuffixForm )
      #
      dITStructureRules: ( 21
                NAME 'ouStructure'
                FORM ouForm
                SUP ( 20 21 ) )
      #
      dITStructureRules: ( 22
                NAME 'accountStructure'
                FORM accountForm
                SUP 21 )
      #
      dITStructureRules: ( 23
                NAME 'groupStructure'
                FORM groupForm
                SUP 21 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>From these rules, one can begin to perceive an abstract DIT structure, defined by the incrementing&#8201;&#8212;&#8201;and hierarchically-significant&#8201;&#8212;&#8201;integer identifiers, each of which reflect the following respective conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Given the absence of other entries, the introduction of an entry bearing the <code>domain</code> STRUCTURAL class and <code>dc</code> RDN attribute signifies the start of the administrative area, or the start of the "chain of enforced rules"</p>
<div class="paragraph">
<p>When added, this entry SHOULD bear a <code>governingStructureRule</code> integer identifier of 20</p>
</div>
</li>
<li>
<p>Given the introduction of an entry, positioned directly subordinate to the root suffix and bearing the <code>organizationalUnit</code> STRUCTURAL class and <code>ou</code> RDN attribute, the entry is accepted</p>
<div class="paragraph">
<p>When added, this entry SHOULD bear a <code>governingStructureRule</code> integer identifier of 21, the subordinate structure rule of its superior structure rule, 20</p>
</div>
</li>
<li>
<p>Given the introduction of any additional <code>organizationalUnit</code> entries, whether descending directly from the root suffix, OR if subordinate to other <code>organizationalUnit</code> entries in "nested" fashion, the entry is accepted by rite of structure rule recursion</p>
<div class="paragraph">
<p>When added, this entry SHOULD also bear a <code>governingStructureRule</code> integer identifier of 21, as with the previous case</p>
</div>
</li>
<li>
<p>Given the introduction of an entry, positioned directly subordinate to any <code>organizationalUnit</code> entry presently governed by DIT structure rule 21 and bearing the <code>inetOrgPerson</code> STRUCTURAL class and <code>uid</code> RDN attribute, the entry is accepted</p>
<div class="paragraph">
<p>When added, this entry SHOULD bear a <code>governingStructureRule</code> integer identifier of 22</p>
</div>
</li>
<li>
<p>Given the introduction of an entry, positioned directly subordinate to any <code>organizationalUnit</code> entry presently governed by DIT structure rule 21 and bearing the <code>groupOfNames</code> STRUCTURAL class and <code>cn</code> RDN attribute, the entry is accepted</p>
<div class="paragraph">
<p>When added, this entry SHOULD bear a <code>governingStructureRule</code> integer identifier of 23</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, we&#8217;ll be creating the initial portions of the governed DIT using <strong>ldapmodify</strong>, and periodically checking the results with <strong>ldapsearch</strong> along the way.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In cases where changes are made in this section, the root DN user (<code>cn=Directory Manager</code>) is purposely used. This is simply to demonstrate that no user, regardless of privilege, can "bypass" or otherwise violate DIT structure rules in force.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ ldapmodify -w password \
      -D &quot;cn=Directory Manager&quot; \
      -h opendj.example.com

    dn: dc=example,dc=com
    changetype: add
    objectClass: domain

    Processing ADD request for dc=example,dc=com
    ADD operation successful for DN dc=example,dc=com

    dn: ou=Accounts,dc=example,dc=com
    changetype: add
    objectClass: organizationalUnit

    Processing ADD request for ou=Accounts,dc=example,dc=com
    ADD operation successful for DN ou=Accounts,dc=example,dc=com

    dn: ou=Consultants,ou=Accounts,dc=example,dc=com
    changetype: add
    objectClass: organizationalUnit

    Processing ADD request for ou=Consultants,dc=example,dc=com
    ADD operation successful for DN ou=Consultants,dc=example,dc=com</code></pre>
</div>
</div>
<div class="paragraph">
<p>So far, so good. What we&#8217;ve just done is create the initial structure of our DIT, and in doing so we&#8217;ve confirmed the DIT structure rules do not seem to be interfering.</p>
</div>
<div class="paragraph">
<p>But, let&#8217;s stop for now and check our work. We want to see the DIT structure rules that are actively governing our entries. To do this, we need only perform a simple anonymous LDAP search:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ ldapsearch -h opendj.example.com \
      -b dc=example,dc=com \
      &quot;(objectClass=*)&quot; \
      governingStructureRule

    dn: dc=example,dc=com
    governingStructureRule: 20

    dn: ou=Accounts,dc=example,dc=com
    governingStructureRule: 21

    dn: ou=Consultants,ou=Accounts,dc=example,dc=com
    governingStructureRule: 21</code></pre>
</div>
</div>
<div class="paragraph">
<p>This proves the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rule 20, the <code>rootSuffixStructure</code> definition, represents the start of the structure chain</p>
</li>
<li>
<p>Rule 21, the <code>ouStructure</code> definition, represents the permitted subordinate naming context below entries governed by the <code>rootSuffixStructure</code> rule</p>
</li>
<li>
<p>Rule 21, as it supports recursion by nature, allows <code>organizationalUnit</code> entries to reside <em>within</em> <code>organizationalUnit</code> entries, thus allowing categorical organizational structures to exist</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s see what happens when we attempt to add an entry bearing an unauthorized RDN syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ ldapmodify -w password \
      -D &quot;cn=Directory Manager&quot;\
      -h opendj.example.com

    dn: mail=user@example.com,ou=Consultants,ou=Accounts,dc=example,dc=com
    changetype: add
    objectClass: inetOrgPerson
    cn: User Person
    sn: Person

    Processing ADD request for
    mail=user@example.com,ou=Consultants,ou=Accounts,dc=example,dc=com
    The LDAP modify request failed: 65 (Object Class Violation)
    Additional Information:  Entry
    mail=user@example.com,ou=Consultants,ou=Accounts,dc=example,dc=com violates
    the Directory Server schema configuration because its RDN does not contain
    attribute uid that is required by name form accountForm</code></pre>
</div>
</div>
<div class="paragraph">
<p>Good, the DIT structure rule in question seems to work in preventing bogus RDNs. Now let&#8217;s continue with entries that are expected to work.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ ldapmodify -w password \
      -D &quot;cn=Directory Manager&quot; \
      -h opendj.example.com

    dn: uid=userPerson,ou=Consultants,ou=Accounts,dc=example,dc=com
    changetype: add
    objectClass: inetOrgPerson
    sn: Person
    cn: User Person

    Processing ADD request for uid=userPerson,ou=Consultants,ou=Accounts,dc=example,dc=com
    ADD operation successful for DN uid=userPerson,ou=Consultants,ou=Accounts,dc=example,dc=com

    dn: ou=Groups,dc=example,dc=com
    changetype: add
    objectClass: organizationalUnit

    Processing ADD request for ou=Groups,dc=example,dc=com
    ADD operation successful for DN ou=Groups,dc=example,dc=com

    dn: ou=Corporate,ou=Groups,dc=example,dc=com
    changetype: add
    objectClass: organizationalUnit

    Processing ADD request for ou=Corporate,ou=Groups,dc=example,dc=com
    ADD operation successful for DN ou=Corporate,ou=Groups,dc=example,dc=com

    dn: ou=Infrastructure,ou=Groups,dc=example,dc=com
    changetype: add
    objectClass: organizationalUnit

    Processing ADD request for ou=Infrastructure,ou=Groups,dc=example,dc=com
    ADD operation successful for DN ou=Infrastructure,ou=Groups,dc=example,dc=com

    dn: cn=Abuse Mail,ou=Infrastructure,ou=Groups,dc=example,dc=com
    changetype: add
    objectClass: groupOfNames

    Processing ADD request for cn=Abuse Mail,ou=Infrastructure,ou=Groups,dc=example,dc=com
    ADD operation successful for DN cn=Abuse Mail,ou=Infrastructure,ou=Groups,dc=example,dc=com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, let&#8217;s check our work (omitting the contents of the previous LDAP search):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ ldapsearch -h opendj.example.com \
      -b dc=example,dc=com \
      &quot;(objectClass=*)&quot; \
      governingStructureRule

    dn: uid=userPerson,ou=Consultants,ou=Accounts,dc=example,dc=com
    governingStructureRule: 22

    dn: ou=Groups,dc=example,dc=com
    governingStructureRule: 21

    dn: ou=Corporate,ou=Groups,dc=example,dc=com
    governingStructureRule: 21

    dn: ou=Infrastructure,ou=Groups,dc=example,dc=com
    governingStructureRule: 21

    dn: cn=Abuse Mail,ou=Infrastructure,ou=Groups,dc=example,dc=com
    governingStructureRule: 23</code></pre>
</div>
</div>
<div class="paragraph">
<p>So, what did we learn?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ouStructure</code> rule 21 continues to allow recursive <code>organizationalUnit</code> entries, so long as they ultimately extend from the <code>rootSuffixStructure</code> superior structure (ancestor) rule 20, <em>or</em> another such entry governed by rule 21</p>
</li>
<li>
<p><code>accountStructure</code> rule 22 is correctly governing entries bearing the <code>inetOrgPerson</code> STRUCTURAL class found within an <code>organizationalUnit</code> entry (superior structure rule 21)</p>
</li>
<li>
<p><code>groupStructure</code> rule 23 is correctly governing entries bearing the <code>groupOfNames</code> STRUCTURAL class found within an <code>organizationalUnit</code> entry (superior structure rule 21)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DIT structure rules are extremely powerful. When properly planned and implemented, they can greatly aid in the formation of clean and orderly directory structures without the need for additional ACIs.</p>
</div>
</div>
<div class="sect3">
<h4 id="dsr-impl-preexist-dit-schema">Considerations Relating To The Implementation Of DIT Structure Rules In An Established DIT</h4>
<div class="paragraph">
<p>Because DIT structure rules do not influence preexisting entries, even those in violation of those rules, this presents a potential pain-point regarding the restoration of content that (in some way) predates the incorporation of those DIT structure rules. This situation may apply following a disaster-triggered reload of data, or when using this data to "seed" a new DSA being built in the topology.</p>
</div>
<div class="paragraph">
<p>If DIT structure rules are already applied to the DSA in question, but data has NOT yet been loaded, the DIT structure rules in question will consider ANY data to be "new" regardless of its true chronological age.</p>
</div>
<div class="paragraph">
<p>If violations are perceived, this will result in errors during the incorporation of that data. This can be confusing to administrators if that same data exists as expected on other DSAs&#8201;&#8212;&#8201;even those with effectively identical configurations.</p>
</div>
<div class="paragraph">
<p>When introducing DIT structure rules to an established (preexisting) DIT, it is strongly recommended that separate load-tests be conducted on a disposable system or virtual image that is under the governance of all planned DIT structure rules. This will allow accurate simulation of new in-topology server builds, or rebuilds of preexisting servers that have suffered a malfunction of some kind, or have been rebuilt due to upgrade or other reasons.</p>
</div>
</div>
<div class="sect3">
<h4 id="dsr-subentries-schema">Considerations For Collective Attribute Subentries</h4>
<div class="paragraph">
<p>DIT structure rules apply not only to standard entries as demonstrated in the previous section, but also to subentries&#8201;&#8212;&#8201;entries that bear the <code>subentry</code> STRUCTURAL class defined in <a href="http://tools.ietf.org/html/rfc3672#section-2.4" target="_blank" rel="noopener">Section 2.4 of RFC 3672</a>.</p>
</div>
<div class="paragraph">
<p>In cases where a directory server employs DIT structure rules in addition to collective attributes, it is necessary to implement a new <code>dITStructureRules</code> definition: one that enforces a suitable RDN attribute type (such as <code>cn</code>) for subentries, while taking into account the superior structure rule(s) involved.</p>
</div>
<div class="paragraph">
<p>To begin, as was done in the previous section, a nameForms definition is required first.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>      nameForms: ( 1.3.6.1.4.1.56521.999.2.7.5
         NAME 'subentryForm'
         OC subentry
         MUST cn )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, we are stating that any entry bearing the <code>subentry</code> STRUCTURAL class MUST ONLY utilize the <code>cn</code> attribute type for its RDN, as it represents the most common naming strategy for subentries.</p>
</div>
<div class="paragraph">
<p>Next, we need to create the DIT structure rule, but first we need to identify the appropriate superior integer identifiers for the SUP clause.</p>
</div>
<div class="paragraph">
<p>Determining these identifiers is a simple matter. First off, subentries are never created below entries that are not parents themselves (or expected to be parents). In the spirit of the previous section, this allows us to strike two (2) candidates from the list: <code>inetOrgPerson</code> entries (accounts), and <code>groupOfNames</code> entries (groups).</p>
</div>
<div class="paragraph">
<p>This leaves <code>domain</code> (20) and <code>organizationalUnit</code> (21) entries. Thus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>      dITStructureRules: ( 24
         NAME 'subentryStructure'
         FORM subentryForm
         SUP ( 20 21 ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because subentries themselves do not allow for subordinate entries, we need not worry about rule recursion in this instance.</p>
</div>
<div class="paragraph">
<p>When implemented (and with respect to the parameters of the previous subsection), the definitions defined in this subsection will correctly allow for the addition of entries bearing the <code>subentry</code> STRUCTURAL class, thus allowing use of dependent constructs, such as collective attributes, to be used unfettered.</p>
</div>
</div>
<div class="sect3">
<h4 id="aci-vs-dsr-schema">ACIs Vs. DIT Structure Rules</h4>
<div class="paragraph">
<p>Some LDAP implementations on the market today offer no support for DIT structure rules. A common workaround for this is the use of ACIs to enforce specific naming conventions for entries. While OpenDJ supports this technique just the same, there are potential caveats.</p>
</div>
<div class="paragraph">
<p>Use of ACIs to enforce such rules can be bypassed by users with sufficient access privileges. DIT structure rules, on the other hand, are defined in the schema, which conceptually exists at a lower and more fundamental level than ACIs. As such, no user can bypass a DIT structure rule using conventional means&#8201;&#8212;&#8201;not even the root DN.</p>
</div>
<div class="paragraph">
<p>There is also the classic argument that use of ACIs to effect "behavioral changes" in this manner is contrary to the very intent of ACIs. Because DIT structure rules are essentially immutable and do not discriminate the origin of any request, they resemble configuration directives in practice more so than an expression of privilege.</p>
</div>
<div class="paragraph">
<p>The argument against ACIs in this context gains additional momentum when one considers the innate risk of altering ACIs for any reason, as even the slightest misstep can deny critical functionality or, worse, expose data.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-09-19 11:34:00 +0300
</div>
</div>
</body>
</html>